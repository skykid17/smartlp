
##
## SPDX-FileCopyrightText: 2024 Splunk, Inc.
## SPDX-License-Identifier: LicenseRef-Splunk-8-2021
##
##

[okta_app]
search = (sourcetype=OktaIM2:app)

[okta_user]
search = (sourcetype=OktaIM2:user)

[okta_group]
search = (sourcetype=OktaIM2:group)

[okta_system_email_challenge_factor_redeemed]
search = sourcetype="OktaIM2:log" AND eventType="system.email.challenge_factor_redeemed"

[okta_device_user_add]
search = sourcetype="OktaIM2:log" AND eventType="device.user.add"

[okta_device_lifecycle_deactivate]
search = sourcetype="OktaIM2:log" AND eventType="device.lifecycle.deactivate"

[okta_app_oauth2_token_grant_access_token]
search = sourcetype="OktaIM2:log" AND eventType="app.oauth2.token.grant.access_token"

[okta_app_oauth2_token_grant_id_token]
search = sourcetype="OktaIM2:log" AND eventType="app.oauth2.token.grant.id_token"

[okta_app_oauth2_authorize_code]
search = sourcetype="OktaIM2:log" AND eventType="app.oauth2.authorize.code"

[okta_app_oauth2_authorize]
search = sourcetype="OktaIM2:log" AND eventType="app.oauth2.authorize"

[okta_user_mfa_okta_verify_deny_push]
search = sourcetype="OktaIM2:log" AND eventType="user.mfa.okta_verify.deny_push"

[okta_system_sms_send_okta_push_verify_message]
search = sourcetype="OktaIM2:log" AND eventType="system.sms.send_okta_push_verify_message"

[okta_system_push_send_factor_verify_push]
search = sourcetype="OktaIM2:log" AND eventType="system.push.send_factor_verify_push"

[okta_system_agent_ad_realtimesync]
search = sourcetype="OktaIM2:log" AND eventType="system.agent.ad.realtimesync"

[okta_user_mfa_factor_unsuspend]
search = sourcetype="OktaIM2:log" AND eventType="user.mfa.factor.unsuspend"

[okta_system_agent_ad_connect]
search = sourcetype="OktaIM2:log" AND eventType="system.agent.ad.connect"

[okta_system_agent_ad_update_user]
search = sourcetype="OktaIM2:log" AND eventType="system.agent.ad.update_user"

[okta_user_mfa_factor_suspend]
search = sourcetype="OktaIM2:log" AND eventType="user.mfa.factor.suspend"

[okta_user_account_privilege_grant]
search = sourcetype="OktaIM2:log" AND eventType="user.account.privilege.grant"

[okta_user_session_end]
search = sourcetype="OktaIM2:log" AND eventType="user.session.end"

[okta_system_sms_send_phone_verification_message]
search = sourcetype="OktaIM2:log" AND eventType="system.sms.send_phone_verification_message"

[okta_system_sms_send_password_reset_message]
search = sourcetype="OktaIM2:log" AND eventType="system.sms.send_password_reset_message"

[okta_system_import_user_matching_start]
search = sourcetype="OktaIM2:log" AND eventType="system.import.user_matching.start"

[okta_policy_evaluate_sign_on]
search = sourcetype="OktaIM2:log" AND eventType="policy.evaluate_sign_on"

[okta_user_authentication_verify]
search = sourcetype="OktaIM2:log" AND eventType="user.authentication.verify"

[okta_app_generic_unauth_app_access_attempt]
search = sourcetype="OktaIM2:log" AND eventType="app.generic.unauth_app_access_attempt"

[okta_app_oauth2_authorize_implicit_id_token]
search = sourcetype="OktaIM2:log" AND eventType="app.oauth2.authorize.implicit.id_token"

[okta_application_policy_sign_on_deny_access]
search = sourcetype="OktaIM2:log" AND eventType="application.policy.sign_on.deny_access"

[okta_application_provision_user_verify_exists]
search = sourcetype="OktaIM2:log" AND eventType="application.provision.user.verify_exists"

[okta_plugin_script_status]
search = sourcetype="OktaIM2:log" AND eventType="plugin.script_status"

[okta_directory_app_user_profile_bootstrap]
search = sourcetype="OktaIM2:log" AND eventType="directory.app_user_profile.bootstrap"

[okta_device_enrollment_create]
search = sourcetype="OktaIM2:log" AND eventType="device.enrollment.create"

[okta_device_lifecycle_activate]
search = sourcetype="OktaIM2:log" AND eventType="device.lifecycle.activate"

[okta_device_lifecycle_delete]
search = sourcetype="OktaIM2:log" AND eventType="device.lifecycle.delete"

[okta_device_lifecycle_suspend]
search = sourcetype="OktaIM2:log" AND eventType="device.lifecycle.suspend"

[okta_device_lifecycle_unsuspend]
search = sourcetype="OktaIM2:log" AND eventType="device.lifecycle.unsuspend"

[okta_app_oauth2_admin_consent_grant]
search = sourcetype="OktaIM2:log" AND eventType="app.oauth2.admin.consent.grant"

[okta_app_oauth2_as_consent_revoke_implicit_client]
search = sourcetype="OktaIM2:log" AND eventType="app.oauth2.as.consent.revoke.implicit.client"

[okta_app_oauth2_token_grant_refresh_token]
search = sourcetype="OktaIM2:log" AND eventType="app.oauth2.token.grant.refresh_token"

[okta_app_oauth2_token_revoke]
search = sourcetype="OktaIM2:log" AND eventType="app.oauth2.token.revoke"

[okta_app_user_management_push_new_user_success]
search = sourcetype="OktaIM2:log" AND eventType="app.user_management.push_new_user_success"

[okta_system_import_complete]
search = sourcetype="OktaIM2:log" AND eventType="system.import.complete"

[okta_system_import_complete_batch]
search = sourcetype="OktaIM2:log" AND eventType="system.import.complete_batch"

[okta_system_import_custom_object_complete]
search = sourcetype="OktaIM2:log" AND eventType="system.import.custom_object.complete"

[okta_system_import_group_complete]
search = sourcetype="OktaIM2:log" AND eventType="system.import.group.complete"

[okta_system_import_group_membership_complete]
search = sourcetype="OktaIM2:log" AND eventType="system.import.group_membership.complete"

[okta_system_import_implicit_deletion_complete]
search = sourcetype="OktaIM2:log" AND eventType="system.import.implicit_deletion.complete"

[okta_system_import_implicit_deletion_start]
search = sourcetype="OktaIM2:log" AND eventType="system.import.implicit_deletion.start"

[okta_system_import_membership_processing_complete]
search = sourcetype="OktaIM2:log" AND eventType="system.import.membership_processing.complete"

[okta_system_import_membership_processing_start]
search = sourcetype="OktaIM2:log" AND eventType="system.import.membership_processing.start"

[okta_system_import_user_complete]
search = sourcetype="OktaIM2:log" AND eventType="system.import.user.complete"

[okta_system_import_user_matching_complete]
search = sourcetype="OktaIM2:log" AND eventType="system.import.user_matching.complete"

[okta_app_user]
search = sourcetype="OktaIM2:appUser"

[okta_identity_cloud_alerts]
search = sourcetype="OktaIM2:log" eventType IN ("system.agent.ad.write_ldap", "system.org.rate_limit.violation", "system.org.rate_limit.warning", "app.oauth2.token.detect_reuse", "core.concurrency.org.limit.violation", "system.operation.rate_limit.violation", "application.provision.group_push.mapping.update.or.delete.failed.with.error", "system.import.incremental_converted_to_full","system.email.new_device_notification.sent_message", "user.account.report_suspicious_activity_by_enduser")
# alert

[okta_identity_cloud_authentication]
search = sourcetype="OktaIM2:log" eventType IN ("app.generic.unauth_app_access_attempt", "app.oauth2.as.authorize", "app.oauth2.as.authorize.code", "app.oauth2.as.authorize.implicit.access_token", "app.oauth2.as.authorize.implicit.id_token", "app.oauth2.authorize", "application.policy.sign_on.deny_access", "policy.evaluate_sign_on", "user.authentication.auth_via_AD_agent", "user.authentication.auth_via_IDP", "user.authentication.auth_via_mfa", "user.authentication.auth_via_radius", "user.authentication.sso", "user.authentication.verify", "user.session.start", "user.session.start", "app.oauth2.authorize.code", "app.oauth2.authorize.implicit.id_token", "user.mfa.okta_verify.deny_push", "user.authentication.auth_via_social", "app.access_request.expire", "system.push.send_factor_verify_push")
# authentication

[okta_identity_cloud_change_all_changes]
search = sourcetype="OktaIM2:log" eventType IN ("app.oauth2.as.token.grant.access_token", "app.oauth2.token.grant.access_token", "app.oauth2.token.grant.id_token", "app.oauth2.token.grant.refresh_token", "application.configuration.reset_logo", "application.configuration.update_logo", "application.lifecycle.activate", "application.lifecycle.create", "application.lifecycle.deactivate", "application.lifecycle.delete", "application.lifecycle.update", "application.policy.sign_on.rule.create", "application.provision.user.deactivate", "application.provision.user.deprovision", "application.provision.user.push", "application.provision.user.push_profile", "application.provision.user.reactivate", "application.user_membership.add", "application.user_membership.change_password", "application.user_membership.change_username", "application.user_membership.remove", "application.user_membership.restore", "application.user_membership.restore_password", "application.user_membership.update", "device.enrollment.create", "device.lifecycle.activate", "device.lifecycle.deactivate", "device.lifecycle.delete", "device.lifecycle.suspend", "device.lifecycle.unsuspend", "directory.app_user_profile.bootstrap", "directory.app_user_profile.update", "directory.mapping.update", "directory.user_profile.update", "group.application_assignment.add", "group.application_assignment.remove", "group.application_assignment.update", "group.lifecycle.create", "group.user_membership.add", "group.user_membership.remove", "oauth2.as.created", "oauth2.as.updated", "oauth2.claim.created", "oauth2.claim.deleted", "oauth2.scope.created", "policy.lifecycle.activate", "policy.lifecycle.create", "policy.lifecycle.deactivate", "policy.lifecycle.delete", "policy.lifecycle.update", "policy.rule.activate", "policy.rule.add", "policy.rule.deactivate", "policy.rule.update", "system.agent.ad.connect", "system.agent.ad.deactivate", "system.agent.ad.reactivate", "system.agent.ad.start", "system.agent.ad.update_user", "system.api_token.create", "system.api_token.enable", "system.api_token.revoke", "system.email.challenge_factor_redeemed", "system.import.custom_object.create", "system.import.group.create", "system.import.group.delete", "system.import.group.update", "system.import.user.create", "system.import.user.delete", "system.import.user.update", "system.agent.ad.realtimesync", "app.oauth2.client.lifecycle.activate", "app.oauth2.client.lifecycle.create", "app.oauth2.client.lifecycle.deactivate", "app.oauth2.client.lifecycle.delete", "app.oauth2.client.lifecycle.update", "app.oauth2.credentials.lifecycle.activate", "app.oauth2.credentials.lifecycle.deactivate", "app.oauth2.credentials.lifecycle.create", "app.oauth2.credentials.lifecycle.delete", "application.configuration.disable_fed_broker_mode", "application.configuration.enable_fed_broker_mode", "group.lifecycle.delete", "iam.role.create", "policy.mapping.create", "system.log_stream.lifecycle.activate", "system.log_stream.lifecycle.create", "system.log_stream.lifecycle.deactivate", "system.log_stream.lifecycle.delete", "system.log_stream.lifecycle.update", "security.authenticator.lifecycle.activate", "security.authenticator.lifecycle.update", "oauth2.scope.deleted", "oauth2.as.deactivated", "oauth2.scope.updated", "app.oauth2.api_resource.delete", "oauth2.as.deleted", "system.api_token.update", "app.user_management.user_group_import.delete_success", "app.user_management.user_group_import.upsert_success", "application.provision.field_mapping_rule.change", "application.provision.group_push.delete_appgroup", "application.provision.group_push.mapping.created", "application.provision.group_push.push_memberships", "directory.linked_object.create", "directory.non_default_user_profile.create", "directory.user_profile.bootstrap", "group.profile.update", "iam.resourceset.bindings.add", "iam.resourceset.create", "security.threat.configuration.update", "self_service.disabled", "self_service.enabled", "system.agent.ad.create", "system.agent.ad.import_user", "system.brand.create", "system.import.roadblock.updated", "system.mfa.factor.activate", "zone.create", "plugin.script_status", "app.oauth2.trusted_server.delete", "app.oauth2.trusted_server.add", "app.access_request.approver.deny", "app.access_request.deny", "app.access_request.delete", "security.behavior.settings.update", "system.idp.lifecycle.delete", "system.idp.lifecycle.deactivate", "system.idp.lifecycle.activate", "system.idp.lifecycle.create", "policy.rule.delete")
# change:all_changes

[okta_identity_cloud_change_account_management]
search = sourcetype="OktaIM2:log" eventType IN ("app.oauth2.admin.consent.grant", "app.oauth2.as.consent.revoke.implicit.client", "app.oauth2.token.revoke", "app.realtimesync.import.details.update_user", "app.user_management", "app.user_management.push_new_user_success", "device.user.add", "system.agent.ad.reset_user_password", "user.account.lock", "user.account.privilege.grant", "user.account.privilege.revoke", "user.account.reset_password", "user.account.unlock", "user.account.update_password", "user.account.update_profile", "user.account.update_secondary_email", "user.lifecycle.activate", "user.lifecycle.create", "user.lifecycle.deactivate", "user.lifecycle.suspend", "user.lifecycle.unsuspend", "user.mfa.factor.activate", "user.mfa.factor.deactivate", "user.mfa.factor.reset_all", "user.mfa.factor.update", "user.mfa.factor.suspend", "user.mfa.factor.unsuspend", "system.import.complete", "system.import.complete_batch", "system.import.custom_object.complete", "system.import.group_membership.complete", "system.import.group.complete", "system.import.implicit_deletion.complete", "system.import.implicit_deletion.start", "system.import.membership_processing.complete", "system.import.membership_processing.start", "system.import.user_matching.complete", "system.import.user_matching.start", "system.import.user.complete", "system.sms.send_account_unlock_message", "system.sms.send_factor_verify_message", "system.sms.send_okta_push_verify_message", "system.sms.send_password_reset_message", "system.sms.send_phone_verification_message", "user.session.end", "app.oauth2.as.token.grant", "app.oauth2.token.grant", "user.account.unlock_by_admin", "user.lifecycle.reactivate", "app.oauth2.admin.consent.revoke", "app.access_request.request", "app.access_request.approver.approve","device.user.remove", "user.account.expire_password")
# change:account_management

[okta_identity_cloud_network_traffic]
search = sourcetype = "OktaIM2:log" eventType IN ("security.request.blocked")
# network communicate
