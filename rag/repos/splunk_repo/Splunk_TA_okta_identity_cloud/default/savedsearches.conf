##
## SPDX-FileCopyrightText: 2024 Splunk, Inc.
## SPDX-License-Identifier: LicenseRef-Splunk-8-2021
##
##

[Okta2 app group]
disabled = 0
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.track = 0
auto_summarize.dispatch.earliest_time = -30d@h
cron_schedule = 0 23 * * *
dispatch.latest_time = now
dispatch.earliest_time = 1
display.general.type = statistics
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = search
request.ui_dispatch_view = search
description = Saved search which populates the okta2_app_assigned_group_lookup lookup.
search = `okta_indexes` sourcetype="oktaim2:app" | where isnotnull('assigned_groups{}') | dedup id | mvexpand assigned_groups{} | table id, assigned_groups{}, name, label | rename id as app_id | rename assigned_groups{} as group_id | rename name as app_name | rename label as app_label | outputlookup okta2_app_group_lookup

[Okta2 user detail]
disabled = 0
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.track = 0
auto_summarize.dispatch.earliest_time = -30d@h
cron_schedule = 50 23 * * *
dispatch.latest_time = now
dispatch.earliest_time = 1
display.general.type = statistics
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = search
request.ui_dispatch_view = search
description = Saved search which populates the okta2_user_detail_lookup lookup.
search = `okta_indexes` sourcetype=oktaim2:user | dedup id | table id, profile.firstName, profile.lastName, profile.login,profile.email,profile.secondEmail,profile.primaryPhone,profile.mobilePhone,profile.state,profile.city,profile.countryCode,profile.zipCode,profile.streetAddress,status,created,lastUpdated,lastLogin,activated | rename id as user_id | rename profile.firstName as firstName | rename profile.lastName as lastName | rename profile.login as loginName | rename profile.email as email | rename profile.secondEmail as secondEmail | rename profile.primaryPhone as primaryPhone | rename profile.mobilePhone as mobilePhone | rename profile.state as state | rename profile.city as city | rename profile.countryCode as countryCode | rename profile.zipCode as zipCode | rename profile.streetAddress as streetAddress | rename created as created_time | rename lastUpdated as lastUpdated_time | rename lastLogin as lastLogin_time | rename activated as activated_time | outputlookup okta2_user_detail_lookup

[Okta2 group detail]
disabled = 0
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.track = 0
auto_summarize.dispatch.earliest_time = -30d@h
cron_schedule = 40 23 * * *
dispatch.latest_time = now
dispatch.earliest_time = 1
display.general.type = statistics
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = search
request.ui_dispatch_view = search
description = Saved search which populates the okta2_group_detail_lookup lookup.
search = `okta_indexes` sourcetype=oktaim2:group | dedup id | rename embedded.stats.usersCount as usersCount | rename embedded.stats.appsCount as appsCount | rename embedded.stats.groupPushMappingsCount as groupPushMappingsCount | rename assigned_apps{} as app_id | rename profile.name AS name | rename profile.description AS description| table id, type, name, description, usersCount, appsCount, groupPushMappingsCount, app_id | outputlookup okta2_group_detail_lookup

[Okta2 app detail]
disabled = 0
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.track = 0
auto_summarize.dispatch.earliest_time = -30d@h
cron_schedule = 30 23 * * *
dispatch.latest_time = now
dispatch.earliest_time = 1
display.general.type = statistics
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = search
request.ui_dispatch_view = search
description = Saved search which populates the okta2_app_detail_lookup lookup.
search = `okta_indexes` sourcetype=oktaim2:app | dedup id | table id, name, label, created, lastUpdated, status, signOnMode  | outputlookup okta2_app_detail_lookup

[Okta2 group member]
alert.suppress = 0
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.track = 0
auto_summarize.dispatch.earliest_time = -30d@h
cron_schedule = 20 23 * * *
dispatch.latest_time = now
dispatch.earliest_time = 1
display.general.type = statistics
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = search
request.ui_dispatch_view = search
description = Saved search which populates the okta2_group_member_lookup lookup.
search = `okta_indexes` sourcetype="OktaIM2:groupUser" | dedup groupid userid | table groupid, groupName, userid, userName, lastMembershipUpdated | join groupid [search `okta_indexes` sourcetype="OktaIM2:group" | dedup id | rename id as groupid | rename embedded.stats.usersCount as user_count | table groupid user_count]  | eventstats max(lastMembershipUpdated) as max_time by groupid | where max_time = lastMembershipUpdated and user_count > 0 | rename groupid as group_id | rename userid as user_id | rename groupName as group_name | rename userName as user_name | table group_id, group_name, user_id, user_name | outputlookup okta2_group_member_lookup

[Okta2 app user]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.track = 0
auto_summarize.dispatch.earliest_time = -30d@h
cron_schedule = 10 23 * * *
dispatch.latest_time = now
dispatch.earliest_time = 1
display.general.type = statistics
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = search
request.ui_dispatch_view = search
description = Saved search which populates the okta2_app_assigned_user_lookup lookup.
search = `okta_indexes` sourcetype="OktaIM2:appUser" | dedup appid, userid | rename appid as app_id | rename appName as app_name | rename appLabel as app_label | rename userid as user_id | rename userName as user_name | table app_id, app_name, app_label, user_id, user_name | outputlookup okta2_app_user_lookup
