##
## SPDX-FileCopyrightText: 2024 Splunk, Inc.
## SPDX-License-Identifier: LicenseRef-Splunk-8-2021
##
##

[okta2_app_group_lookup]
external_type = kvstore
collection = okta2_app_assigned_group_lookup
fields_list = app_id,app_name,app_label,group_id

[okta2_user_detail_lookup]
external_type = kvstore
collection = okta2_user_detail_lookup
fields_list = user_id,firstName,lastName,loginName,email,secondEmail,primaryPhone,mobilePhone,state,city,countryCode,zipCode,streetAddress,status,created_time,lastUpdated_time,lastLogin_time,activated_time

[okta2_app_detail_lookup]
external_type = kvstore
collection = okta2_app_detail_lookup
fields_list = id,name,label,created,lastUpdated,status,signOnMode

[okta2_group_detail_lookup]
external_type = kvstore
collection = okta2_group_detail_lookup
fields_list = id,type,name,description,usersCount,appsCount,groupPushMappingsCount,app_id

[okta2_eventtype_lookup]
filename = okta2_eventType_related_info_220.csv

[okta2_group_member_lookup]
external_type = kvstore
collection = okta2_group_member_lookup
fields_list = group_id,group_name,user_id,user_name

[okta2_app_user_lookup]
external_type = kvstore
collection = okta2_app_assigned_user_lookup
fields_list = app_id,app_name,app_label,user_id,user_name

[okta2_system_log_lookup]
filename = okta2_system_log.csv

[REPORT-addonlogs]
DELIMS = "|"
FIELDS = "field1","field2","field3"

[okta_extract_transaction_data]
REGEX = transaction\"\:\s*\{([\S\s]+?)\}\,
FORMAT = transaction_data::$1

[okta_extract_target_data]
REGEX = target\"\:\s*\[([\S\s]+)\]
FORMAT = target_data::$1

[okta_extract_target_data_first_occurrence]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:(?:.*?)\"type\"\:(?:.*?)\"alternateId\"\:(?:.*?)\"displayName\"\:(?:.*?)\"detailEntry\":\s*{?(?:\"unknown\"|\"?(?:[^\}]*)\"?|null)}?}?)\]?
FORMAT = target_data_first_occurrence::$1

[okta_target_data_app_instance_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"AppInstance\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_app_instance_attr::$1 targetAppId::$2 targetAppAlternateId::$3 targetAppDisplayName::$4

[okta_target_data_policy_rule_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"PolicyRule\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_policy_rule_attr::$1 targetPolicyRuleId::$2 targetPolicyRuleAlternateId::$3 targetPolicyRuleDisplayName::$4

[okta_target_data_policy_entity_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"PolicyEntity\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_policy_entity_attr::$1 targetPolicyEntityId::$2 targetPolicyEntityAlternateId::$3 targetPolicyEntityDisplayName::$4

[okta_target_data_app_user_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"AppUser\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_app_user_attr::$1 targetAppUserId::$2 targetAppUserAlternateId::$3 targetAppUserDisplayName::$4

[okta_target_data_user_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"User\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_user_attr::$1 targetUserId::$2 targetUserAlternateId::$3 targetUserDisplayName::$4

[okta_target_data_role_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"Role\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_role_attr::$1 targetRoleId::$2 targetRoleAlternateId::$3 targetRoleDisplayName::$4

[okta_target_data_access_token_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"access_token\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"(?:[^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_access_token_attr::$1 targetaccesstokenId::$2  targetaccesstokenDisplayName::$3 targetaccesstokentype::"access_token"

[okta_target_data_active_directory_attributes_transform]
SOURCE_KEY = target_data
REGEX = \"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"Active Directory\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"(?:[^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|"")
FORMAT = targetactivedirectoryId::$1  targetactivedirectoryDisplayName::$2

[okta_target_data_id_token_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"id_token\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"(?:[^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_id_token_attr::$1 targetidtokenId::$2   targetidtokenDisplayName::$3 targetidtype::"id_token"

[okta_target_data_refresh_token_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"refresh_token\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"(?:[^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_refresh_token_attr::$1 targetrefreshtokenId::$2  targetrefreshDisplayName::$3 targetrefreshtype::"refresh_token"

[okta_target_data_ad_agent_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"AD\sAgent\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = targetADAgent_attr::$1 targetADAgentId::$2 targetADAgentAlternateId::$3 targetADAgentDisplayName::$4

[okta_target_data_app_group_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"AppGroup\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_app_group_attr::$1 targetAppGroupId::$2 targetAppGroupAlternateId::$3 targetAppGroupDisplayName::$4

[okta_target_data_user_group_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"UserGroup\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_user_group_attr::$1 targetUserGroupId::$2 targetUserGroupAlternateId::$3 targetUserGroupDisplayName::$4

[okta_target_data_group_push_mapping_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"GroupPushMapping\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_group_push_mapping_attr::$1 targetGroupPushMappingId::$2 targetGroupPushMappingAlternateId::$3 targetGroupPushMappingDisplayName::$4

[okta_target_data_resource_set_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"ResourceSet\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_resource_set_attr::$1 targetResourceSetId::$2 targetResourceSetAlternateId::$3 targetResourceSetDisplayName::$4

[okta_target_data_resource_request_attributes_transform]
SOURCE_KEY = target_data
REGEX = ({\"id\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"type\"\:\s*\"ResourceRequest\"\,\s*\"alternateId\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null)\,\s*\"displayName\"\:\s*(?:\"unknown\"|\"([^\"]+)\"|null|""),\s*\"detailEntry\":\s*{?(?:\"unknown\"|\"(?:[^\}]*)\"|null)}?})
FORMAT = target_resource_request_attr::$1 targetResourceRequestId::$2 targetResourceRequestAlternateId::$3 targetResourceRequestDisplayName::$4
