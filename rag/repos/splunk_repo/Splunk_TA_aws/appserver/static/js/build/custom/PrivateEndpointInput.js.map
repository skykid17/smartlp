{"version":3,"file":"PrivateEndpointInput.js","sources":["../../../../../../../build-ui/js/PrivateEndpointInput.js"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n * SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n *\n */\n\nimport { template } from \"underscore\";\nimport CheckBoxTemplate from \"../html/PrivateEndpointTemplate.html\";\nimport \"../stylesheets/PrivateEndpointInput.css\";\n\nconst InputServiceMapping = {\n  aws_private_account: [\"sts\"],\n  aws_sqs_based_s3: [\"sqs\", \"s3\", \"sts\"],\n  aws_cloudtrail: [\"sqs\", \"s3\", \"sts\"],\n  aws_cloudtrail_lake: [\"cloudtrail\", \"sts\"],\n  aws_cloudwatch_logs: [\"logs\", \"sts\"],\n  aws_kinesis: [\"kinesis\", \"sts\"],\n  aws_cloudwatch: [\n    \"sts\",\n    \"monitoring\",\n    \"elb\",\n    \"ec2\",\n    \"autoscaling\",\n    \"lambda\",\n    \"s3\",\n  ],\n};\n\nclass PrivateEndpointInput {\n  /**\n   *\n   * @constructor\n   * @param {Object} globalConfig - Global configuration.\n   * @param {element} el - The element of the custom row.\n   * @param {string} data - Service name.\n   * @param {object} util - the utility object\n   * @param {function} setValue - set value of the custom field\n   */\n  constructor(globalConfig, el, data, setValue, util) {\n    this.globalConfig = globalConfig;\n    this.el = el;\n    this.data = data;\n    this.util = util;\n    this.setValue = setValue;\n    this.endpoint_inputs = InputServiceMapping[this.data.serviceName] || [\n      \"s3\",\n      \"sts\",\n    ];\n    this._onCheckBoxChange = this._onCheckBoxChange.bind(this);\n    this._setVisibilityArray = this._setVisibilityArray.bind(this);\n    this.render = this.render.bind(this);\n    this._RenderTemplate = this._RenderTemplate.bind(this);\n  }\n\n  render() {\n    this.el.innerHTML = this._RenderTemplate();\n    document\n      .querySelector(\"input#private-endpoint-checkbox\")\n      .addEventListener(\"change\", this._onCheckBoxChange);\n\n    return this;\n  }\n\n  _RenderTemplate() {\n    const PrivateEndpointEnabled = parseInt(this.data.value);\n    if (PrivateEndpointEnabled) {\n      this._setVisibilityArray(this.endpoint_inputs, true);\n\n      return template(CheckBoxTemplate)({ checked: \"checked\" });\n    } else {\n      if (Number.isNaN(PrivateEndpointEnabled)) {\n        // initialise with 0 if undefined/null\n        this.util.setState((prevState) => {\n          const data = { ...prevState.data };\n          data.private_endpoint_enabled.value = 0;\n          return { data };\n        });\n      }\n      return template(CheckBoxTemplate)({ checked: \"\" });\n    }\n  }\n\n  _onCheckBoxChange() {\n    const status = document.querySelector(\n      \"input#private-endpoint-checkbox\"\n    ).checked;\n\n    const value = status ? 1 : 0;\n    this.setValue(value);\n    this._setVisibilityArray(this.endpoint_inputs, status);\n  }\n\n  _setVisibilityArray(serviceArr, value) {\n    this.util.setState((prevState) => {\n      const data = { ...prevState.data };\n      for (const service of serviceArr) {\n        const key = `${service}_private_endpoint_url`;\n        data[key].display = value;\n      }\n      return { data };\n    });\n  }\n}\n\nexport default PrivateEndpointInput;\n"],"names":["InputServiceMapping","aws_private_account","aws_sqs_based_s3","aws_cloudtrail","aws_cloudtrail_lake","aws_cloudwatch_logs","aws_kinesis","aws_cloudwatch","PrivateEndpointInput","globalConfig","el","data","setValue","util","endpoint_inputs","this","serviceName","_onCheckBoxChange","bind","_setVisibilityArray","render","_RenderTemplate","innerHTML","document","querySelector","addEventListener","PrivateEndpointEnabled","parseInt","value","template","CheckBoxTemplate","checked","Number","isNaN","setState","prevState","private_endpoint_enabled","status","serviceArr","service","display"],"mappings":"8sBAUMA,EAAsB,CAC1BC,oBAAqB,CAAC,OACtBC,iBAAkB,CAAC,MAAO,KAAM,OAChCC,eAAgB,CAAC,MAAO,KAAM,OAC9BC,oBAAqB,CAAC,aAAc,OACpCC,oBAAqB,CAAC,OAAQ,OAC9BC,YAAa,CAAC,UAAW,OACzBC,eAAgB,CACd,MACA,aACA,MACA,MACA,cACA,SACA,OAIEC,wBAUQC,EAAcC,EAAIC,EAAMC,EAAUC,kBACvCJ,aAAeA,OACfC,GAAKA,OACLC,KAAOA,OACPE,KAAOA,OACPD,SAAWA,OACXE,gBAAkBd,EAAoBe,KAAKJ,KAAKK,cAAgB,CACnE,KACA,YAEGC,kBAAoBF,KAAKE,kBAAkBC,KAAKH,WAChDI,oBAAsBJ,KAAKI,oBAAoBD,KAAKH,WACpDK,OAASL,KAAKK,OAAOF,KAAKH,WAC1BM,gBAAkBN,KAAKM,gBAAgBH,KAAKH,sCAGnD,uBACOL,GAAGY,UAAYP,KAAKM,kBACzBE,SACGC,cAAc,mCACdC,iBAAiB,SAAUV,KAAKE,mBAE5BF,oCAGT,eACQW,EAAyBC,SAASZ,KAAKJ,KAAKiB,cAC9CF,QACGP,oBAAoBJ,KAAKD,iBAAiB,GAExCe,EAASC,EAATD,CAA2B,CAAEE,QAAS,cAEzCC,OAAOC,MAAMP,SAEVb,KAAKqB,UAAS,SAACC,OACZxB,OAAYwB,EAAUxB,aAC5BA,EAAKyB,yBAAyBR,MAAQ,EAC/B,CAAEjB,KAAAA,MAGNkB,EAASC,EAATD,CAA2B,CAAEE,QAAS,uCAIjD,eACQM,EAASd,SAASC,cACtB,mCACAO,QAEIH,EAAQS,EAAS,EAAI,OACtBzB,SAASgB,QACTT,oBAAoBJ,KAAKD,gBAAiBuB,sCAGjD,SAAoBC,EAAYV,QACzBf,KAAKqB,UAAS,SAACC,SACZxB,OAAYwB,EAAUxB,UACN2B,kCAAY,KAAvBC,UAET5B,YADe4B,4BACLC,QAAUZ,uCAEf,CAAEjB,KAAAA"}