<!--
  SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>
  SPDX-License-Identifier: LicenseRef-Splunk-8-2021
 
  -->
<libraryContent>
  <libraryObject>
    <name>MWGaccess3</name>
    <version>10.0.0-34209</version>
    <description></description>
  </libraryObject>
  <configurations>
    <configuration version="1.16.0" mwg-version="10.0.0-34209" id="com.scur.engine.filesystemlogging.263" defaultRights="2" templateId="com.scur.template.engine.filesystemlogging" name="MWGaccess3 Configuration" targetId="com.scur.engine.filesystemlogging">
      <acElements/>
      <configurationProperties>
        <configurationProperty key="LogName" type="com.scur.type.string" encrypted="false" value="MWGaccess3.log"/>
        <configurationProperty key="OverrideGlobalSettings" type="com.scur.type.boolean" encrypted="false" value="true"/>
        <configurationProperty key="AutoDelete" type="com.scur.type.boolean" encrypted="false" value="true"/>
        <configurationProperty key="AutoDeleteNumber" type="com.scur.type.boolean" encrypted="false" value="false"/>
        <configurationProperty key="MaxNumberOfOldLogFiles" type="com.scur.type.number" encrypted="false" value="7"/>
        <configurationProperty key="AutoDeleteDays" type="com.scur.type.boolean" encrypted="false" value="true"/>
        <configurationProperty key="MaxDaysOfOldLogs" type="com.scur.type.number" encrypted="false" value="5"/>
        <configurationProperty key="GZip" type="com.scur.type.boolean" encrypted="false" value="false"/>
        <configurationProperty key="AutoRotate" type="com.scur.type.boolean" encrypted="false" value="true"/>
        <configurationProperty key="RotateSize" type="com.scur.type.boolean" encrypted="false" value="true"/>
        <configurationProperty key="MaxFileSize" type="com.scur.type.number" encrypted="false" value="100"/>
        <configurationProperty key="RotateDaily" type="com.scur.type.boolean" encrypted="false" value="true"/>
        <configurationProperty key="RotationTime" type="com.scur.type.string" encrypted="false" value="00:00"/>
        <configurationProperty key="RotateInterval" type="com.scur.type.boolean" encrypted="false" value="false"/>
        <configurationProperty key="RotationIntervalHours" type="com.scur.type.number" encrypted="false" value="5"/>
        <configurationProperty key="RotationIntervalMinutes" type="com.scur.type.number" encrypted="false" value="0"/>
        <configurationProperty key="AutoPush" type="com.scur.type.boolean" encrypted="false" value="false"/>
        <configurationProperty key="DestinationUrl" type="com.scur.type.string" encrypted="false" value="ftp://myFtpServer"/>
        <configurationProperty key="PushInterval" type="com.scur.type.number" encrypted="false" value="5"/>
        <configurationProperty key="PushIntervalMinutes" type="com.scur.type.number" encrypted="false" value="0"/>
        <configurationProperty key="Username" type="com.scur.type.string" encrypted="false" value=""/>
        <configurationProperty key="Password" type="com.scur.type.string" encrypted="false" value=""/>
        <configurationProperty key="PushAfterRotation" type="com.scur.type.boolean" encrypted="false" value="false"/>
        <configurationProperty key="NextHopProxies" type="com.scur.type.list" listType="com.scur.type.complex.nexthopproxy" encrypted="false" value=""/>
        <configurationProperty key="Encrypted" type="com.scur.type.boolean" encrypted="false" value="false"/>
        <configurationProperty key="Password1" type="com.scur.type.string" encrypted="false" value=""/>
        <configurationProperty key="Password2" type="com.scur.type.string" encrypted="false" value=""/>
        <configurationProperty key="WriteHeader" type="com.scur.type.boolean" encrypted="false" value="false"/>
        <configurationProperty key="Header" type="com.scur.type.string" encrypted="false" value=""/>
        <configurationProperty key="IsBuffered" type="com.scur.type.boolean" encrypted="false" value="true"/>
        <configurationProperty key="FileNameId_IP" type="com.scur.type.boolean" encrypted="false" value="true"/>
        <configurationProperty key="FileNameId_Mac" type="com.scur.type.boolean" encrypted="false" value="false"/>
        <configurationProperty key="FileNameId_Hostname" type="com.scur.type.boolean" encrypted="false" value="false"/>
        <configurationProperty key="FileNameId_UUID" type="com.scur.type.boolean" encrypted="false" value="false"/>
      </configurationProperties>
      <description></description>
    </configuration>
  </configurations>
  <userDefinedPropertys>
    <userDefinedProperty parentId="81" typeId="com.scur.type.string" name="User-Defined.logLine" id="1113" scope="0" description="" defaultRights="2">
      <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
    </userDefinedProperty>
    <userDefinedProperty parentId="81" typeId="com.scur.type.string" name="User-Defined.content-type" id="264" scope="0" description="" defaultRights="2">
      <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
    </userDefinedProperty>
    <userDefinedProperty parentId="81" typeId="com.scur.type.string" name="User-Defined.user-agent-short" id="266" scope="0" description="" defaultRights="2">
      <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
    </userDefinedProperty>
  </userDefinedPropertys>
  <ruleGroup id="833" defaultRights="2" name="MWGaccess3" enabled="true" cycleRequest="true" cycleResponse="true" cycleEmbeddedObject="true" cloudSynced="false">
    <acElements/>
    <condition always="true">
      <expressions/>
    </condition>
    <description></description>
    <rules>
      <rule id="835" enabled="true" name="Set short-user-agent to &quot;_&quot; (underscore) if User-Agent is empty">
        <description></description>
        <immediateActionContainers>
          <setActionContainer propertyId="266">
            <expressions>
              <setExpression openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="_" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
            </expressions>
          </setActionContainer>
        </immediateActionContainers>
        <actionContainer actionId="com.scur.mainaction.continue"/>
        <condition always="false">
          <expressions>
            <conditionExpression openingBracketCount="0" closingBracketCount="0" operatorId="com.scur.operator.equals">
              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.request.headers.hasheader">
                <parameters>
                  <entry>
                    <string>com.scur.engine.headerfilter.request.headers.hasheader.headername</string>
                    <parameter valueTyp="3">
                      <value>
                        <stringValue value="User-Agent" stringModifier="true" typeId="com.scur.type.string"/>
                      </value>
                    </parameter>
                  </entry>
                </parameters>
              </propertyInstance>
              <parameter valueTyp="3" valueId="com.scur.type.boolean.false" typeId="com.scur.type.boolean"/>
            </conditionExpression>
            <conditionExpression prefix="OR" openingBracketCount="0" closingBracketCount="0" operatorId="com.scur.operator.equals">
              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.request.headers.getheader">
                <parameters>
                  <entry>
                    <string>com.scur.engine.headerfilter.request.headers.getheader.headername</string>
                    <parameter valueTyp="3">
                      <value>
                        <stringValue value="User-Agent" stringModifier="true" typeId="com.scur.type.string"/>
                      </value>
                    </parameter>
                  </entry>
                </parameters>
              </propertyInstance>
              <parameter valueTyp="3" typeId="com.scur.type.string">
                <value>
                  <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                </value>
              </parameter>
            </conditionExpression>
          </expressions>
        </condition>
      </rule>
      <rule id="841" enabled="true" name="Create short User-Agent for Internet Explorer">
        <description></description>
        <immediateActionContainers>
          <setActionContainer propertyId="266">
            <expressions>
              <setExpression openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceallmatches">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.request.headers.getheader">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.headerfilter.request.headers.getheader.headername</string>
                                    <parameter valueTyp="3">
                                      <value>
                                        <stringValue value="User-Agent" stringModifier="true" typeId="com.scur.type.string"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.search</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="regex(.*Mozilla.*MS(IE) ([0-9]+\.[0-9]+).*Windows NT ([0-9\.]+).*)" stringModifier="false" typeId="com.scur.type.regex"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="\1\2-\3" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
            </expressions>
          </setActionContainer>
        </immediateActionContainers>
        <actionContainer actionId="com.scur.mainaction.continue"/>
        <condition always="false">
          <expressions>
            <conditionExpression openingBracketCount="0" closingBracketCount="0" operatorId="com.scur.operator.matches">
              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.request.headers.getheader">
                <parameters>
                  <entry>
                    <string>com.scur.engine.headerfilter.request.headers.getheader.headername</string>
                    <parameter valueTyp="3">
                      <value>
                        <stringValue value="User-Agent" stringModifier="true" typeId="com.scur.type.string"/>
                      </value>
                    </parameter>
                  </entry>
                </parameters>
              </propertyInstance>
              <parameter valueTyp="3" typeId="com.scur.type.regex">
                <value>
                  <stringValue value="regex(.*Mozilla.*MS(IE) ([0-9]+\.[0-9]+).*Windows NT ([0-9\.]+).*)" stringModifier="false" typeId="com.scur.type.regex"/>
                </value>
              </parameter>
            </conditionExpression>
          </expressions>
        </condition>
      </rule>
      <rule id="846" enabled="true" name="Create short User-Agent for Firefox">
        <description></description>
        <immediateActionContainers>
          <setActionContainer propertyId="266">
            <expressions>
              <setExpression openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceallmatches">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.request.headers.getheader">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.headerfilter.request.headers.getheader.headername</string>
                                    <parameter valueTyp="3">
                                      <value>
                                        <stringValue value="User-Agent" stringModifier="true" typeId="com.scur.type.string"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.search</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="regex(.*Mozilla.*Windows NT ([0-9\.]+).*Gecko.*Firefox/([0-9\.]+).*)" stringModifier="false" typeId="com.scur.type.regex"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="FF\2-\1" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
            </expressions>
          </setActionContainer>
        </immediateActionContainers>
        <actionContainer actionId="com.scur.mainaction.continue"/>
        <condition always="false">
          <expressions>
            <conditionExpression openingBracketCount="0" closingBracketCount="0" operatorId="com.scur.operator.matches">
              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.request.headers.getheader">
                <parameters>
                  <entry>
                    <string>com.scur.engine.headerfilter.request.headers.getheader.headername</string>
                    <parameter valueTyp="3">
                      <value>
                        <stringValue value="User-Agent" stringModifier="true" typeId="com.scur.type.string"/>
                      </value>
                    </parameter>
                  </entry>
                </parameters>
              </propertyInstance>
              <parameter valueTyp="3" typeId="com.scur.type.regex">
                <value>
                  <stringValue value="regex(.*Mozilla.*Windows NT ([0-9\.]+).*Gecko.*Firefox/([0-9\.]+).*)" stringModifier="false" typeId="com.scur.type.regex"/>
                </value>
              </parameter>
            </conditionExpression>
          </expressions>
        </condition>
      </rule>
      <rule id="851" enabled="true" name="Create short User-Agent for Chrome">
        <description></description>
        <immediateActionContainers>
          <setActionContainer propertyId="266">
            <expressions>
              <setExpression openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceallmatches">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.request.headers.getheader">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.headerfilter.request.headers.getheader.headername</string>
                                    <parameter valueTyp="3">
                                      <value>
                                        <stringValue value="User-Agent" stringModifier="true" typeId="com.scur.type.string"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.search</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="regex(Mozilla.*Windows NT ([0-9\.]+).*AppleWebKit.*KHTML, like Gecko.*Chrome\/([0-9]+)\..*Safari.*)" stringModifier="false" typeId="com.scur.type.regex"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="Chrome\2-\1" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
            </expressions>
          </setActionContainer>
        </immediateActionContainers>
        <actionContainer actionId="com.scur.mainaction.continue"/>
        <condition always="false">
          <expressions>
            <conditionExpression openingBracketCount="0" closingBracketCount="0" operatorId="com.scur.operator.matches">
              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.request.headers.getheader">
                <parameters>
                  <entry>
                    <string>com.scur.engine.headerfilter.request.headers.getheader.headername</string>
                    <parameter valueTyp="3">
                      <value>
                        <stringValue value="User-Agent" stringModifier="true" typeId="com.scur.type.string"/>
                      </value>
                    </parameter>
                  </entry>
                </parameters>
              </propertyInstance>
              <parameter valueTyp="3" typeId="com.scur.type.regex">
                <value>
                  <stringValue value="regex(Mozilla.*Windows NT ([0-9\.]+).*AppleWebKit.*KHTML, like Gecko.*Chrome\/([0-9]+)\..*Safari.*)" stringModifier="false" typeId="com.scur.type.regex"/>
                </value>
              </parameter>
            </conditionExpression>
          </expressions>
        </condition>
      </rule>
      <rule id="856" enabled="true" name="Get Content-Type from EnsuredMediaType">
        <description></description>
        <immediateActionContainers>
          <setActionContainer propertyId="264">
            <expressions>
              <setExpression openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.mediatypelist.tostring">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.mediatypelist.tostring.mediatypelist</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.mtfilter.property.ensured"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.mediatypelist.tostring.delimiter</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="," stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
            </expressions>
          </setActionContainer>
        </immediateActionContainers>
        <actionContainer actionId="com.scur.mainaction.continue"/>
        <condition always="false">
          <expressions>
            <conditionExpression openingBracketCount="0" closingBracketCount="0" operatorId="com.scur.operator.equals">
              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.listfilter.mediatypelist.isempty">
                <parameters>
                  <entry>
                    <string>com.scur.engine.listfilter.mediatypelist.isempty.list</string>
                    <parameter valueTyp="2">
                      <value>
                        <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.mtfilter.property.ensured"/>
                      </value>
                    </parameter>
                  </entry>
                </parameters>
              </propertyInstance>
              <parameter valueTyp="3" valueId="com.scur.type.boolean.false" typeId="com.scur.type.boolean"/>
            </conditionExpression>
          </expressions>
        </condition>
      </rule>
      <rule id="861" enabled="true" name="Get Conent-Type from Header if EnsuredMediaType doesnt exist">
        <description></description>
        <immediateActionContainers>
          <setActionContainer propertyId="264">
            <expressions>
              <setExpression openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.response.headers.getheader">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.headerfilter.response.headers.getheader.headername</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="Content-Type" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
            </expressions>
          </setActionContainer>
        </immediateActionContainers>
        <actionContainer actionId="com.scur.mainaction.continue"/>
        <condition always="false">
          <expressions>
            <conditionExpression openingBracketCount="0" closingBracketCount="0" operatorId="com.scur.operator.equals">
              <propertyInstance useMostRecentConfiguration="false" propertyId="264"/>
              <parameter valueTyp="3" typeId="com.scur.type.string">
                <value>
                  <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                </value>
              </parameter>
            </conditionExpression>
          </expressions>
        </condition>
      </rule>
      <rule id="866" enabled="true" name="prepare MWGaccess.log for Splunk">
        <description></description>
        <immediateActionContainers>
          <setActionContainer propertyId="1113">
            <expressions>
              <setExpression openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="status=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.number.tostring">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.number.tostring.number</string>
                                    <parameter valueTyp="2">
                                      <value>
                                        <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.response.statuscode"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="/" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.number.tostring">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.number.tostring.number</string>
                                    <parameter valueTyp="2">
                                      <value>
                                        <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.blockreasonid"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; srcip=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.ip.tostring">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.ip.tostring.ip</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.client.ip"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; user=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.auth.username"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; dhost=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.url.host"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; destip=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.ip.tostring">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.ip.tostring.ip</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.destination.ip"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; urlp=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.number.tostring">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.number.tostring.number</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.url.port"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; proto=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.connection.protocol"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="/" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.url.protocol"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; mtd=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.command.name"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; urlc=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.trustedsource.categorylist.tostring">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.trustedsource.categorylist.tostring.categorylist</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="true" propertyId="com.scur.engine.trustedsource.url.categories"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; rep=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.number.tostring">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.number.tostring.number</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="true" propertyId="com.scur.engine.trustedsource.url.reputation"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; mt=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceallmatches">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="264"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.search</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="regex(&quot;)" stringModifier="false" typeId="com.scur.type.regex"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="%22" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; mlwr=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.stringlist.tostring">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.stringlist.tostring.stringlist</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="true" propertyId="com.scur.engine.antivirus.av.virusnames"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.stringlist.tostring.delimiter</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value=", " stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; app=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.applcontrol.tostring">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.applcontrol.tostring.applcontrol</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.applcontrol.name"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; bytes=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.number.tostring">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.number.tostring.number</string>
                                    <parameter valueTyp="2">
                                      <value>
                                        <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.bytesrecvfromclient"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="/" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.number.tostring">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.number.tostring.number</string>
                                    <parameter valueTyp="2">
                                      <value>
                                        <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.bytessenttoserver"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="/" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.number.tostring">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.number.tostring.number</string>
                                    <parameter valueTyp="2">
                                      <value>
                                        <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.bytesrecvfromserver"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="/" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.number.tostring">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.number.tostring.number</string>
                                    <parameter valueTyp="2">
                                      <value>
                                        <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.bytessenttoclient"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; ua=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="266"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceallmatches">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.string.replaceallmatches.source</string>
                                    <parameter valueTyp="2">
                                      <value>
                                        <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.request.headers.getheader">
                                          <parameters>
                                            <entry>
                                              <string>com.scur.engine.headerfilter.request.headers.getheader.headername</string>
                                              <parameter valueTyp="3">
                                                <value>
                                                  <stringValue value="User-Agent" stringModifier="true" typeId="com.scur.type.string"/>
                                                </value>
                                              </parameter>
                                            </entry>
                                          </parameters>
                                        </propertyInstance>
                                      </value>
                                    </parameter>
                                  </entry>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.string.replaceallmatches.search</string>
                                    <parameter valueTyp="3">
                                      <value>
                                        <stringValue value="regex(&quot;)" stringModifier="false" typeId="com.scur.type.regex"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.string.replaceallmatches.replace</string>
                                    <parameter valueTyp="3">
                                      <value>
                                        <stringValue value="%22" stringModifier="true" typeId="com.scur.type.string"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; http_referrer=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceallmatches">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.request.headers.getheader">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.headerfilter.request.headers.getheader.headername</string>
                                    <parameter valueTyp="3">
                                      <value>
                                        <stringValue value="Referer" stringModifier="true" typeId="com.scur.type.string"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.search</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="regex(&quot;)" stringModifier="false" typeId="com.scur.type.regex"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="%22" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; lat=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.number.tostring">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.number.tostring.number</string>
                                    <parameter valueTyp="2">
                                      <value>
                                        <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.timer.resolvehostviadns"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="/" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.number.tostring">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.number.tostring.number</string>
                                    <parameter valueTyp="2">
                                      <value>
                                        <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.timer.handleconnecttoserver"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="/" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.number.tostring">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.number.tostring.number</string>
                                    <parameter valueTyp="2">
                                      <value>
                                        <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.timer.firstsentfirstreceivedserver"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="/" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceifequals">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.number.tostring">
                                <parameters>
                                  <entry>
                                    <string>com.scur.engine.stringfilter.number.tostring.number</string>
                                    <parameter valueTyp="2">
                                      <value>
                                        <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.timer.timefortransaction"/>
                                      </value>
                                    </parameter>
                                  </entry>
                                </parameters>
                              </propertyInstance>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.substring</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceifequals.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="-" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; rule=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceallmatches">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.rules.currentrulename"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.search</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="regex(&quot;)" stringModifier="false" typeId="com.scur.type.regex"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value=" " stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; url=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceallmatches">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.url.raw"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.search</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="regex(&quot;)" stringModifier="false" typeId="com.scur.type.regex"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="%22" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; file_name=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.system.url.filename"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; file_hash_md5=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.bodyfilter.body.hash">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.bodyfilter.body.hash.type</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="md5" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; rep_level=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="true" propertyId="com.scur.engine.trustedsource.url.reputationstring"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; cache_control=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.response.headers.getheader">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.headerfilter.response.headers.getheader.headername</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="Cache-Control" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; encoding_type=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.headerfilter.request.headers.getheader">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.headerfilter.request.headers.getheader.headername</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="Accept-Encoding" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; ssl_cert_sha2=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.certificatefilter.ssl.certificate.sha256digest"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot; ssl_cert_name=&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.certificatefilter.ssl.certificate.cn"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value="&quot;" stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
            </expressions>
          </setActionContainer>
        </immediateActionContainers>
        <actionContainer actionId="com.scur.mainaction.continue"/>
        <condition always="true">
          <expressions/>
        </condition>
      </rule>
      <rule id="870" enabled="true" name="Remove empty key value pairs">
        <description>This rule will remove empty key value pairs hence empty key value pair will not be logged.</description>
        <immediateActionContainers>
          <setActionContainer propertyId="1113">
            <expressions>
              <setExpression openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.stringfilter.string.replaceallmatches">
                      <parameters>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.source</string>
                          <parameter valueTyp="2">
                            <value>
                              <propertyInstance useMostRecentConfiguration="false" propertyId="1113"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.search</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="regex(\s[^\s=]+=(\&quot;\&quot;|\&quot;-\/-\&quot;|\&quot;-\/-\/-\/-\&quot;))" stringModifier="false" typeId="com.scur.type.regex"/>
                            </value>
                          </parameter>
                        </entry>
                        <entry>
                          <string>com.scur.engine.stringfilter.string.replaceallmatches.replace</string>
                          <parameter valueTyp="3">
                            <value>
                              <stringValue value="" stringModifier="true" typeId="com.scur.type.string"/>
                            </value>
                          </parameter>
                        </entry>
                      </parameters>
                    </propertyInstance>
                  </value>
                </parameter>
              </setExpression>
            </expressions>
          </setActionContainer>
        </immediateActionContainers>
        <actionContainer actionId="com.scur.mainaction.continue"/>
        <condition always="true">
          <expressions/>
        </condition>
      </rule>
      <rule id="874" enabled="false" name="Log via Syslog">
        <description>you need to modify /etc/rsyslog.conf via MWG UI (Configuration > File Editor > [hostname] > rsyslog.conf
and add (replace splunk-server with a hostname or an IP address of your splunk server):
*.* @@splunk-server:9997
</description>
        <immediateActionContainers>
          <executeActionContainer>
            <procedureValue procedureId="com.scur.engine.syslog.syslog">
              <parameters>
                <entry>
                  <string>com.scur.engine.syslog.level</string>
                  <parameter valueTyp="3">
                    <value>
                      <stringValue value="6" stringModifier="false" typeId="com.scur.type.number"/>
                    </value>
                  </parameter>
                </entry>
                <entry>
                  <string>com.scur.engine.syslog.message</string>
                  <parameter valueTyp="2">
                    <value>
                      <propertyInstance useMostRecentConfiguration="false" propertyId="1113"/>
                    </value>
                  </parameter>
                </entry>
              </parameters>
            </procedureValue>
          </executeActionContainer>
        </immediateActionContainers>
        <actionContainer actionId="com.scur.mainaction.continue"/>
        <condition always="true">
          <expressions/>
        </condition>
      </rule>
      <rule id="878" enabled="true" name="Add a timestamp">
        <description></description>
        <immediateActionContainers>
          <setActionContainer propertyId="1113">
            <expressions>
              <setExpression openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="com.scur.engine.datetimefilter.datetime.towebreporterstring"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="3">
                  <value>
                    <stringValue value=" " stringModifier="true" typeId="com.scur.type.string"/>
                  </value>
                </parameter>
              </setExpression>
              <setExpression operator="+" openingBracketCount="0" closingBracketCount="0">
                <parameter valueTyp="2">
                  <value>
                    <propertyInstance useMostRecentConfiguration="false" propertyId="1113"/>
                  </value>
                </parameter>
              </setExpression>
            </expressions>
          </setActionContainer>
        </immediateActionContainers>
        <actionContainer actionId="com.scur.mainaction.continue"/>
        <condition always="true">
          <expressions/>
        </condition>
      </rule>
      <rule id="883" enabled="true" name="Write MWGaccess.log for Splunk">
        <description></description>
        <immediateActionContainers>
          <executeActionContainer configurationId="com.scur.engine.filesystemlogging.263">
            <procedureValue procedureId="com.scur.engine.filesystemlogging.writelogentry">
              <parameters>
                <entry>
                  <string>com.scur.engine.filesystemlogging.writelogentry.logstring</string>
                  <parameter valueTyp="2">
                    <value>
                      <propertyInstance useMostRecentConfiguration="false" propertyId="1113"/>
                    </value>
                  </parameter>
                </entry>
              </parameters>
            </procedureValue>
          </executeActionContainer>
        </immediateActionContainers>
        <actionContainer actionId="com.scur.mainaction.continue"/>
        <condition always="true">
          <expressions/>
        </condition>
      </rule>
    </rules>
    <ruleGroups/>
  </ruleGroup>
</libraryContent>