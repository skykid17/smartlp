##
## SPDX-FileCopyrightText: 2024 Splunk, Inc.
## SPDX-License-Identifier: LicenseRef-Splunk-8-2021
##
##

[github:enterprise:audit]
SHOULD_LINEMERGE = false
EVENT_BREAKER_ENABLE = true
KV_MODE = JSON

REPORT-github_extract_dvc_dest = github_extract_dvc_dest
REPORT-github_extract_referrer_pr_id = github_extract_referrer_pr_id

FIELDALIAS-reason = data.failure_reason as reason
FIELDALIAS-user_agent = data.user_agent as user_agent
FIELDALIAS-object_attrs = action as object_attrs
FIELDALIAS-result = action as result
FIELDALIAS-vendor_action = action as vendor_action
FIELDALIAS-vendor_user = user as vendor_user
FIELDALIAS-object_category = data.category_type as object_category

EVAL-app = "GitHub Enterprise"
EVAL-dvc = coalesce(dvc, host)
EVAL-command = case(vendor_action IN ("integration.create","management_console.save_settings","role.create","vulnerability_alert_rule.create"),vendor_action,true(),'data.controller_action')
EVAL-src = case(vendor_action == "business.update_terms_of_service",'data.business',vendor_action == "integration.create",org,true(),actor_ip)
EVAL-dest = coalesce(dest,case(vendor_action IN ("management_console.user_sign_in", "management_console.save_settings", "role.create", "vulnerability_alert_rule.create"),host,vendor_action == "business.update_terms_of_service",'data.business',vendor_action == "integration.create",'data.integration'))
EVAL-src_user = case(vendor_action IN ("management_console.user_sign_in"), 'data.mc_actor', vendor_action IN ("business.add_admin"), vendor_user, true(), actor)
EVAL-user = case(vendor_action IN ("user.async_delete","user.delete","org.add_member","lockout.remove","business.add_admin"), vendor_user, vendor_action IN ("management_console.user_sign_in","management_console.save_settings"), 'data.mc_actor', true(), actor)
EVAL-signature = case(vendor_action IN ("user.failed_login","user.login","public_key.verify"), vendor_action)
EVAL-vendor_product = "GitHub Enterprise"
EVAL-vendor = "GitHub"
EVAL-product = "Enterprise"
EVAL-object = case(vendor_action IN ("oauth_access.create", "oauth_access.destroy", "enterprise.config.lock_anonymous_git_access", "enterprise.config.disable_anonymous_git_access"),actor,vendor_action IN ("oauth_application.destroy", "oauth_application.transfer", "oauth_application.revoke_all_tokens", "oauth_application.revoke_tokens", "oauth_application.generate_client_secret", "oauth_application.remove_client_secret","oauth_application.create"),'data.oauth_application',vendor_action IN ("business.advanced_security_policy_update", "business.clear_members_can_create_repos", "business.referrer_override_enable", "business.referrer_override_disable","business.update_member_repository_creation_permission", "hook.create", "hook.config_changed", "hook.events_changed", "hook.destroy", "protected_branch.create", "protected_branch.update_required_status_checks_enforcement_level", "protected_branch.update_linear_history_requirement_enforcement_level", "protected_branch.update_pull_request_reviews_enforcement_level", "protected_branch.update_admin_enforced", "protected_branch.update_signature_requirement_enforcement_level","hook.active_changed","protected_branch.dismiss_stale_reviews","protected_branch.update_allow_deletions_enforcement_level","protected_branch.update_allow_force_pushes_enforcement_level","protected_branch.update_require_code_owner_review","release.destroy","role.create"),'data.name',vendor_action IN ("public_key.create", "public_key.delete", "issue.update", "issue.destroy"),'data.title',vendor_action IN ("org.async_delete", "org.delete", "org.update_member_repository_creation_permission", "private_repository_forking.enable", "private_repository_forking.disable", "org.enable_member_team_creation_permission", "org.advanced_security_policy_selected_member_enabled", "business.remove_organization", "business.add_organization", "org.create", "org.add_member","org.display_commenter_full_name_enabled","org.set_workflow_permission_can_approve_pr"),org,vendor_action IN ("email_role.create", "user.async_delete", "user.delete", "user.create", "lockout.remove", "user.reset_password"),user,vendor_action IN ("repo.disk_archive", "repo.destroy", "repo.create", "repository_secret_scanning.disable","repo.access","repo.archived","repo.rename_branch","repo.transfer","repo.unarchived","repo.update_default_branch","repository_branch_protection_evaluation.disable","repository_projects_change.disable","repository_projects_change.enable","repo.add_member","repo.remove_member", "repo.update_member"),repo,vendor_action IN ("config_entry.create","config_entry.destroy","config_entry.update","business.update_default_repository_permission","business.update_terms_of_service","business.add_admin"),'data.business',vendor_action IN ("oauth_authorization.destroy","oauth_authorization.create"),'data.application_name',vendor_action == "user_default_label.destroy",'data.user_default_label',vendor_action IN ("pull_request.close", "pull_request.reopen", "pull_request.merge", "pull_request_review.submit", "pull_request.ready_for_review", "pull_request.converted_to_draft", "pull_request.create","staff.minimize_comment","team_discussions.disable","team_discussions.enable","personal_access_token.create"), case(isnotnull('data.pull_request_url'), 'data.pull_request_url', isnotnull('data.referrer'), 'data.referrer'),vendor_action == "repo.change_merge_setting","repo", vendor_action IN ("discussion_post.destroy","project_field.create","pull_request_review.update","pull_request_review_comment.create","pull_request_review_comment.delete","pull_request_review_comment.update","pull_request_review_thread.create","staff.repo_lock","staff.repo_unlock","staff.view_audit_log","staff.view_site_admins","user.mandatory_message_viewed","user.minimize_comment","issue_comment.update","personal_access_token.credential_regenerated","personal_access_token.destroy"),'data.url',vendor_action IN ("enterprise_domain.create","enterprise_domain.destroy","enterprise_domain.approve"),'data.domain_name',vendor_action == "integration.create",'data.integration',vendor_action == "newsletter_preference.create",'data.job',vendor_action == "organization_default_label.create",'data.organization_default_label',vendor_action IN ("project.close","project.create","project.update","project_view.create"),'data.project_kind',vendor_action == "repo.transfer_outgoing",'data.new_owner',vendor_action IN ("repository_ruleset.create","repository_ruleset.destroy","repository_ruleset.update"),'data.ruleset_name',vendor_action IN ("team.add_repository","team.create","team.remove_repository","team.update_repository_permission","team.add_member"),'data.team',vendor_action == "vulnerability_alert_rule.create",'data.vulnerability_alert_rule_name',vendor_action == "management_console.save_settings","management_console", vendor_action IN ("personal_access_token.access_granted","personal_access_token.access_revoked","personal_access_token.request_created"),'data.target')
EVAL-object_id = case(vendor_action == "issue_comment.update",'data.issue_comment_id',vendor_action IN ("oauth_access.create", "oauth_access.destroy", "enterprise.config.lock_anonymous_git_access", "enterprise.config.disable_anonymous_git_access"),actor_id,vendor_action IN ("oauth_application.destroy", "oauth_application.transfer", "oauth_application.revoke_all_tokens", "oauth_application.revoke_tokens", "oauth_application.generate_client_secret", "oauth_application.remove_client_secret","oauth_application.create"),'data.oauth_application_id',vendor_action IN ("business.advanced_security_policy_update", "business.clear_members_can_create_repos", "business.referrer_override_enable", "business.referrer_override_disable", "business.update_member_repository_creation_permission", "config_entry.create", "config_entry.destroy", "config_entry.update","business.add_admin","business.update_default_repository_permission","business.update_terms_of_service"),'data.business_id',vendor_action IN ("hook.create", "hook.config_changed", "hook.events_changed", "hook.destroy","hook.active_changed"),'data.hook_id',vendor_action IN ("protected_branch.create", "protected_branch.update_required_status_checks_enforcement_level", "protected_branch.update_linear_history_requirement_enforcement_level", "protected_branch.update_pull_request_reviews_enforcement_level", "protected_branch.update_admin_enforced", "protected_branch.update_signature_requirement_enforcement_level","protected_branch.dismiss_stale_reviews","protected_branch.update_allow_deletions_enforcement_level","protected_branch.update_allow_force_pushes_enforcement_level","protected_branch.update_require_code_owner_review"),'data.protected_branch_id',vendor_action IN ("public_key.create", "public_key.delete"),'data.public_key_id',vendor_action IN ("issue.update", "issue.destroy"),'data.issue_id',vendor_action IN ("org.async_delete", "org.delete", "org.update_member_repository_creation_permission", "private_repository_forking.enable", "private_repository_forking.disable", "org.enable_member_team_creation_permission", "org.advanced_security_policy_selected_member_enabled", "business.remove_organization", "business.add_organization", "org.create", "org.add_member","org.display_commenter_full_name_enabled","org.set_workflow_permission_can_approve_pr"),org_id,vendor_action IN ("email_role.create", "user.async_delete", "user.delete", "user.create", "lockout.remove", "user.reset_password"),user_id,vendor_action IN ("repo.disk_archive", "repo.destroy", "repo.create", "repository_secret_scanning.disable","repo.access","repo.archived","repo.rename_branch","repo.transfer","repo.unarchived","repo.update_default_branch","repository_branch_protection_evaluation.disable","repository_projects_change.disable","repository_projects_change.enable","repo.add_member","repo.remove_member","repo.update_member"),repo_id,vendor_action IN ("oauth_authorization.destroy","oauth_authorization.create"),'data.oauth_authorization_id',vendor_action == "user_default_label.destroy",'data.user_default_label_id',vendor_action IN ("pull_request.close", "pull_request.reopen", "pull_request.merge", "pull_request_review.submit", "pull_request.ready_for_review", "pull_request.converted_to_draft"),referrer_pr_id,vendor_action == "pull_request.create",'data.pull_request_id',vendor_action == "discussion_post.destroy",'data.number',vendor_action IN ("enterprise_domain.create","enterprise_domain.destroy","enterprise_domain.approve"),'data.verifiable_domain_id',vendor_action == "integration.create",'data.integration_id',vendor_action == "newsletter_preference.create",'data.active_job_id',vendor_action == "organization_default_label.create",'data.organization_default_label_id',vendor_action IN ("project.close","project.create","project.update","project_view.create"),'data.project_id',vendor_action == "project_field.create",'data.project_field_id',vendor_action == "pull_request_review.update",'data.review_id',vendor_action IN ("pull_request_review_comment.create","pull_request_review_comment.delete","pull_request_review_comment.update","staff.minimize_comment","user.minimize_comment"),'data.comment_id',vendor_action == "pull_request_review_thread.create",'data.pull_request_review_thread_id',vendor_action == "release.destroy",'data.release_id',vendor_action == "repo.transfer_outgoing",'data.new_owner_id',vendor_action IN ("repository_ruleset.create","repository_ruleset.destroy","repository_ruleset.update"),'data.ruleset_id',vendor_action IN ("team.add_repository","team.create","team.remove_repository","team.update_repository_permission","team.add_member"),'data.team_id',vendor_action == "vulnerability_alert_rule.create",'data.vulnerability_alert_rule_id',vendor_action == "management_console.save_settings",'data._document_id', vendor_action IN ("personal_access_token.access_granted","personal_access_token.access_revoked","personal_access_token.request_created"),'data.target_id', vendor_action IN ("personal_access_token.destroy","personal_access_token.credential_regenerated","personal_access_token.create"),'data.user_programmatic_access_id')
EVAL-object_path = case(vendor_action IN ("business.update_default_repository_permission","discussion_post.destroy","enterprise_domain.create","enterprise_domain.destroy","hook.active_changed","org.display_commenter_full_name_enabled","project.update","enterprise_domain.approve","repo.transfer","personal_access_token.request_created","personal_access_token.destroy","personal_access_token.credential_regenerated", "repo.remove_member", "project.close"),'data.url',vendor_action == "pull_request_review.update",'data.pull_request_url',vendor_action == "repo.transfer",repo_id, vendor_action IN ("repository_projects_change.disable","repository_projects_change.enable","repo.add_member","repo.update_member", "repo.access"),repo,vendor_action == "management_console.save_settings",'data.path', vendor_action=="team.add_member",'data.team',vendor_action == "personal_access_token.create",'data.referrer')

LOOKUP-github_action_lookup = github_action_lookup vendor_action OUTPUT action, change_type, status, event_group

[github:cloud:audit]
TIME_PREFIX = "created_at":|"@timestamp":
SHOULD_LINEMERGE = false
EVENT_BREAKER_ENABLE = false
KV_MODE = JSON

REPORT-github_pr_object_path = github_pr_object_path

FIELDALIAS-command = action as command
FIELDALIAS-object_attrs_from_action = action as object_attrs
FIELDALIAS-result = action as result
FIELDALIAS-src_user_from_actor = actor as src_user
FIELDALIAS-vendor_action = action as vendor_action
FIELDALIAS-vendor_region = actor_location.country_code as vendor_region
FIELDALIAS-vendor_user = user as vendor_user

EVAL-object = case(vendor_action IN ("pull_request.create","pull_request.close","pull_request.reopen","pull_request.merge","pull_request.ready_for_review","pull_request.create_review_request"),pull_request_url,vendor_action IN ("org.remove_member","org.update_member","org.add_member","org.invite_member","org.oauth_app_access_approved","org_credential_authorization.deauthorize","org_credential_authorization.grant","org.advanced_security_policy_selected_member_disabled","org.advanced_security_policy_selected_member_enabled","organization_projects_change.clear","organization_projects_change.disable","organization_projects_change.enable","org.enable_two_factor_requirement","org.disable_two_factor_requirement","org.enable_saml","org.update_saml_provider_settings","org.oauth_app_access_denied","org.disable_oauth_app_restrictions","org.disable_saml","org.block_user","org.integration_manager_added","org.integration_manager_removed","org.remove_outside_collaborator","org.restore_member","org.unblock_user","org.accept_business_invitation","org.cancel_business_invitation","org.cancel_invitation","org.config.disable_collaborators_only","org.config.disable_contributors_only","org.config.disable_sockpuppet_disallowed","org.config.enable_collaborators_only","org.config.enable_contributors_only","org.config.enable_sockpuppet_disallowed","org.confirm_business_invitation","org.disable_reader_discussion_creation_permission","org.display_commenter_full_name_disabled","org.display_commenter_full_name_enabled","org.enable_reader_discussion_creation_permission","org.secret_scanning_custom_pattern_push_protection_disabled","org.secret_scanning_custom_pattern_push_protection_enabled","org.secret_scanning_push_protection_custom_message_disabled","org.secret_scanning_push_protection_custom_message_enabled","org.secret_scanning_push_protection_disable","org.secret_scanning_push_protection_enable","org.secret_scanning_push_protection_new_repos_enable","org.set_default_workflow_permissions","org.set_workflow_permission_can_approve_pr","org.create","org.create_actions_secret","org.create_integration_secret","org.disable_member_team_creation_permission","org.enable_member_team_creation_permission","org.enable_oauth_app_restrictions","org.remove_actions_secret","org.remove_integration_secret","org.rename","org.update_actions_secret","org.update_actions_settings","org.update_default_repository_permission","org.update_integration_secret","org.advanced_security_disabled_for_new_repos","org.advanced_security_disabled_on_all_repos","org.advanced_security_enabled_for_new_repos","org.advanced_security_enabled_on_all_repos","org.allow_third_party_access_requests_from_outside_collaborators_disabled","org.allow_third_party_access_requests_from_outside_collaborators_enabled","org.runner_group_created","org.runner_group_removed","org.runner_group_updated","org.set_actions_fork_pr_approvals_policy","org.set_actions_retention_limit","org.update_member_repository_creation_permission","org.update_member_repository_invitation_permission","org.update_new_repository_default_branch_setting","org.update_terms_of_service"),if(isnotnull(org),org,"organization"),vendor_action IN ("team.add_member","team.remove_member","team_discussions.clear","team_discussions.disable","team_discussions.enable","team.create","team.destroy","team.change_privacy","team.change_parent_team","team.demote_maintainer","team.add_repository","team.remove_repository","team.rename","team.update_repository_permission","team.promote_maintainer"),if(isnotnull(team),team,"team"),vendor_action == "workflows.prepared_workflow_job",job_name,vendor_action IN ("workflows.completed_workflow_run","workflows.created_workflow_run","workflows.enable_workflow"),if(isnotnull(name),name,"workflow"),vendor_action IN ("repository_vulnerability_alerts.enable","repo.advanced_security_enabled","repository_secret_scanning_push_protection.disable","repository_dependency_graph.enable","repository_secret_scanning.enable","repo.actions_enabled","repo.create","repo.change_merge_setting","git.fetch","git.push","git.clone","members_can_delete_repos.clear","members_can_delete_repos.disable","members_can_delete_repos.enable","repository_visibility_change.clear","repository_visibility_change.disable","repository_visibility_change.enable","repository_projects_change.clear","repository_projects_change.disable","repository_projects_change.enable","repo.add_member","repo.remove_member","repo.update_member","repo.code_scanning_analysis_deleted","repo.code_scanning_configuration_for_branch_deleted","repo.register_self_hosted_runner","repo.remove_self_hosted_runner","repo.self_hosted_runner_offline","repo.self_hosted_runner_online","repo.transfer_outgoing","repo.access","repo.advanced_security_disabled","repo.archived","repo.config.disable_collaborators_only","repo.config.disable_contributors_only","repo.config.disable_sockpuppet_disallowed","repo.config.enable_collaborators_only","repo.config.enable_contributors_only","repo.config.enable_sockpuppet_disallowed","repo.create_actions_secret","repo.create_integration_secret","repo.destroy","repo.remove_actions_secret","repo.remove_integration_secret","repo.rename","repo.transfer","repo.unarchived","repo.update_actions_secret","repo.update_actions_settings","repo.update_default_branch","repo.update_integration_secret","repo.add_topic","repo.codeql_enabled","repo.pages_cname","repo.pages_create","repo.pages_destroy","repo.pages_https_redirect_disabled","repo.pages_https_redirect_enabled","repo.pages_private","repo.pages_public","repo.pages_source","repo.remove_topic","repo.set_actions_fork_pr_approvals_policy","repo.set_actions_retention_limit"),if(isnotnull(repo),repo,"repo"),vendor_action == "integration_installation.repositories_added",name,vendor_action IN ("private_repository_forking.clear","private_repository_forking.disable","private_repository_forking.enable"),"private_repository",vendor_action IN ("business.set_fork_pr_workflows_policy","business.set_actions_retention_limit","business.update_member_repository_invitation_permission","business.clear_members_can_create_repos","business.update_member_repository_creation_permission","business_secret_scanning_custom_pattern.delete","business_secret_scanning_custom_pattern.update","business_secret_scanning_custom_pattern.create","business.advanced_security_policy_update","business.set_actions_fork_pr_approvals_policy","business.update_actions_settings","business.remove_member","business.enable_two_factor_requirement","business.disable_two_factor_requirement"),if(isnotnull(name),name,"enterprise"),vendor_action IN ("issues.deletes_policy_cleared","issues.deletes_disabled","issues.deletes_enabled"),"issue",vendor_action IN ("members_can_view_dependency_insights.clear","members_can_view_dependency_insights.disable","members_can_view_dependency_insights.enable"),"members",vendor_action == "hook.create",name)
EVAL-object_id = case(vendor_action == "workflows.prepared_workflow_job",workflow_run_id,vendor_action IN ("workflows.completed_workflow_run","workflows.created_workflow_run","workflows.enable_workflow"),workflow_id,vendor_action IN ("pull_request.create","pull_request.close","pull_request.reopen","pull_request.merge","pull_request.ready_for_review","pull_request.create_review_request"),pull_request_id,vendor_action IN ("org.add_member","org.block_user","org.integration_manager_added","org.integration_manager_removed","org.invite_member","org.remove_member","org.remove_outside_collaborator","org.restore_member","org.update_member","org.accept_business_invitation","org.cancel_business_invitation","org.cancel_invitation","org.config.disable_collaborators_only","org.config.disable_contributors_only","org.config.disable_sockpuppet_disallowed","org.config.enable_collaborators_only","org.config.enable_contributors_only","org.config.enable_sockpuppet_disallowed","org.confirm_business_invitation","org.disable_reader_discussion_creation_permission","org.display_commenter_full_name_disabled","org.display_commenter_full_name_enabled","org.enable_reader_discussion_creation_permission","org.secret_scanning_custom_pattern_push_protection_disabled","org.secret_scanning_custom_pattern_push_protection_enabled","org.secret_scanning_push_protection_custom_message_disabled","org.secret_scanning_push_protection_custom_message_enabled","org.secret_scanning_push_protection_disable","org.secret_scanning_push_protection_enable","org.secret_scanning_push_protection_new_repos_enable","org.set_default_workflow_permissions","org.set_workflow_permission_can_approve_pr","org.advanced_security_policy_selected_member_disabled","org.advanced_security_policy_selected_member_enabled","org.create","org.create_actions_secret","org.disable_member_team_creation_permission","org.disable_oauth_app_restrictions","org.disable_two_factor_requirement","org.enable_oauth_app_restrictions","org.enable_two_factor_requirement","org.oauth_app_access_approved","org.oauth_app_access_denied","org.remove_actions_secret","org.remove_integration_secret","org.rename","org.update_actions_secret","org.update_actions_settings","org.update_default_repository_permission","org.update_integration_secret","org.advanced_security_disabled_for_new_repos","org.advanced_security_disabled_on_all_repos","org.advanced_security_enabled_for_new_repos","org.advanced_security_enabled_on_all_repos","org.allow_third_party_access_requests_from_outside_collaborators_disabled","org.allow_third_party_access_requests_from_outside_collaborators_enabled","org.runner_group_created","org.runner_group_removed","org.runner_group_updated","org.set_actions_fork_pr_approvals_policy","org.set_actions_retention_limit","org.update_member_repository_creation_permission","org.update_member_repository_invitation_permission","org.update_new_repository_default_branch_setting","org.update_terms_of_service","org.create_integration_secret","org.enable_member_team_creation_permission","org.unblock_user"),org_id,vendor_action IN ("repo.add_member","repo.remove_member","repo.update_member","repo.code_scanning_analysis_deleted","repo.code_scanning_configuration_for_branch_deleted","repo.register_self_hosted_runner","repo.remove_self_hosted_runner","repo.self_hosted_runner_offline","repo.self_hosted_runner_online","repo.transfer_outgoing","repo.access","repo.actions_enabled","repo.advanced_security_disabled","repo.advanced_security_enabled","repo.archived","repo.change_merge_setting","repo.config.disable_collaborators_only","repo.config.disable_contributors_only","repo.config.disable_sockpuppet_disallowed","repo.config.enable_collaborators_only","repo.config.enable_contributors_only","repo.config.enable_sockpuppet_disallowed","repo.create","repo.create_actions_secret","repo.create_integration_secret","repo.destroy","repo.remove_actions_secret","repo.remove_integration_secret","repo.rename","repo.transfer","repo.unarchived","repo.update_actions_secret","repo.update_actions_settings","repo.update_default_branch","repo.update_integration_secret","repo.add_topic","repo.codeql_enabled","repo.pages_cname","repo.pages_create","repo.pages_destroy","repo.pages_https_redirect_disabled","repo.pages_https_redirect_enabled","repo.pages_private","repo.pages_public","repo.pages_source","repo.remove_topic","repo.set_actions_fork_pr_approvals_policy","repo.set_actions_retention_limit"),repo_id,vendor_action == "hook.create",hook_id)
EVAL-dvc = "github.com"
EVAL-status = if(isnotnull(conclusion),conclusion,"success")
EVAL-src = case(isnotnull(actor_ip) AND actor_ip!="null", actor_ip, true(), null())
EVAL-user = case(vendor_action IN ("org.remove_member","org.update_member","org.add_member","org.invite_member","team.add_member","team.remove_member","org.remove_outside_collaborator","org.restore_member","repo.add_member","repo.remove_member","repo.update_member","team.demote_maintainer","team.promote_maintainer","team.remove_member"),user,vendor_action IN ("org.block_user","org.unblock_user"),blocked_user,vendor_action IN ("org.integration_manager_added","org.integration_manager_removed"),manager,true(),actor)
EVAL-vendor_product = "GitHub Cloud"
EVAL-app = "GitHub"
EVAL-description = case(vendor_action IN ("repository_vulnerability_alert.create","repository_vulnerability_alert.reopen"),vendor_action)
EVAL-dest = case(vendor_action IN ("repository_vulnerability_alert.create","repository_vulnerability_alert.reopen","repo.add_member","repo.remove_member","repo.update_member","repo.code_scanning_analysis_deleted","repo.code_scanning_configuration_for_branch_deleted","repo.register_self_hosted_runner","repo.remove_self_hosted_runner","repo.self_hosted_runner_offline","repo.self_hosted_runner_online","repo.transfer_outgoing","repo.access","repo.actions_enabled","repo.advanced_security_disabled","repo.advanced_security_enabled","repo.archived","repo.change_merge_setting","repo.config.disable_collaborators_only","repo.config.disable_contributors_only","repo.config.disable_sockpuppet_disallowed","repo.config.enable_collaborators_only","repo.config.enable_contributors_only","repo.config.enable_sockpuppet_disallowed","repo.create","repo.create_actions_secret","repo.create_integration_secret","repo.destroy","repo.remove_actions_secret","repo.remove_integration_secret","repo.rename","repo.transfer","repo.unarchived","repo.update_actions_secret","repo.update_actions_settings","repo.update_default_branch","repo.update_integration_secret","repo.add_topic","repo.codeql_enabled","repo.pages_cname","repo.pages_create","repo.pages_destroy","repo.pages_https_redirect_disabled","repo.pages_https_redirect_enabled","repo.pages_private","repo.pages_public","repo.pages_source","repo.remove_topic","repo.set_actions_fork_pr_approvals_policy","repo.set_actions_retention_limit"),repo,vendor_action IN ("team.add_member","team.demote_maintainer","team.promote_maintainer","team.remove_member","team.add_repository","team.change_parent_team","team.change_privacy","team.create","team.destroy","team.remove_repository","team.rename","team.update_repository_permission"),team,vendor_action IN ("org.add_member","org.block_user","org.integration_manager_added","org.integration_manager_removed","org.invite_member","org.remove_member","org.remove_outside_collaborator","org.restore_member","org.unblock_user","org.update_member","org.accept_business_invitation","org.cancel_business_invitation","org.cancel_invitation","org.config.disable_collaborators_only","org.config.disable_contributors_only","org.config.disable_sockpuppet_disallowed","org.config.enable_collaborators_only","org.config.enable_contributors_only","org.config.enable_sockpuppet_disallowed","org.confirm_business_invitation","org.disable_reader_discussion_creation_permission","org.display_commenter_full_name_disabled","org.display_commenter_full_name_enabled","org.enable_reader_discussion_creation_permission","org.secret_scanning_custom_pattern_push_protection_disabled","org.secret_scanning_custom_pattern_push_protection_enabled","org.secret_scanning_push_protection_custom_message_disabled","org.secret_scanning_push_protection_custom_message_enabled","org.secret_scanning_push_protection_disable","org.secret_scanning_push_protection_enable","org.secret_scanning_push_protection_new_repos_enable","org.set_default_workflow_permissions","org.set_workflow_permission_can_approve_pr","org.advanced_security_policy_selected_member_disabled","org.advanced_security_policy_selected_member_enabled","org.create","org.create_actions_secret","org.create_integration_secret","org.disable_member_team_creation_permission","org.disable_oauth_app_restrictions","org.disable_two_factor_requirement","org.enable_member_team_creation_permission","org.enable_oauth_app_restrictions","org.enable_two_factor_requirement","org.oauth_app_access_approved","org.oauth_app_access_denied","org.remove_actions_secret","org.remove_integration_secret","org.rename","org.update_actions_secret","org.update_actions_settings","org.update_default_repository_permission","org.update_integration_secret","org.advanced_security_disabled_for_new_repos","org.advanced_security_disabled_on_all_repos","org.advanced_security_enabled_for_new_repos","org.advanced_security_enabled_on_all_repos","org.allow_third_party_access_requests_from_outside_collaborators_disabled","org.allow_third_party_access_requests_from_outside_collaborators_enabled","org.runner_group_created","org.runner_group_removed","org.runner_group_updated","org.set_actions_fork_pr_approvals_policy","org.set_actions_retention_limit","org.update_member_repository_creation_permission","org.update_member_repository_invitation_permission","org.update_new_repository_default_branch_setting","org.update_terms_of_service"),org)
EVAL-dest_type = case(vendor_action IN ("repository_vulnerability_alert.create","repository_vulnerability_alert.reopen"),"Repository")
EVAL-type = case(vendor_action IN ("repository_vulnerability_alert.create","repository_vulnerability_alert.reopen"),"event")
EVAL-id = case(vendor_action IN ("repository_vulnerability_alert.create","repository_vulnerability_alert.reopen"),document_id)
EVAL-object_path = case(vendor_action IN ("team.add_member","team.remove_member","team.create","team.destroy","team.change_privacy","team.change_parent_team","team.demote_maintainer","team.promote_maintainer","team.add_repository","team.change_parent_team","team.remove_repository","team.rename","team.update_repository_permission"),team,vendor_action IN ("repository_secret_scanning_push_protection.disable","repository_dependency_graph.enable","repository_secret_scanning.enable","repo.actions_enabled","repo.create","repo.change_merge_setting","repository_vulnerability_alerts.enable","repo.advanced_security_enabled","repo.add_member","repo.remove_member","repo.update_member","repo.code_scanning_analysis_deleted","repo.code_scanning_configuration_for_branch_deleted","repo.register_self_hosted_runner","repo.remove_self_hosted_runner","repo.self_hosted_runner_offline","repo.self_hosted_runner_online","repo.transfer_outgoing","repo.access","repo.advanced_security_disabled","repo.archived","repo.change_merge_setting","repo.config.disable_collaborators_only","repo.config.disable_contributors_only","repo.config.disable_sockpuppet_disallowed","repo.config.enable_collaborators_only","repo.config.enable_contributors_only","repo.config.enable_sockpuppet_disallowed","repo.create_actions_secret","repo.create_integration_secret","repo.destroy","repo.remove_actions_secret","repo.remove_integration_secret","repo.rename","repo.transfer","repo.unarchived","repo.update_actions_secret","repo.update_actions_settings","repo.update_default_branch","repo.update_integration_secret","repo.add_topic","repo.codeql_enabled","repo.pages_cname","repo.pages_create","repo.pages_destroy","repo.pages_https_redirect_disabled","repo.pages_https_redirect_enabled","repo.pages_private","repo.pages_public","repo.pages_source","repo.remove_topic","repo.set_actions_fork_pr_approvals_policy","repo.set_actions_retention_limit"),repo,vendor_action IN ("pull_request.create","pull_request.close","pull_request.reopen","pull_request.merge","pull_request.ready_for_review","pull_request.create_review_request"),pr_object_path,vendor_action IN ("git.fetch","git.push","git.clone"),repository,vendor_action IN ("org.add_member","org.block_user","org.integration_manager_added","org.integration_manager_removed","org.invite_member","org.remove_member","org.remove_outside_collaborator","org.restore_member","org.unblock_user","org.update_member","org.accept_business_invitation","org.cancel_business_invitation","org.cancel_invitation","org.config.disable_collaborators_only","org.config.disable_contributors_only","org.config.disable_sockpuppet_disallowed","org.config.enable_collaborators_only","org.config.enable_contributors_only","org.config.enable_sockpuppet_disallowed","org.confirm_business_invitation","org.disable_reader_discussion_creation_permission","org.display_commenter_full_name_disabled","org.display_commenter_full_name_enabled","org.enable_reader_discussion_creation_permission","org.secret_scanning_custom_pattern_push_protection_disabled","org.secret_scanning_custom_pattern_push_protection_enabled","org.secret_scanning_push_protection_custom_message_disabled","org.secret_scanning_push_protection_custom_message_enabled","org.secret_scanning_push_protection_disable","org.secret_scanning_push_protection_enable","org.secret_scanning_push_protection_new_repos_enable","org.set_default_workflow_permissions","org.set_workflow_permission_can_approve_pr","org.advanced_security_policy_selected_member_enabled","org.create","org.create_actions_secret","org.create_integration_secret","org.disable_member_team_creation_permission","org.disable_oauth_app_restrictions","org.disable_two_factor_requirement","org.enable_member_team_creation_permission","org.enable_oauth_app_restrictions","org.enable_two_factor_requirement","org.oauth_app_access_approved","org.remove_actions_secret","org.remove_integration_secret","org.rename","org.update_actions_secret","org.update_actions_settings","org.update_default_repository_permission","org.update_integration_secret","org.advanced_security_disabled_for_new_repos","org.advanced_security_disabled_on_all_repos","org.advanced_security_enabled_for_new_repos","org.advanced_security_enabled_on_all_repos","org.allow_third_party_access_requests_from_outside_collaborators_disabled","org.allow_third_party_access_requests_from_outside_collaborators_enabled","org.runner_group_created","org.runner_group_removed","org.runner_group_updated","org.set_actions_fork_pr_approvals_policy","org.set_actions_retention_limit","org.update_member_repository_creation_permission","org.update_member_repository_invitation_permission","org.update_new_repository_default_branch_setting","org.update_terms_of_service","org.advanced_security_policy_selected_member_disabled","org.oauth_app_access_denied"),org,vendor_action == "workflows.prepared_workflow_job",job_workflow_ref)

LOOKUP-github_cloud_action_lookup = github_cloud_action_lookup vendor_action OUTPUT event_group, action, change_type, object_category

[github:cloud:user]
SHOULD_LINEMERGE = false
EVENT_BREAKER_ENABLE = false
KV_MODE = JSON

FIELDALIAS-status = state AS status

EVAL-serial = coalesce('user.node_id',node_id)
EVAL-user = coalesce('user.login',login)
EVAL-user_id = coalesce('user.id',id)
EVAL-vendor_product = "GitHub Cloud"
EVAL-enabled = "true"
EVAL-family = "User"

[github:cloud:code:scanning:alerts]
TIME_PREFIX = "updated_at":
SHOULD_LINEMERGE = false
EVENT_BREAKER_ENABLE = false
KV_MODE = JSON

FIELDALIAS-description = rule.description as description
FIELDALIAS-dest = repository.full_name as dest
FIELDALIAS-id = rule.id as id
FIELDALIAS-severity = rule.security_severity_level as severity
FIELDALIAS-signature = rule.description as signature
FIELDALIAS-signature_id = rule.id as signature_id
FIELDALIAS-user = repository.owner.login as user

EVAL-app = "Github Code Scanning"
EVAL-type = "alert"
EVAL-dest_type = "Repository"

[github:cloud:dependabot:scanning:alerts]
TIME_PREFIX = "updated_at":
SHOULD_LINEMERGE = false
EVENT_BREAKER_ENABLE = false
KV_MODE = JSON

FIELDALIAS-description = security_advisory.description as description
FIELDALIAS-dest = repository.full_name as dest
FIELDALIAS-id = security_advisory.cve_id as id
FIELDALIAS-severity = security_advisory.severity as severity
FIELDALIAS-signature = security_advisory.summary as signature
FIELDALIAS-signature_id = security_advisory.cve_id as signature_id
FIELDALIAS-user = repository.owner.login as user

EVAL-app = "Github Dependabot Scanning"
EVAL-type = "alert"
EVAL-dest_type = "Repository"

[github:cloud:secret:scanning:alerts]
TIME_PREFIX = "updated_at":
SHOULD_LINEMERGE = false
EVENT_BREAKER_ENABLE = false
KV_MODE = JSON

FIELDALIAS-description = repository.description as description
FIELDALIAS-dest = repository.full_name as dest
FIELDALIAS-user = repository.owner.login as user

EVAL-app = "Github Secret Scanning"
EVAL-type = "alert"
EVAL-dest_type = "Repository"
