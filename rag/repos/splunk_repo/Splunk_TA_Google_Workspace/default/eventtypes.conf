##
## SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>
## SPDX-License-Identifier: LicenseRef-Splunk-8-2021
##
##

[gws_reports_login_auth]
search = sourcetype="gws:reports:login" AND "event.name" IN("login_success", "login_failure")

[gws_reports_login_change]
search = sourcetype="gws:reports:login" AND "event.name" IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming")

[gws_reports_login_alerts]
search = sourcetype="gws:reports:login" AND "event.name" IN("account_disabled_password_leak", "suspicious_login", "suspicious_login_less_secure_app", "suspicious_programmatic_login", "account_disabled_hijacked", "gov_attack_warning")

[gws_reports_oauthtoken_auth]
search = sourcetype="gws:reports:token" AND "event.name"="authorize"

[gws_reports_oauthtoken_change]
search = sourcetype="gws:reports:token" AND "event.name"="revoke"

[gws_reports_admin]
search = sourcetype="gws:reports:admin" AND "event.name" IN("CHANGE_MOBILE_SETTING", "ADD_TO_TRUSTED_OAUTH2_APPS", "CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING", "ADD_TO_TRUSTED_OAUTH2_APPS", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE", "CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE")

[gws_reports_admin_data_access]
search = sourcetype="gws:reports:admin" AND "event.name" IN("EMAIL_UNDELETE")

[gws_reports_admin_account_management]
search = sourcetype="gws:reports:admin" AND "event.name" IN("UNSUSPEND_USER", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "AUTHORIZE_API_CLIENT_ACCESS", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "ASSIGN_ROLE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT")

[gws_reports_admin_email_filtering]
search = sourcetype="gws:reports:admin" AND "event.name" IN("DROP_FROM_QUARANTINE", "REJECT_FROM_QUARANTINE", "RELEASE_FROM_QUARANTINE")

[gws_reports_calendar_change]
search = sourcetype="gws:reports:calendar" AND "event.name" IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event")

[gws_reports_context_aware_access_data_access]
search = sourcetype="gws:reports:context_aware_access" AND "event.name" IN("ACCESS_DENY_EVENT")

[gws_reports_saml]
search = sourcetype="gws:reports:saml"

[gws_reports_drive_change]
search = sourcetype="gws:reports:drive" AND "event.name" IN("change_acl_editors", "transfer_document_ownership", "drive_data_restore", "change_docs_setting", "move_shared_drive_to_org_unit")

[gws_reports_drive_account_management]
search = sourcetype="gws:reports:drive" AND "event.name"="change_user_access"

[gws_reports_drive_data_access]
search = sourcetype="gws:reports:drive" AND "event.name" IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled")

[gws_reports_groups_enterprise_change]
search = sourcetype="gws:reports:groups_enterprise" AND "event.name" IN("add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group")

[gws_reports_groups_enterprise_change_account_management]
search = sourcetype="gws:reports:groups_enterprise" AND "event.name" IN("add_member_role", "add_service_account_permission", "join", "unban_member", "invite_member")

[gws_reports_gcp_change_account_management]
search = sourcetype="gws:reports:gcp" AND "event.name" IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY")

[gws_gmail_email_filter]
search = sourcetype="gws:gmail" AND "message_info.action_type" IN("3", "10", "19", "69", "70")

[gws_users_identity]
search = sourcetype="gws:users:identity"

[gws_alerts]
search = sourcetype="gws:alerts" AND "event_type" IN("Customer takeout initiated", "Malware reclassification", "Misconfigured whitelist", "Phishing reclassification", "Suspicious message reported", "User reported phishing", "User reported spam spike", "Leaked password", "Suspicious login", "Suspicious login (less secure app)", "Suspicious programmatic login", "User suspended", "User suspended (spam)", "User suspended (spam through relay)", "User suspended (suspicious activity)", "Google Operations", "Government attack warning", "Activity Rule", "Data Loss Prevention", "Primary admin changed", "SSO profile added", "SSO profile updated", "SSO profile deleted", "Super admin password reset")

[gws_reports_mobile_services]
search = sourcetype="gws:reports:mobile" AND "event.name" IN ("DEVICE_COMPLIANCE_CHANGED_EVENT", "RISK_SIGNAL_UPDATED_EVENT", "APPLICATION_EVENT")

[gws_reports_mobile_updates]
search = sourcetype="gws:reports:mobile" AND "event.name" IN ("OS_UPDATED_EVENT")

[gws_reports_mobile_change]
search = sourcetype="gws:reports:mobile" AND "event.name" IN ("DEVICE_ACTION_EVENT", "DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT", "APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT")

[gws_reports_chrome_change_account_management]
search = sourcetype="gws:reports:chrome" AND "event.name" IN ("PASSWORD_CHANGED", "CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT")

[gws_reports_chat_data_access]
search = sourcetype="gws:reports:chat"

[gws_reports_data_studio_data_access]
search = sourcetype="gws:reports:data_studio" AND "event.name" IN ("CREATE", "TRASH", "RESTORE", "CREATE_DISTRIBUTION_CONTENT", "DELETE_DISTRIBUTION_CONTENT", "DOWNLOAD_REPORT", "EDIT_DISTRIBUTION_CONTENT", "CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "CHANGE_ASSET_LINK_SHARING_VISIBILITY") OR "events{}.name" IN("DATA_EXPORT", "EDIT")

[gws_reports_data_studio_change]
search = sourcetype="gws:reports:data_studio" AND "event.name" IN ("CHANGE_USER_ACCESS")

[gws_reports_mobile_authentication]
search = sourcetype="gws:reports:mobile" AND "event.name" IN ("FAILED_PASSWORD_ATTEMPTS_EVENT")

[gws_reports_chrome_authentication]
search = sourcetype="gws:reports:chrome" AND "event.name" IN ("CHROME_OS_LOGIN_FAILURE_EVENT", "CHROME_OS_LOGIN_EVENT", "LOGIN_EVENT")

[gws_reports_chrome_data_access]
search = sourcetype="gws:reports:chrome" AND "event.name" IN ("CONTENT_TRANSFER")

[gws_reports_chrome_alerts]
search = sourcetype="gws:reports:chrome" AND "event.name" IN ("CHROME_OS_REPORTING_DATA_LOST", "PASSWORD_REUSE", "DLP_EVENT", "CONTENT_UNSCANNED", "MALWARE_TRANSFER", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT")

[gws_reports_chrome_change]
search = sourcetype="gws:reports:chrome" AND "event.name" IN ("DEVICE_BOOT_STATE_CHANGE")

[gws_reports_mobile_alerts]
search = sourcetype="gws:reports:mobile" AND "event.name" IN ("APPLICATION_REPORT_EVENT", "DEVICE_COMPROMISED_EVENT")
