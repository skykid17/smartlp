##
## SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>
## SPDX-License-Identifier: LicenseRef-Splunk-8-2021
##
##

[gws:reports:token]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N

EXTRACT-app = name\":\s\"authorize.*(?:[^,\[\:\{\n]*)app_name(?:[\",\s]+)value(?:[\":\s]+)(?P<app>.*?)\"
EXTRACT-app_name = app_name", "value": "(?P<app_name>.+?)"
EXTRACT-client_id = client_id", "value": "(?P<client_id>.+?)"
EXTRACT-dest_quoted = (?:[^,\n]*)scope(?:[\",\s]+)multiValue(?:[\":\s\[]+)(?P<dest_quoted>\".*?)\]
EXTRACT-user_type = name\":\s\"authorize.*(?:[^,\n]*)client_type(?:[\",\s]+)value(?:[\":\s]+)(?P<user_type>.*?)\"
EXTRACT-object_attrs = name\":\s\"revoke.*(?:[^,\n]*)client_type(?:[\",\s]+)value(?:[\":\s]+)(?P<object_attrs>.*?)\"

EVAL-action = case('event.name'="authorize", "success", 'event.name'="revoke", "modified")
EVAL-app = case('event.name'="authorize", app, 'event.name'="revoke", app_name)
EVAL-authentication_method = case('event.name'="authorize", "token")
EVAL-authentication_service = case('event.name'="authorize", "Google Workspace")
EVAL-change_type = case('event.name'="revoke", "AAA")
EVAL-command = case('event.name'="revoke", 'event.name')
EVAL-dest = replace(dest_quoted, "\"", "")
EVAL-dest_url = replace(dest_quoted, "\"", "")
EVAL-dvc = case('event.name'="revoke", "Google Workspace")
EVAL-object = case('event.name'="revoke", client_id)
EVAL-object_category = case('event.name'="revoke", "user")
EVAL-object_id = case('event.name'="revoke", client_id)
EVAL-result = case('event.name'="revoke", "revoke")
EVAL-result_id = case('event.name'="revoke", "revoke")
EVAL-signature = case('event.name'="authorize", 'event.name')
EVAL-src = case('event.name'="authorize", 'ipAddress')
EVAL-src_ip = case('event.name'="authorize", 'ipAddress')
EVAL-src_user = case('event.name'="revoke", 'actor.email')
EVAL-src_user_id = case('event.name'="revoke", 'actor.profileId')
EVAL-status = case('event.name'="revoke", "success")
EVAL-user = case('event.name'="authorize", 'actor.email', 'event.name'="revoke", client_id)
EVAL-user_id = case('event.name'="authorize", 'actor.profileId', 'event.name'="revoke", client_id)
EVAL-user_name = case('event.name'="revoke", client_id)
EVAL-vendor_account = case('event.name' IN ("authorize", "revoke"), 'id.customerId')
EVAL-vendor_product = case('event.name'="revoke", "Google Workspace")

[gws:reports:admin]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N

EXTRACT-api_client_name = API_CLIENT_NAME", "value": "(?P<api_client_name>.+?)"
EXTRACT-allowed_2_step_ver_meth = ALLOWED_TWO_STEP_VERIFICATION_METHOD", "value": "(?P<allowed_2_step_ver_meth>.+?)"
EXTRACT-application_name = APPLICATION_NAME", "value": "(?P<application_name>.+?)"
EXTRACT-api_scope = API_SCOPES", "value": "(?P<api_scope>.+?)"
EXTRACT-email_log_search_msg_id = EMAIL_LOG_SEARCH_MSG_ID", "value": "(?P<email_log_search_msg_id>.+?)"
EXTRACT-end_date = END_DATE", "value": "(?P<end_date>.+?)"
EXTRACT-field_name = FIELD_NAME", "value": "(?P<field_name>.+?)"
EXTRACT-org_unit_name = ORG_UNIT_NAME", "value": "(?P<org_unit_name>.+?)"
EXTRACT-oauth2_app_name = OAUTH2_APP_NAME", "value": "(?P<oauth2_app_name>.+?)"
EXTRACT-oauth2_app_type = OAUTH2_APP_TYPE", "value": "(?P<oauth2_app_type>.+?)"
EXTRACT-oauth2_app_id = OAUTH2_APP_ID", "value": "(?P<oauth2_app_id>.+?)"
EXTRACT-oauth2_service_name = OAUTH2_SERVICE_NAME", "value": "(?P<oauth2_service_name>.+?)"
EXTRACT-privilege_name = PRIVILEGE_NAME", "value": "(?P<privilege_name>.+?)"
EXTRACT-reauth_application = REAUTH_APPLICATION", "value": "(?P<reauth_application>.+?)"
EXTRACT-reauth_setting_new = REAUTH_SETTING_NEW", "value": "(?P<reauth_setting_new>.+?)"
EXTRACT-role_id = ROLE_ID", "value": "(?P<role_id>.+?)"
EXTRACT-role_name = ROLE_NAME", "value": "(?P<role_name>.+?)"
EXTRACT-setting_name = SETTING_NAME", "value": "(?P<setting_name>.+?)"
EXTRACT-setting_description = SETTING_DESCRIPTION", "value": "(?P<setting_description>.+?)"
EXTRACT-start_date = START_DATE", "value": "(?P<start_date>.+?)"
EXTRACT-product_name = PRODUCT_NAME", "value": "(?P<product_name>.+?)"
EXTRACT-new_value = NEW_VALUE", "value": "(?P<new_value>.+?)"
EXTRACT-user_defined_setting_name = USER_DEFINED_SETTING_NAME", "value": "(?P<user_defined_setting_name>.+?)"
EXTRACT-user_email_extracted = USER_EMAIL", "value": "(?P<user_email_extracted>.+?)"
EXTRACT-quarantine_name = QUARANTINE_NAME", "value": "(?P<quarantine_name>.+?)"

EXTRACT-update_calendar_resource_identifier = \"RESOURCE_IDENTIFIER\", \"value\": \"\(id:\s+(?P<ucr_identifier_id>.*?),\s+name:\s+(?P<ucr_identifier_name>.*?)\)\"

REPORT-user_email = user_email

EVAL-app = case('event.name' IN("EMAIL_UNDELETE"), "Gmail")
EVAL-change_type = case('event.name' IN ("CHANGE_MOBILE_SETTING", "ADD_TO_TRUSTED_OAUTH2_APPS", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "AUTHORIZE_API_CLIENT_ACCESS", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "ADD_TO_TRUSTED_OAUTH2_APPS", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), "AAA", 'event.name' IN("CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING", "DELETE_GMAIL_SETTING"), "email", 'event.name' IN("CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE"), "collaboration")
EVAL-command = case('event.name' IN ("CHANGE_MOBILE_SETTING", "ADD_TO_TRUSTED_OAUTH2_APPS", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "AUTHORIZE_API_CLIENT_ACCESS", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "ADD_TO_TRUSTED_OAUTH2_APPS", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE", "CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), 'event.name')
EVAL-dest = case('event.name' IN ("SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE"), "Google Workspace", \
    'event.name' IN ("ADD_TO_TRUSTED_OAUTH2_APPS", "CHANGE_MOBILE_SETTING", "CHANGE_EMAIL_SETTING", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), org_unit_name,\
    'event.name' IN ("AUTHORIZE_API_CLIENT_ACCESS"), api_scope,\
    'event.name' IN ("EMAIL_UNDELETE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE"), 'id.customerId',\
    'event.name' IN ("CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING"), "Gmail")
EVAL-dest_url = case('event.name' IN("AUTHORIZE_API_CLIENT_ACCESS"), api_scope)
EVAL-dest_name = case('event.name' IN ("SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "AUTHORIZE_API_CLIENT_ACCESS", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER"), "Google Workspace", 'event.name' IN("CHANGE_MOBILE_SETTING"), org_unit_name, 'event.name' IN("EMAIL_UNDELETE"), 'id.customerId')
EVAL-dvc = case('event.name' IN ("CHANGE_MOBILE_SETTING", "ADD_TO_TRUSTED_OAUTH2_APPS", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "AUTHORIZE_API_CLIENT_ACCESS", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "ADD_TO_TRUSTED_OAUTH2_APPS", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), "Google Workspace", 'event.name' IN("CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING", "EMAIL_UNDELETE", "DELETE_GMAIL_SETTING"), "Gmail", 'event.name' IN("CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE"), "google calendar")
EVAL-email = case('event.name' IN("EMAIL_UNDELETE"), user_email_extracted)
EVAL-internal_message_id = case('event.name' IN("DROP_FROM_QUARANTINE", "REJECT_FROM_QUARANTINE", "RELEASE_FROM_QUARANTINE"), replace(replace(email_log_search_msg_id, "<", ""), ">", ""))
EVAL-filter_action = case('event.name' IN("DROP_FROM_QUARANTINE", "REJECT_FROM_QUARANTINE", "RELEASE_FROM_QUARANTINE"), 'event.name')
EVAL-message_id = case('event.name' IN("DROP_FROM_QUARANTINE", "REJECT_FROM_QUARANTINE", "RELEASE_FROM_QUARANTINE"), replace(replace(email_log_search_msg_id, "<", ""), ">", ""))
EVAL-object = case('event.name' IN ("SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER"), user_email, \
    'event.name' IN ("CHANGE_MOBILE_SETTING", "CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING"), setting_name, \
    'event.name' IN ("ADD_TO_TRUSTED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS"), "Trusted whitelist",\
    'event.name' IN ("AUTHORIZE_API_CLIENT_ACCESS"), api_client_name,\
    'event.name' IN("ASSIGN_ROLE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT"), user_email_extracted,\
    'event.name' IN("BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS"), "THIRD_PARTY_API_ACCESS",\
    'event.name' IN("ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS"), "SERVICE_FOR_OAUTH2_ACCESS",\
    'event.name' IN("CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID"), "APP_ACCESS_SETTINGS_COLLECTION_ID",\
    'event.name' IN("ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS"), "Blocked list",\
    'event.name' IN("BLOCK_ON_DEVICE_ACCESS", "UNBLOCK_ON_DEVICE_ACCESS"), oauth2_service_name,\
    'event.name' IN("CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION"), "TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION",\
    'event.name' IN("CHANGE_TWO_STEP_VERIFICATION_FREQUENCY"), "TWO_STEP_VERIFICATION_FREQUENCY",\
    'event.name' IN("CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION"), "TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION",\
    'event.name' IN("CHANGE_TWO_STEP_VERIFICATION_START_DATE"), "TWO_STEP_VERIFICATION_START_DATE",\
    'event.name' IN("CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS"), "ALLOWED_TWO_STEP_VERIFICATION_METHODS",\
    'event.name' IN("CHANGE_CAA_APP_ASSIGNMENTS"), "CAA_APP_ASSIGNMENTS",\
    'event.name' IN("UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS"), "trusted list",\
    'event.name' IN("ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY"), "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY",\
    'event.name' IN("ENFORCE_STRONG_AUTHENTICATION"), "ENFORCE_STRONG_AUTHENTICATION",\
    'event.name' IN("WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED"), "WEAK_PROGRAMMATIC_LOGIN",\
    'event.name' IN("SESSION_CONTROL_SETTINGS_CHANGE"), "SESSION_CONTROL_SETTINGS",\
    'event.name' IN("CREATE_ROLE", "UPDATE_ROLE", "DELETE_ROLE", "REMOVE_PRIVILEGE"), role_name,\
    'event.name' IN("ADD_PRIVILEGE"), privilege_name,\
    'event.name' IN("EMAIL_UNDELETE"), "email",\
    'event.name' IN("CREATE_CALENDAR_RESOURCE", "RENAME_ROLE"), new_value,\
    'event.name' IN("UPDATE_CALENDAR_RESOURCE"), ucr_identifier_name,\
    'event.name' IN("DELETE_GMAIL_SETTING"), user_defined_setting_name,\
    'event.name' IN("ORG_LICENSE_REVOKE"), "ORG_LICENSE")
EVAL-object_attrs = case('event.name' IN("ASSIGN_ROLE", "ADD_PRIVILEGE", "UNASSIGN_ROLE"), role_name,\
    'event.name' IN("CHANGE_EMAIL_SETTING"), new_value,\
    'event.name' IN("CREATE_GMAIL_SETTING"), setting_description,\
    'event.name' IN("CHANGE_GMAIL_SETTING"), user_defined_setting_name,\
    'event.name' IN("ADD_TO_TRUSTED_OAUTH2_APPS", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS"), oauth2_app_name + ", " + oauth2_app_type,\
    'event.name' IN("ALLOW_SERVICE_FOR_OAUTH2_ACCESS"), oauth2_service_name,\
    'event.name' IN("CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED"), new_value,\
    'event.name' IN("CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS"), allowed_2_step_ver_meth,\
    'event.name' IN("SESSION_CONTROL_SETTINGS_CHANGE"), reauth_application + ", " + reauth_setting_new,\
    'event.name' IN("CHANGE_CAA_APP_ASSIGNMENTS"), application_name,\
    'event.name' IN("EMAIL_UNDELETE"), "START_DATE=" + start_date + ", END_DATE=" + end_date,\
    'event.name' IN("USER_LICENSE_ASSIGNMENT"), product_name,\
    'event.name' IN("UPDATE_CALENDAR_RESOURCE"), field_name,\
    'event.name' IN("DELETE_GMAIL_SETTING"), setting_name,\
    'event.name' IN("REMOVE_PRIVILEGE"), "PRIVILEGE_NAME="+privilege_name,\
    'event.name' IN("ORG_LICENSE_REVOKE"), org_unit_name,\
    'event.name' IN("DISALLOW_SERVICE_FOR_OAUTH2_ACCESS"), mvappend(oauth2_service_name, org_unit_name))
EVAL-object_path = case('event.name' IN("CHANGE_GMAIL_SETTING"), setting_name)
EVAL-object_category = case('event.name' IN ("SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "AUTHORIZE_API_CLIENT_ACCESS", "ASSIGN_ROLE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT"), "user", \
    'event.name' IN ("CHANGE_MOBILE_SETTING"), "MOBILE_SETTINGS",\
    'event.name' IN("CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING"), "EMAIL_SETTINGS",\
    'event.name' IN("ADD_TO_TRUSTED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS"), "whitelist",\
    'event.name' IN("BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS"), "SECURITY_SETTINGS",\
    'event.name' IN("CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID"), "APP_ACCESS_SETTINGS",\
    'event.name' IN("ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS"), "Blocked list",\
    'event.name' IN("BLOCK_ON_DEVICE_ACCESS", "UNBLOCK_ON_DEVICE_ACCESS"), "OAUTH2_SERVICE_NAME",\
    'event.name' IN("UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS"), "trusted list",\
    'event.name' IN("CREATE_ROLE", "UPDATE_ROLE", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE"), "role",\
    'event.name' IN("ADD_PRIVILEGE"), "privilege",\
    'event.name' IN("EMAIL_UNDELETE"), "email",\
    'event.name' IN("CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE"), "calendar resource",\
    'event.name' IN("DELETE_GMAIL_SETTING"), "email setting",\
    'event.name' IN("ORG_LICENSE_REVOKE"), "LICENSES_SETTINGS")
EVAL-object_id = case('event.name' IN ("SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER"), user_email, \
    'event.name' IN ("CHANGE_MOBILE_SETTING", "CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING"), setting_name, \
    'event.name' IN ("AUTHORIZE_API_CLIENT_ACCESS"), api_client_name,\
    'event.name' IN("ASSIGN_ROLE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT"), user_email_extracted,\
    'event.name' IN("ADD_TO_TRUSTED_OAUTH2_APPS", "ADD_TO_TRUSTED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS"), "Trusted whitelist",\
    'event.name' IN("BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS"), "THIRD_PARTY_API_ACCESS",\
    'event.name' IN("ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS"), "SERVICE_FOR_OAUTH2_ACCESS",\
    'event.name' IN("CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID"), "APP_ACCESS_SETTINGS_COLLECTION_ID",\
    'event.name' IN("ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS"), "Blocked list",\
    'event.name' IN("BLOCK_ON_DEVICE_ACCESS", "UNBLOCK_ON_DEVICE_ACCESS"), oauth2_service_name,\
    'event.name' IN("CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION"), "TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION",\
    'event.name' IN("CHANGE_TWO_STEP_VERIFICATION_FREQUENCY"), "TWO_STEP_VERIFICATION_FREQUENCY",\
    'event.name' IN("CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION"), "TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION",\
    'event.name' IN("CHANGE_TWO_STEP_VERIFICATION_START_DATE"), "TWO_STEP_VERIFICATION_START_DATE",\
    'event.name' IN("CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS"), "ALLOWED_TWO_STEP_VERIFICATION_METHODS",\
    'event.name' IN("CHANGE_CAA_APP_ASSIGNMENTS"), "CAA_APP_ASSIGNMENTS",\
    'event.name' IN("UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS"), "trusted list",\
    'event.name' IN("ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY"), "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY",\
    'event.name' IN("ENFORCE_STRONG_AUTHENTICATION"), "ENFORCE_STRONG_AUTHENTICATION",\
    'event.name' IN("WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED"), "WEAK_PROGRAMMATIC_LOGIN",\
    'event.name' IN("SESSION_CONTROL_SETTINGS_CHANGE"), "SESSION_CONTROL_SETTINGS",\
    'event.name' IN("CREATE_ROLE", "UPDATE_ROLE"), role_name,\
    'event.name' IN("ADD_PRIVILEGE"), privilege_name,\
    'event.name' IN("EMAIL_UNDELETE"), "email",\
    'event.name' IN("CREATE_CALENDAR_RESOURCE", "RENAME_ROLE"), new_value,\
    'event.name' IN("UPDATE_CALENDAR_RESOURCE"), ucr_identifier_id,\
    'event.name' IN("DELETE_GMAIL_SETTING"), user_defined_setting_name,\
    'event.name' IN("DELETE_ROLE", "REMOVE_PRIVILEGE"), role_id,\
    'event.name' IN("ORG_LICENSE_REVOKE"), "ORG_LICENSE")
EVAL-owner = case('event.name' IN("EMAIL_UNDELETE"), user_email_extracted)
EVAL-owner_email = case('event.name' IN("EMAIL_UNDELETE"), user_email_extracted)
EVAL-protocol = case('event.name' IN("DROP_FROM_QUARANTINE", "REJECT_FROM_QUARANTINE", "RELEASE_FROM_QUARANTINE"), "smtp")
EVAL-result = case('event.name' IN ("CHANGE_MOBILE_SETTING", "ADD_TO_TRUSTED_OAUTH2_APPS", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "AUTHORIZE_API_CLIENT_ACCESS", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "ADD_TO_TRUSTED_OAUTH2_APPS", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE", "CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING", "EMAIL_UNDELETE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), 'event.name')
EVAL-result_id = case('event.name' IN ("CHANGE_MOBILE_SETTING", "ADD_TO_TRUSTED_OAUTH2_APPS", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "AUTHORIZE_API_CLIENT_ACCESS", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "ADD_TO_TRUSTED_OAUTH2_APPS", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE", "CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING", "EMAIL_UNDELETE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), 'event.name')
EVAL-signature_extra = case('event.name' IN("DROP_FROM_QUARANTINE", "REJECT_FROM_QUARANTINE", "RELEASE_FROM_QUARANTINE"), quarantine_name)
EVAL-src = case('event.name' IN ("CHANGE_MOBILE_SETTING", "ADD_TO_TRUSTED_OAUTH2_APPS", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "AUTHORIZE_API_CLIENT_ACCESS", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "ADD_TO_TRUSTED_OAUTH2_APPS", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE", "CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING", "EMAIL_UNDELETE", "RELEASE_FROM_QUARANTINE", "REJECT_FROM_QUARANTINE", "DROP_FROM_QUARANTINE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), 'ipAddress')
EVAL-src_user = case('event.name' IN ("CHANGE_MOBILE_SETTING", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "AUTHORIZE_API_CLIENT_ACCESS", "ASSIGN_ROLE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), coalesce('actor.email', 'actor.key'))
EVAL-src_user_id = case('event.name' IN ("CHANGE_MOBILE_SETTING", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "AUTHORIZE_API_CLIENT_ACCESS"), 'actor.profileId')
EVAL-src_user_name = case('event.name' IN ("CHANGE_MOBILE_SETTING", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), coalesce('actor.email', 'actor.key'))
EVAL-src_user_type = case('event.name' IN ("CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), 'actor.callerType')
EVAL-status = case('event.name' IN ("CHANGE_MOBILE_SETTING", "ADD_TO_TRUSTED_OAUTH2_APPS", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "AUTHORIZE_API_CLIENT_ACCESS", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "ADD_TO_TRUSTED_OAUTH2_APPS", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE", "CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING", "EMAIL_UNDELETE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), "success")
EVAL-tenant_id = case('event.name' IN("EMAIL_UNDELETE"), 'id.customerId')
EVAL-user = case('event.name' IN ("SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT"), user_email, \
    'event.name' IN ("AUTHORIZE_API_CLIENT_ACCESS"), api_client_name, \
    'event.name' IN ("ADD_TO_TRUSTED_OAUTH2_APPS", "CHANGE_MOBILE_SETTING", "CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE", "EMAIL_UNDELETE", "DROP_FROM_QUARANTINE", "REJECT_FROM_QUARANTINE", "RELEASE_FROM_QUARANTINE", "UPDATE_CALENDAR_RESOURCE", "CREATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS"), 'actor.email',\
    'event.name' IN ("ORG_LICENSE_REVOKE"), coalesce('actor.email', 'actor.key'))
EVAL-user_id = case('event.name' IN("EMAIL_UNDELETE"), 'actor.profileId')
EVAL-user_name = case('event.name' IN ("SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT"), user_email, \
    'event.name' IN ("AUTHORIZE_API_CLIENT_ACCESS"), api_client_name, \
    'event.name' IN ("ADD_TO_TRUSTED_OAUTH2_APPS", "CHANGE_MOBILE_SETTING", "CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE", "EMAIL_UNDELETE", "UPDATE_CALENDAR_RESOURCE", "CREATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS"), 'actor.email', \
    'event.name' IN ("ORG_LICENSE_REVOKE"), coalesce('actor.email', 'actor.key'))
EVAL-user_type = case('event.name' IN("GRANT_DELEGATED_ADMIN_PRIVILEGES"), new_value, 'event.name' IN("UNASSIGN_ROLE", "ORG_LICENSE_REVOKE", "RENAME_ROLE", "DELETE_GMAIL_SETTING", "REMOVE_PRIVILEGE", "UPDATE_CALENDAR_RESOURCE", "DELETE_ROLE", "CREATE_CALENDAR_RESOURCE"), 'actor.callerType')
EVAL-vendor_account = case('event.name' IN ("CHANGE_MOBILE_SETTING", "ADD_TO_TRUSTED_OAUTH2_APPS", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "AUTHORIZE_API_CLIENT_ACCESS", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "ADD_TO_TRUSTED_OAUTH2_APPS", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE", "CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING", "EMAIL_UNDELETE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE", "DELETE_GMAIL_SETTING", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), 'id.customerId')
EVAL-vendor_product = case('event.name' IN ("CHANGE_MOBILE_SETTING", "ADD_TO_TRUSTED_OAUTH2_APPS", "SUSPEND_USER", "USER_LICENSE_REVOKE", "CREATE_USER", "AUTHORIZE_API_CLIENT_ACCESS", "DELETE_USER", "UNARCHIVE_USER", "UNDELETE_USER", "MOVE_USER_TO_ORG_UNIT", "ADD_RECOVERY_EMAIL", "REMOVE_RECOVERY_EMAIL", "ADD_RECOVERY_PHONE", "REMOVE_RECOVERY_PHONE", "GRANT_ADMIN_PRIVILEGE", "REVOKE_ADMIN_PRIVILEGE", "CHANGE_RECOVERY_EMAIL", "CHANGE_RECOVERY_PHONE", "CHANGE_PASSWORD", "TURN_OFF_2_STEP_VERIFICATION", "ENABLE_USER_IP_WHITELIST", "UNENROLL_USER_FROM_TITANIUM", "GRANT_DELEGATED_ADMIN_PRIVILEGES", "SECURITY_KEY_REGISTERED_FOR_USER", "UNBLOCK_USER_SESSION", "ARCHIVE_USER", "GENERATE_2SV_SCRATCH_CODES", "UNENROLL_USER_FROM_STRONG_AUTH", "CHANGE_PASSWORD_ON_NEXT_LOGIN", "CREATE_EMAIL_MONITOR", "DELETE_EMAIL_MONITOR", "RENAME_USER", "USER_PUT_IN_TWO_STEP_VERIFICATION_GRACE_PERIOD", "GMAIL_RESET_USER", "MAIL_ROUTING_DESTINATION_ADDED", "MAIL_ROUTING_DESTINATION_REMOVED", "UNSUSPEND_USER", "ASSIGN_ROLE", "ADD_TO_TRUSTED_OAUTH2_APPS", "BLOCK_ALL_THIRD_PARTY_API_ACCESS", "UNBLOCK_ALL_THIRD_PARTY_API_ACCESS", "ALLOW_SERVICE_FOR_OAUTH2_ACCESS", "CHANGE_APP_ACCESS_SETTINGS_COLLECTION_ID", "ADD_TO_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_BLOCKED_OAUTH2_APPS", "REMOVE_FROM_TRUSTED_OAUTH2_APPS", "BLOCK_ON_DEVICE_ACCESS", "CHANGE_TWO_STEP_VERIFICATION_ENROLLMENT_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_FREQUENCY", "CHANGE_TWO_STEP_VERIFICATION_GRACE_PERIOD_DURATION", "CHANGE_TWO_STEP_VERIFICATION_START_DATE", "CHANGE_ALLOWED_TWO_STEP_VERIFICATION_METHODS", "CHANGE_CAA_APP_ASSIGNMENTS", "UNTRUST_DOMAIN_OWNED_OAUTH2_APPS", "TRUST_DOMAIN_OWNED_OAUTH2_APPS", "ENABLE_NON_ADMIN_USER_PASSWORD_RECOVERY", "ENFORCE_STRONG_AUTHENTICATION", "WEAK_PROGRAMMATIC_LOGIN_SETTINGS_CHANGED", "SESSION_CONTROL_SETTINGS_CHANGE", "UNBLOCK_ON_DEVICE_ACCESS", "CREATE_ROLE", "ADD_PRIVILEGE", "UPDATE_ROLE", "CHANGE_FIRST_NAME", "CHANGE_LAST_NAME", "CHANGE_USER_LOCATION", "RESET_SIGNIN_COOKIES", "UNASSIGN_ROLE", "USER_LICENSE_ASSIGNMENT", "DELETE_ROLE", "REMOVE_PRIVILEGE", "RENAME_ROLE", "DISALLOW_SERVICE_FOR_OAUTH2_ACCESS", "ORG_LICENSE_REVOKE"), "Google Workspace",\
    'event.name' IN("CHANGE_EMAIL_SETTING", "CHANGE_GMAIL_SETTING", "CREATE_GMAIL_SETTING", "EMAIL_UNDELETE", "DROP_FROM_QUARANTINE", "REJECT_FROM_QUARANTINE", "RELEASE_FROM_QUARANTINE", "DELETE_GMAIL_SETTING"), "Gmail",\
    'event.name' IN("CREATE_CALENDAR_RESOURCE", "UPDATE_CALENDAR_RESOURCE"), "Google Calendar")

LOOKUP-gws_reports_admin = gws_reports_admin_lookup event.name OUTPUTNEW action, object_attrs

[gws:reports:login]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N

EXTRACT-affected_email_address = affected_email_address", "value": "(?P<affected_email_address>.+?)"
EXTRACT-email_forwarding_dest_addr = email_forwarding_destination_address", "value": "(?P<email_forwarding_dest_addr>.+?)"
EXTRACT-login_type = login_type", "value": "(?P<login_type>.+?)"
EXTRACT-login_challenge_method = (?:[^,\n]*)login_challenge_method(?:[\",\s]+)multiValue(?:[\":\s\[]+)(?P<login_challenge_method>\".*?)\]

EVAL-action = case('event.name'="login_success", "success", 'event.name'="login_failure", "failure", 'event.name'="logout", "logoff", 'event.name' IN("2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "email_forwarding_out_of_domain", "titanium_unenroll", "titanium_enroll", "account_disabled_spamming", "account_disabled_spamming_through_relay", "account_disabled_generic"), "modified")
EVAL-app = case('event.name' IN("login_success", "login_failure", "account_disabled_password_leak", "suspicious_login", "suspicious_login_less_secure_app", "suspicious_programmatic_login", "account_disabled_hijacked", "gov_attack_warning"), "Google Workspace")
EVAL-authentication_method = case('event.name' IN("login_success", "login_failure"), if(login_type IN("", "unknown"), replace(login_challenge_method, "\"", ""), login_type))
EVAL-authentication_service = case('event.name' IN("login_success", "login_failure"), "Google Workspace")
EVAL-change_type = case('event.name' IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "email_forwarding_out_of_domain", "titanium_unenroll", "titanium_enroll", "account_disabled_spamming", "account_disabled_spamming_through_relay", "account_disabled_generic"), "AAA")
EVAL-command = case('event.name' IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), 'event.name')
EVAL-description = case('event.name'="account_disabled_password_leak", "Account disabled because Google has become aware that someone else knows its password", 'event.name'="suspicious_login", "Google has detected a suspicious login", 'event.name'="suspicious_login_less_secure_app", "Google has detected a suspicious login from a less secure app", 'event.name'="suspicious_programmatic_login", "Google has detected a suspicious programmatic login", 'event.name'="gov_attack_warning", "Account might have been targeted by government-backed attack", 'event.name'="account_disabled_hijacked", "Account disabled because Google has detected a suspicious activity indicating it might have been compromised")
EVAL-dest = case('event.name' IN("login_success", "login_failure", "logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), "Google Workspace", 'event.name' IN("account_disabled_password_leak", "suspicious_login", "suspicious_login_less_secure_app", "suspicious_programmatic_login", "account_disabled_hijacked"), affected_email_address, 'event.name' IN("gov_attack_warning"), 'actor.email')
EVAL-dest_name = case('event.name' IN("login_success", "login_failure", "logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit"), "Google Workspace")
EVAL-dest_type = case('event.name' IN("account_disabled_password_leak", "suspicious_login", "suspicious_login_less_secure_app", "suspicious_programmatic_login", "account_disabled_hijacked", "gov_attack_warning"), "account")
EVAL-dvc = case('event.name' IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), "Google Workspace")
EVAL-id = case('event.name' IN("account_disabled_hijacked", "gov_attack_warning"), 'id.uniqueQualifier')
EVAL-object = case('event.name' IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), 'actor.email', 'event.name' IN("account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming"), affected_email_address)
EVAL-object_attrs = case('event.name'="logout", "Login Session", 'event.name' IN("2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit"), 'event.name', 'event.name' IN("email_forwarding_out_of_domain"), email_forwarding_dest_addr, 'event.name' IN("titanium_unenroll", "titanium_enroll", "account_disabled_spamming", "account_disabled_spamming_through_relay", "account_disabled_generic"), "user")
EVAL-object_category = case('event.name' IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), "user")
EVAL-object_id = case('event.name' IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "email_forwarding_out_of_domain", "titanium_unenroll", "titanium_enroll"), 'actor.profileId', 'event.name' IN("account_disabled_spamming", "account_disabled_spamming_through_relay", "account_disabled_generic"), affected_email_address)
EVAL-result = case('event.name' IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), 'event.name')
EVAL-result_id = case('event.name' IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), 'event.name')
EVAL-severity = case('event.name' IN("account_disabled_password_leak", "account_disabled_hijacked", "gov_attack_warning"), "high", 'event.name' IN("suspicious_login", "suspicious_login_less_secure_app", "suspicious_programmatic_login"), "medium")
EVAL-signature = case('event.name' IN("login_success", "login_failure"), 'event.name', 'event.name'="account_disabled_password_leak", "Account disabled because Google has become aware that someone else knows its password", 'event.name'="suspicious_login", "Google has detected a suspicious login", 'event.name'="suspicious_login_less_secure_app", "Google has detected a suspicious login from a less secure app", 'event.name'="suspicious_programmatic_login", "Google has detected a suspicious programmatic login", 'event.name'="account_disabled_hijacked", "Account disabled because Google has detected a suspicious activity indicating it might have been compromised", 'event.name'="gov_attack_warning", "Account might have been targeted by government-backed attack")
EVAL-signature_id = case('event.name' IN("account_disabled_password_leak", "suspicious_login", "suspicious_login_less_secure_app", "suspicious_programmatic_login", "gov_attack_warning", "account_disabled_hijacked"), 'event.name')
EVAL-src = case('event.name' IN("login_success", "login_failure", "logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "account_disabled_password_leak", "suspicious_login", "suspicious_login_less_secure_app", "suspicious_programmatic_login", "account_disabled_hijacked", "gov_attack_warning", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), ipAddress)
EVAL-src_ip = case('event.name' IN("login_success", "login_failure", "logout"), ipAddress)
EVAL-src_user = case('event.name' IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), 'actor.email')
EVAL-src_user_id = case('event.name' IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit"), 'actor.profileId')
EVAL-src_user_name = case('event.name' IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), 'actor.email')
EVAL-status = case('event.name' IN("logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "email_forwarding_out_of_domain", "titanium_unenroll", "titanium_enroll", "account_disabled_spamming", "account_disabled_spamming_through_relay", "account_disabled_generic"), "success")
EVAL-type = case('event.name' IN("account_disabled_password_leak", "account_disabled_hijacked", "gov_attack_warning"), "warning", 'event.name' IN("suspicious_login", "suspicious_login_less_secure_app", "suspicious_programmatic_login"), "alert")
EVAL-user = case('event.name' IN("account_disabled_password_leak", "suspicious_login", "suspicious_login_less_secure_app", "suspicious_programmatic_login", "account_disabled_hijacked", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming"), affected_email_address, 'event.name' IN("login_success", "login_failure", "logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "gov_attack_warning", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), 'actor.email')
EVAL-user_id = case('event.name' IN("account_disabled_password_leak", "suspicious_login", "suspicious_login_less_secure_app", "suspicious_programmatic_login", "login_success", "login_failure", "logout"), 'actor.profileId')
EVAL-user_name = case('event.name' IN("account_disabled_password_leak", "suspicious_login", "suspicious_login_less_secure_app", "suspicious_programmatic_login", "account_disabled_hijacked", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming"), affected_email_address, 'event.name' IN("login_success", "login_failure", "logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "gov_attack_warning", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), 'actor.email')
EVAL-vendor_account = case('event.name' IN("account_disabled_password_leak", "suspicious_login", "suspicious_login_less_secure_app", "suspicious_programmatic_login", "login_success", "login_failure", "logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "account_disabled_hijacked", "gov_attack_warning", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), 'id.customerId')
EVAL-vendor_product = case('event.name' IN("login_success", "login_failure", "logout", "2sv_disable", "2sv_enroll", "password_edit", "recovery_email_edit", "recovery_phone_edit", "recovery_secret_qa_edit", "account_disabled_generic", "account_disabled_spamming_through_relay", "account_disabled_spamming", "titanium_enroll", "titanium_unenroll", "email_forwarding_out_of_domain"), "Google Workspace")

[gws:reports:drive]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
TRUNCATE = 1000000

EXTRACT-doc_id = "doc_id", "value": "(?P<doc_id>.+?)"
EXTRACT-doc_title = "doc_title", "value": "(?P<doc_title>.+?)"
EXTRACT-doc_type = "doc_type", "value": "(?P<doc_type>.+?)"
EXTRACT-new_value = "NEW_VALUE", "value": "(?P<new_value>.+?)"
EXTRACT-owner = "owner", "value": "(?P<owner>.+?)"
EXTRACT-org_unit_name = "ORG_UNIT_NAME", "value": "(?P<org_unit_name>.+?)"
EXTRACT-setting_name = "SETTING_NAME", "value": "(?P<setting_name>.+?)"
EXTRACT-shared_drive_id = "SHARED_DRIVE_ID", "value": "(?P<shared_drive_id>.+?)"
EXTRACT-target_user = "target_user", "value": "(?P<target_user>.+?)"
EXTRACT-user_email_extracted = "USER_EMAIL", "value": "(?P<user_email_extracted>.+?)"
EXTRACT-visibility = \"visibility\", \"value\": \"(?P<visibility>.+?)\"

EVAL-app = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled"), "drive")
EVAL-change_type = case('event.name' IN("change_user_access"), "AAA", 'event.name' IN("change_acl_editors", "TRANSFER_DOCUMENT_OWNERSHIP", "DRIVE_DATA_RESTORE", "CHANGE_DOCS_SETTING", "MOVE_SHARED_DRIVE_TO_ORG_UNIT"), "filesystem")
EVAL-command = case('event.name' IN("change_user_access", "change_acl_editors", "TRANSFER_DOCUMENT_OWNERSHIP", "DRIVE_DATA_RESTORE", "CHANGE_DOCS_SETTING", "MOVE_SHARED_DRIVE_TO_ORG_UNIT"), 'event.name')
EVAL-dest = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled"), 'id.customerId', 'event.name' IN("change_user_access", "change_acl_editors"), "drive", 'event.name' IN("TRANSFER_DOCUMENT_OWNERSHIP", "CHANGE_DOCS_SETTING", "MOVE_SHARED_DRIVE_TO_ORG_UNIT"), org_unit_name, 'event.name' IN("DRIVE_DATA_RESTORE"), "Google Drive")
EVAL-dest_name = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled"), 'id.customerId', 'event.name' IN("change_acl_editors", "change_user_access"), "drive")
EVAL-dvc = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled", "change_user_access", "change_acl_editors", "TRANSFER_DOCUMENT_OWNERSHIP", "DRIVE_DATA_RESTORE", "CHANGE_DOCS_SETTING", "MOVE_SHARED_DRIVE_TO_ORG_UNIT"), "Google Drive")
EVAL-email = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled"), 'actor.email')
EVAL-object = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled", "change_acl_editors"), doc_title, 'event.name' IN("change_user_access"), target_user, 'event.name' IN("TRANSFER_DOCUMENT_OWNERSHIP"), "documents", 'event.name' IN("DRIVE_DATA_RESTORE"), "Drive data", 'event.name' IN("CHANGE_DOCS_SETTING"), setting_name, 'event.name' IN("MOVE_SHARED_DRIVE_TO_ORG_UNIT"), shared_drive_id)
EVAL-object_attrs = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled"), doc_type+", "+visibility, 'event.name' IN("change_user_access"), "user_access", 'event.name' IN("change_acl_editors"), "acl_editors", 'event.name' IN("TRANSFER_DOCUMENT_OWNERSHIP"), 'actor.email', 'event.name' IN("DRIVE_DATA_RESTORE"), user_email_extracted, 'event.name' IN("CHANGE_DOCS_SETTING", "MOVE_SHARED_DRIVE_TO_ORG_UNIT"), new_value)
EVAL-object_category = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled", "change_acl_editors"), case(doc_type="folder", "folder", doc_type="unknown", null(), doc_type="shared_drive", "shared_drive", NOT doc_type IN("folder", "unknown", "shared_drive"), "file"), 'event.name' IN("change_user_access"), "user", 'event.name' IN("TRANSFER_DOCUMENT_OWNERSHIP", "DRIVE_DATA_RESTORE", "CHANGE_DOCS_SETTING"), "DOCS_SETTINGS", 'event.name' IN("MOVE_SHARED_DRIVE_TO_ORG_UNIT"), "SHARED_DRIVE")
EVAL-object_id = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled", "change_acl_editors"), doc_id, 'event.name' IN("change_user_access"), target_user, 'event.name' IN("TRANSFER_DOCUMENT_OWNERSHIP"), "documents", 'event.name' IN("DRIVE_DATA_RESTORE"), "Drive data", 'event.name' IN("CHANGE_DOCS_SETTING"), setting_name, 'event.name' IN("MOVE_SHARED_DRIVE_TO_ORG_UNIT"), shared_drive_id)
EVAL-owner = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled"), owner)
EVAL-owner_email = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled"), owner)
EVAL-status = case('event.name' IN("change_acl_editors", "change_user_access", "TRANSFER_DOCUMENT_OWNERSHIP", "DRIVE_DATA_RESTORE", "CHANGE_DOCS_SETTING", "MOVE_SHARED_DRIVE_TO_ORG_UNIT"), "success")
EVAL-src = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled", "change_user_access", "TRANSFER_DOCUMENT_OWNERSHIP", "DRIVE_DATA_RESTORE", "CHANGE_DOCS_SETTING", "MOVE_SHARED_DRIVE_TO_ORG_UNIT"), 'ipAddress')
EVAL-src_user = case('event.name' IN("change_user_access"), 'actor.email')
EVAL-src_user_id = case('event.name' IN("change_user_access"), 'actor.profileId')
EVAL-src_user_name = case('event.name' IN("change_user_access"), 'actor.email')
EVAL-tenant_id = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled"), 'id.customerId')
EVAL-user = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled", "change_user_access", "change_acl_editors", "TRANSFER_DOCUMENT_OWNERSHIP", "DRIVE_DATA_RESTORE", "CHANGE_DOCS_SETTING", "MOVE_SHARED_DRIVE_TO_ORG_UNIT"), coalesce('actor.email', 'actor.key'))
EVAL-user_email = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled", "change_user_access", "change_acl_editors"), coalesce('actor.email', 'actor.key'))
EVAL-user_id = case('event.name' IN("add_to_folder", "change_document_access_scope", "change_document_access_scope_hierarchy_reconciled", "change_document_visibility", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "copy", "create", "delete", "download", "edit", "email_as_attachment", "move", "print", "publish_change", "remove_from_folder", "rename", "shared_drive_membership_change", "sheets_import_range", "trash", "untrash", "upload", "view"), 'actor.profileId')
EVAL-user_name = case('event.name' IN("add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled", "change_user_access", "change_acl_editors", "TRANSFER_DOCUMENT_OWNERSHIP", "DRIVE_DATA_RESTORE", "CHANGE_DOCS_SETTING", "MOVE_SHARED_DRIVE_TO_ORG_UNIT"), coalesce('actor.email', 'actor.key'))
EVAL-result = case('event.name' IN("change_user_access", "change_acl_editors", "TRANSFER_DOCUMENT_OWNERSHIP", "DRIVE_DATA_RESTORE", "CHANGE_DOCS_SETTING", "MOVE_SHARED_DRIVE_TO_ORG_UNIT"), 'event.name')
EVAL-result_id = case('event.name' IN("change_user_access", "change_acl_editors", "TRANSFER_DOCUMENT_OWNERSHIP", "DRIVE_DATA_RESTORE", "CHANGE_DOCS_SETTING", "MOVE_SHARED_DRIVE_TO_ORG_UNIT"), 'event.name')
EVAL-vendor_account = case('event.name' IN("change_user_access", "change_acl_editors", "add_to_folder", "copy", "create", "delete", "download", "edit", "move", "change_document_visibility_hierarchy_reconciled", "change_user_access_hierarchy_reconciled", "rename", "trash", "untrash", "upload", "view", "change_document_access_scope", "change_document_visibility", "print", "shared_drive_membership_change", "remove_from_folder", "sheets_import_range", "email_as_attachment", "publish_change", "change_document_access_scope_hierarchy_reconciled", "TRANSFER_DOCUMENT_OWNERSHIP", "DRIVE_DATA_RESTORE", "CHANGE_DOCS_SETTING", "MOVE_SHARED_DRIVE_TO_ORG_UNIT"), 'id.customerId')
EVAL-vendor_product = "Google Drive"

LOOKUP-gws_drive = gws_drive_lookup event.name OUTPUTNEW action

[gws:reports:chrome]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N

EXTRACT-device_user = "DEVICE_USER", "value": "(?<device_user>.+?)"
EXTRACT-device_name = "DEVICE_NAME", "value": "(?<device_name>.+?)"
EXTRACT-login_failure_reason = "LOGIN_FAILURE_REASON", "value": "(?<login_failure_reason>.+?)"
EXTRACT-event_reason = "EVENT_REASON", "value": "(?<event_reason>.+?)"
EXTRACT-event_result = "EVENT_RESULT", "value": "(?<event_result>.+?)"
EXTRACT-user_agent = "USER_AGENT", "value": "(?<user_agent>.+?)"
EXTRACT-url = "URL", "value": "(?<url>.+?)"
EXTRACT-client_type = "CLIENT_TYPE", "value": "(?<client_type>.+?)"
EXTRACT-new_boot_mode = "NEW_BOOT_MODE", "value": "(?<new_boot_mode>.+?)"
EXTRACT-trigger_user = "TRIGGER_USER", "value": "(?<trigger_user>.+?)"
EXTRACT-trigger_type = "TRIGGER_TYPE", "value": "(?<trigger_type>.+?)"
EXTRACT-content_name = "CONTENT_NAME", "value": "(?<content_name>.+?)"
EXTRACT-content_type = "CONTENT_TYPE", "value": "(?<content_type>.+?)"
EXTRACT-content_size = "CONTENT_SIZE", "value": "(?<content_size>.+?)"

EVAL-action = case('event.name' IN ("CHROME_OS_LOGIN_FAILURE_EVENT"), "failure", 'event.name' IN ("CHROME_OS_LOGIN_EVENT", "LOGIN_EVENT"), "success", 'event.name' IN ("DEVICE_BOOT_STATE_CHANGE", "PASSWORD_CHANGED"), "modified", 'event.name' IN ("CHROME_OS_ADD_USER"), "created", 'event.name' IN ("CHROME_OS_REMOVE_USER"), "deleted", 'event.name' IN ("CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), "logoff", 'event.name' IN ("CONTENT_TRANSFER") AND trigger_type = "FILE_DOWNLOAD", "downloaded")
EVAL-app = case('event.name' IN ("CHROME_OS_LOGIN_FAILURE_EVENT", "CHROME_OS_LOGIN_EVENT", "LOGIN_EVENT", "CHROME_OS_REPORTING_DATA_LOST", "PASSWORD_REUSE", "DLP_EVENT", "CONTENT_UNSCANNED", "MALWARE_TRANSFER", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT", "CONTENT_TRANSFER"), 'id.applicationName')
EVAL-authentication_service = case('event.name' IN ("CHROME_OS_LOGIN_FAILURE_EVENT", "CHROME_OS_LOGIN_EVENT"), "CHROME_OS_LOGIN")
EVAL-change_type = case('event.name' IN ("DEVICE_BOOT_STATE_CHANGE"), "OS", 'event.name' IN("PASSWORD_CHANGED", "CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), "AAA")
EVAL-command = case('event.name' IN ("DEVICE_BOOT_STATE_CHANGE", "PASSWORD_CHANGED", "CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT", "CONTENT_TRANSFER"), 'event.name')
EVAL-description = case('event.name' IN ("CHROME_OS_REPORTING_DATA_LOST"), event_reason, 'event.name' IN ("PASSWORD_REUSE", "DLP_EVENT", "CONTENT_UNSCANNED", "MALWARE_TRANSFER", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT"), event_reason. " " .event_result)
EVAL-dest = case('event.name' IN ("CHROME_OS_LOGIN_FAILURE_EVENT", "CHROME_OS_LOGIN_EVENT", "CHROME_OS_REPORTING_DATA_LOST", "PASSWORD_REUSE", "DLP_EVENT", "CONTENT_UNSCANNED", "MALWARE_TRANSFER", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT", "DEVICE_BOOT_STATE_CHANGE", "PASSWORD_CHANGED", "CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), device_name, 'event.name' IN ("LOGIN_EVENT", "CONTENT_TRANSFER"), url)
EVAL-dest_name = case('event.name' IN ("CONTENT_TRANSFER"), url)
EVAL-dest_type = case('event.name' IN ("CHROME_OS_REPORTING_DATA_LOST", "PASSWORD_REUSE", "DLP_EVENT", "CONTENT_UNSCANNED", "MALWARE_TRANSFER", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT"), "chrome OS")
EVAL-dest_url = case('event.name' IN ("CONTENT_TRANSFER"), url)
EVAL-dvc = case('event.name' IN ("DEVICE_BOOT_STATE_CHANGE", "PASSWORD_CHANGED", "CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT", "CONTENT_TRANSFER"), device_name)
EVAL-id = case('event.name' IN ("CHROME_OS_REPORTING_DATA_LOST", "PASSWORD_REUSE", "DLP_EVENT", "CONTENT_UNSCANNED", "MALWARE_TRANSFER", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT"), 'id.uniqueQualifier')
EVAL-object = case('event.name' IN ("DEVICE_BOOT_STATE_CHANGE"), "boot_mode", 'event.name' IN ("PASSWORD_CHANGED"), trigger_user, 'event.name' IN ("CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), device_user, 'event.name' IN ("CONTENT_TRANSFER"), content_name)
EVAL-object_attrs = case('event.name' IN ("DEVICE_BOOT_STATE_CHANGE"), new_boot_mode, 'event.name' IN ("PASSWORD_CHANGED"), "TRIGGER_USER", 'event.name' IN ("CHROME_OS_ADD_USER") AND event_reason=="CHROMEOS_AFFILIATED_USER_ADDED", "CHROMEOS_AFFILIATED_USER", 'event.name' IN ("CHROME_OS_REMOVE_USER") AND event_reason=="CHROMEOS_AFFILIATED_USER_REMOVED", "CHROMEOS_AFFILIATED_USER", 'event.name' IN ("CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), "user")
EVAL-object_category = case('event.name' IN ("PASSWORD_CHANGED", "CHROME_OS_ADD_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT", "CHROME_OS_REMOVE_USER"), "user", 'event.name' IN ("CONTENT_TRANSFER"), content_type, 'event.name' IN ("DEVICE_BOOT_STATE_CHANGE"), "OS configuration")
EVAL-object_id = case('event.name' IN ("CONTENT_TRANSFER"), content_name)
EVAL-object_size = case('event.name' IN ("CONTENT_TRANSFER"), content_size)
EVAL-reason = case('event.name' IN ("CHROME_OS_LOGIN_FAILURE_EVENT"), login_failure_reason, 'event.name' IN ("CHROME_OS_LOGIN_EVENT"), event_reason)
EVAL-result = case('event.name' IN ("DEVICE_BOOT_STATE_CHANGE", "PASSWORD_CHANGED"), 'event.name', 'event.name' IN ("CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), event_reason)
EVAL-result_id = case('event.name' IN ("DEVICE_BOOT_STATE_CHANGE", "PASSWORD_CHANGED"), 'event.name', 'event.name' IN ("CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), event_reason)
EVAL-severity = case('event.name' IN ("CHROME_OS_REPORTING_DATA_LOST", "MALWARE_TRANSFER"), "critical", 'event.name' IN ("PASSWORD_REUSE", "CONTENT_UNSCANNED"), "medium", 'event.name' IN ("DLP_EVENT", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT"), "high")
EVAL-signature = case('event.name' IN ("CHROME_OS_LOGIN_FAILURE_EVENT", "CHROME_OS_LOGIN_EVENT", "LOGIN_EVENT", "CHROME_OS_REPORTING_DATA_LOST", "PASSWORD_REUSE", "DLP_EVENT", "CONTENT_UNSCANNED", "MALWARE_TRANSFER", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT", "CONTENT_TRANSFER"), 'event.name')
EVAL-signature_id = case('event.name' IN ("CONTENT_TRANSFER"), 'event.name')
EVAL-src = case('event.name' IN ("CHROME_OS_LOGIN_FAILURE_EVENT", "CHROME_OS_LOGIN_EVENT", "LOGIN_EVENT", "CHROME_OS_REPORTING_DATA_LOST", "PASSWORD_REUSE", "DLP_EVENT", "CONTENT_UNSCANNED", "MALWARE_TRANSFER", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT", "DEVICE_BOOT_STATE_CHANGE", "PASSWORD_CHANGED", "CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT", "CONTENT_TRANSFER"), device_name)
EVAL-src_type = case('event.name' IN ("CHROME_OS_REPORTING_DATA_LOST", "PASSWORD_REUSE", "DLP_EVENT", "CONTENT_UNSCANNED", "MALWARE_TRANSFER", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT"), "chrome OS")
EVAL-src_user = case('event.name' IN ("PASSWORD_CHANGED", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), device_user, 'event.name' IN ("CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER"), 'actor.key')
EVAL-src_user_name = case('event.name' IN ("PASSWORD_CHANGED", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), device_user)
EVAL-src_user_type = case('event.name' IN ("PASSWORD_CHANGED", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), "USER", 'event.name' IN ("CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER"), 'actor.callerType')
EVAL-status = case('event.name' IN ("DEVICE_BOOT_STATE_CHANGE", "PASSWORD_CHANGED", "CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), "success")
EVAL-tenant_id = case('event.name' IN ("CONTENT_TRANSFER"), 'id.customerId')
EVAL-type = case('event.name' IN ("CHROME_OS_REPORTING_DATA_LOST", "DLP_EVENT", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT"), "alert", 'event.name' IN ("PASSWORD_REUSE", "CONTENT_UNSCANNED"), "warning", 'event.name' IN ("MALWARE_TRANSFER"), "alarm")
EVAL-user = case('event.name' IN ("CHROME_OS_LOGIN_FAILURE_EVENT", "CHROME_OS_LOGIN_EVENT", "LOGIN_EVENT", "CHROME_OS_REPORTING_DATA_LOST", "PASSWORD_REUSE", "DLP_EVENT", "CONTENT_UNSCANNED", "MALWARE_TRANSFER", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT", "CONTENT_TRANSFER", "UNSAFE_SITE_VISIT"), device_user, 'event.name' IN ("DEVICE_BOOT_STATE_CHANGE"), 'actor.key', 'event.name' IN ("PASSWORD_CHANGED"), trigger_user)
EVAL-user_name = case('event.name' IN ("CHROME_OS_REPORTING_DATA_LOST", "PASSWORD_REUSE", "DLP_EVENT", "CONTENT_UNSCANNED", "MALWARE_TRANSFER", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT", "CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), device_user, 'event.name' IN ("PASSWORD_CHANGED"), trigger_user)
EVAL-user_agent = case('event.name' IN ("LOGIN_EVENT", "PASSWORD_CHANGED", "CONTENT_TRANSFER"), user_agent)
EVAL-user_type = case ('event.name' IN ("DEVICE_BOOT_STATE_CHANGE"), 'actor.callerType', 'event.name' IN ("PASSWORD_CHANGED"), "browser", 'event.name' IN ("CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), "USER")
EVAL-vendor_account = case('event.name' IN ("CHROME_OS_LOGIN_FAILURE_EVENT", "CHROME_OS_LOGIN_EVENT", "LOGIN_EVENT", "CHROME_OS_REPORTING_DATA_LOST", "PASSWORD_REUSE", "DLP_EVENT", "CONTENT_UNSCANNED", "MALWARE_TRANSFER", "PASSWORD_BREACH", "SENSITIVE_DATA_TRANSFER", "UNSAFE_SITE_VISIT", "DEVICE_BOOT_STATE_CHANGE", "PASSWORD_CHANGED", "CHROME_OS_ADD_USER", "CHROME_OS_REMOVE_USER", "CHROME_OS_LOGIN_LOGOUT_EVENT", "CHROME_OS_LOGOUT_EVENT"), 'id.customerId')

EVAL-vendor_product = "Google Chrome"

[gws:reports:mobile]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N

EXTRACT-device_model = "DEVICE_MODEL", "value": "(?<device_model>.+?)"
EXTRACT-device_id = "DEVICE_ID", "value": "(?<device_id>.+?)"
EXTRACT-device_type = "DEVICE_TYPE", "value": "(?<device_type>.+?)"
EXTRACT-device_compliance = "DEVICE_COMPLIANCE", "value": "(?<device_compliance>.+?)"
EXTRACT-application_id = "APPLICATION_ID", "value": "(?<application_id>.+?)"
EXTRACT-application_state = "APPLICATION_STATE", "value": "(?<application_state>.+?)"
EXTRACT-risk_signal = "RISK_SIGNAL", "value": "(?<risk_signal>.+?)"
EXTRACT-application_report_severity = "APPLICATION_REPORT_SEVERITY", "value": "(?<application_report_severity>.+?)"
EXTRACT-os_property = "OS_PROPERTY", "value": "(?<os_property>.+?)"
EXTRACT-new_value = "NEW_VALUE", "value": "(?<new_value>.+?)"
EXTRACT-old_value = "OLD_VALUE", "value": "(?<old_value>.+?)"
EXTRACT-action_type = "ACTION_TYPE", "value": "(?<action_type>.+?)"
EXTRACT-device_ownership = "DEVICE_OWNERSHIP", "value": "(?<device_ownership>.+?)"
EXTRACT-new_device_id = "NEW_DEVICE_ID", "value": "(?<new_device_id>.+?)"
EXTRACT-device_setting = "DEVICE_SETTING", "value": "(?<device_setting>.+?)"
EXTRACT-policy_sync_result = "POLICY_SYNC_RESULT", "value": "(?<policy_sync_result>.+?)"
EXTRACT-policy_name = "POLICY_NAME", "value": "(?<policy_name>.+?)"
EXTRACT-serial_number = "SERIAL_NUMBER", "value": "(?<serial_number>.+?)"
EXTRACT-device_status_on_apple_portal = "DEVICE_STATUS_ON_APPLE_PORTAL", "value": "(?<device_status_on_apple_portal>.+?)"
EXTRACT-device_compromised_state = "DEVICE_COMPROMISED_STATE", "value": "(?<device_compromised_state>.+?)"
EXTRACT-action_execution_status = "ACTION_EXECUTION_STATUS", "value": "(?<action_execution_status>.+?)"
EXTRACT-device_property = "DEVICE_PROPERTY", "value": "(?<device_property>.+?)"
EXTRACT-account_state = "ACCOUNT_STATE", "value": "(?<account_state>.+?)"
EXTRACT-application_message = "APPLICATION_MESSAGE", "value": "(?<application_message>.+?)"

EVAL-action = case('event.name' IN ("DEVICE_COMPLIANCE_CHANGED_EVENT") AND device_compliance="COMPLIANT", "updated", 'event.name' IN("RISK_SIGNAL_UPDATED_EVENT"), "updated", 'event.name' IN ("APPLICATION_EVENT"), application_state, 'event.name' IN ("FAILED_PASSWORD_ATTEMPTS_EVENT"), "failure", 'event.name' IN ("DEVICE_ACTION_EVENT", "DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT", "APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), "modified")
EVAL-app = case('event.name' IN ("FAILED_PASSWORD_ATTEMPTS_EVENT", "DEVICE_COMPROMISED_EVENT", "APPLICATION_REPORT_EVENT"), device_type)
EVAL-authentication_method = case('event.name' IN ("FAILED_PASSWORD_ATTEMPTS_EVENT"), "password")
EVAL-authentication_service = case('event.name' IN ("FAILED_PASSWORD_ATTEMPTS_EVENT"), "screen")
EVAL-change_type = case('event.name' IN ("DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT", "APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), "mobile")
EVAL-command = case('event.name' IN ("DEVICE_ACTION_EVENT"), action_type, 'event.name' IN ("DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT", "APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), 'event.name')
EVAL-description = case('event.name' IN ("DEVICE_COMPLIANCE_CHANGED_EVENT", "RISK_SIGNAL_UPDATED_EVENT"), device_model, 'event.name' IN ("APPLICATION_EVENT"), application_id, 'event.name' IN ("DEVICE_COMPROMISED_EVENT"), device_compromised_state, 'event.name' IN ("APPLICATION_REPORT_EVENT"), application_message)
EVAL-dest = case('event.name' IN ("DEVICE_COMPLIANCE_CHANGED_EVENT", "RISK_SIGNAL_UPDATED_EVENT", "APPLICATION_EVENT", "FAILED_PASSWORD_ATTEMPTS_EVENT", "DEVICE_COMPROMISED_EVENT", "APPLICATION_REPORT_EVENT", "OS_UPDATED_EVENT", "DEVICE_ACTION_EVENT", "DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT"), device_id, 'event.name' IN ("APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), serial_number)
EVAL-dest_type = case('event.name' IN ("DEVICE_COMPROMISED_EVENT", "APPLICATION_REPORT_EVENT"), "mobile")
EVAL-dvc = case('event.name' IN ("OS_UPDATED_EVENT", "DEVICE_ACTION_EVENT", "DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT"), device_id, 'event.name' IN ("APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), serial_number)
EVAL-file_name = case('event.name' IN ("OS_UPDATED_EVENT"), new_value)
EVAL-id = case('event.name' IN ("DEVICE_COMPROMISED_EVENT", "APPLICATION_REPORT_EVENT"), 'id.uniqueQualifier')
EVAL-new_version = case('event.name' IN ("OS_UPDATED_EVENT"), new_value)
EVAL-object = case('event.name' IN ("DEVICE_ACTION_EVENT", "DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT"), device_id, 'event.name' IN ("DEVICE_SETTINGS_UPDATED_EVENT"), device_setting, 'event.name' IN ("SUSPICIOUS_ACTIVITY_EVENT"), device_property, 'event.name' IN ("ADVANCED_POLICY_SYNC_EVENT"), policy_name, 'event.name' IN ("APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), serial_number)
EVAL-object_attrs = case('event.name' IN ("DEVICE_ACTION_EVENT") AND action_type="RESET_PIN", "PIN", 'event.name' IN ("DEVICE_OWNERSHIP_CHANGE_EVENT"), device_ownership, 'event.name' IN ("DEVICE_SETTINGS_UPDATED_EVENT"), device_setting, 'event.name' IN ("DEVICE_SYNC_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT"), device_model, 'event.name' IN ("SUSPICIOUS_ACTIVITY_EVENT", "ADVANCED_POLICY_SYNC_EVENT"), new_value, 'event.name' IN ("APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), "device")
EVAL-object_category = case('event.name' IN ("DEVICE_ACTION_EVENT", "DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "DEVICE_SYNC_EVENT"), "device", 'event.name' IN ("DEVICE_SETTINGS_UPDATED_EVENT"), "DEVICE_SETTING", 'event.name' IN ("SUSPICIOUS_ACTIVITY_EVENT") AND device_property != "null", "DEVICE_PROPERTY", 'event.name' IN ("ADVANCED_POLICY_SYNC_EVENT"), "policy")
EVAL-object_id = case('event.name' IN ("DEVICE_ACTION_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT"), device_id, 'event.name' IN ("DEVICE_OWNERSHIP_CHANGE_EVENT"), new_device_id, 'event.name' IN ("APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), serial_number)
EVAL-old_version = case('event.name' IN("OS_UPDATED_EVENT"), old_value)
EVAL-reason = case('event.name' IN ("FAILED_PASSWORD_ATTEMPTS_EVENT"), "failed screen unlock attempts")
EVAL-result = case('event.name' IN ("DEVICE_ACTION_EVENT"), action_execution_status, 'event.name' IN ("DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT"), 'event.name', 'event.name' IN ("DEVICE_REGISTER_UNREGISTER_EVENT"), account_state, 'event.name' IN ("ADVANCED_POLICY_SYNC_EVENT"), policy_sync_result, 'event.name' IN ("APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), device_status_on_apple_portal)
EVAL-result_id = case('event.name' IN ("DEVICE_ACTION_EVENT"), action_execution_status, 'event.name' IN ("DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT"), 'event.name')
EVAL-service = case('event.name' IN ("DEVICE_COMPLIANCE_CHANGED_EVENT", "RISK_SIGNAL_UPDATED_EVENT"), device_model, 'event.name' IN ("APPLICATION_EVENT"), application_id)
EVAL-service_id = case('event.name' IN ("DEVICE_COMPLIANCE_CHANGED_EVENT", "RISK_SIGNAL_UPDATED_EVENT"), device_id)
EVAL-service_name = case('event.name' IN ("DEVICE_COMPLIANCE_CHANGED_EVENT", "RISK_SIGNAL_UPDATED_EVENT"), device_type, 'event.name' IN ("APPLICATION_EVENT"), application_id)
EVAL-severity = case('event.name' IN ("DEVICE_COMPROMISED_EVENT"), "informational", 'event.name' IN ("APPLICATION_REPORT_EVENT") AND application_report_severity=="INFO", "informational")
EVAL-signature = case('event.name' IN ("FAILED_PASSWORD_ATTEMPTS_EVENT"), "FAILED_PASSWORD_ATTEMPTS", 'event.name' IN ("DEVICE_COMPROMISED_EVENT", "APPLICATION_REPORT_EVENT"), 'event.name', 'event.name' IN ("OS_UPDATED_EVENT"), os_property)
EVAL-src = case('event.name' IN ("FAILED_PASSWORD_ATTEMPTS_EVENT", "DEVICE_COMPROMISED_EVENT", "APPLICATION_REPORT_EVENT", "DEVICE_ACTION_EVENT", "DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT"), device_id, 'event.name' IN ("APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), serial_number)
EVAL-src_type = case('event.name' IN ("DEVICE_COMPROMISED_EVENT", "APPLICATION_REPORT_EVENT"), "mobile")
EVAL-status = case('event.name' IN ("DEVICE_COMPLIANCE_CHANGED_EVENT"), device_compliance, 'event.name' IN("RISK_SIGNAL_UPDATED_EVENT"), "updated", 'event.name' IN ("APPLICATION_EVENT"), application_state, 'event.name' IN ("OS_UPDATED_EVENT"), "installed", 'event.name' IN ("DEVICE_ACTION_EVENT", "DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT", "APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), "success")
EVAL-type = case('event.name' IN("DEVICE_COMPROMISED_EVENT", "APPLICATION_REPORT_EVENT"), "event")
EVAL-user = case('event.name' IN ("DEVICE_COMPLIANCE_CHANGED_EVENT", "RISK_SIGNAL_UPDATED_EVENT", "APPLICATION_EVENT", "FAILED_PASSWORD_ATTEMPTS_EVENT", "DEVICE_COMPROMISED_EVENT", "APPLICATION_REPORT_EVENT", "DEVICE_ACTION_EVENT", "DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT", "APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), 'actor.email')
EVAL-user_name = case('event.name' IN ("DEVICE_COMPROMISED_EVENT", "APPLICATION_REPORT_EVENT", "DEVICE_ACTION_EVENT", "DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT", "APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), 'actor.email')
EVAL-user_id = case('event.name' IN ("FAILED_PASSWORD_ATTEMPTS_EVENT"), 'actor.profileId')
EVAL-user_type = case('event.name' IN ("FAILED_PASSWORD_ATTEMPTS_EVENT", "DEVICE_ACTION_EVENT", "DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT", "APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT"), 'actor.callerType')
EVAL-vendor_account = case('event.name' IN ("DEVICE_COMPROMISED_EVENT", "APPLICATION_REPORT_EVENT", "DEVICE_ACTION_EVENT", "DEVICE_OWNERSHIP_CHANGE_EVENT", "DEVICE_SETTINGS_UPDATED_EVENT", "DEVICE_SYNC_EVENT", "ANDROID_WORK_PROFILE_SUPPORT_ENABLED_EVENT", "SUSPICIOUS_ACTIVITY_EVENT", "DEVICE_REGISTER_UNREGISTER_EVENT", "ADVANCED_POLICY_SYNC_EVENT", "APPLE_DEP_DEVICE_UPDATE_ON_APPLE_PORTAL_EVENT", "FAILED_PASSWORD_ATTEMPTS_EVENT"), 'id.customerId')

EVAL-vendor_product = "Google Mobile"

LOOKUP-gws_mobile_lookup = gws_mobile_lookup action_type OUTPUTNEW change_type

[gws:reports:chat]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N

EXTRACT-attachment_url = "attachment_url", "value": "(?<attachment_url>.+?)"
EXTRACT-attachment_name = "attachment_name", "value": "(?<attachment_name>.+?)"
EXTRACT-attachment_hash = "attachment_hash", "value": "(?<attachment_hash>.+?)"
EXTRACT-message_id = "message_id", "value": "(?<message_id>.+?)"
EXTRACT-room_id = "room_id", "value": "(?<room_id>.+?)"
EXTRACT-filename = "filename", "value": "(?<filename>.+?)"
EXTRACT-emoji_shortcode = "emoji_shortcode", "value": "(?<emoji_shortcode>.+?)"
EXTRACT-room_name = "room_name", "value": "(?<room_name>.+?)"
EXTRACT-target_users = "multiValue": \["(?<target_users>.+?)"

FIELDALIAS-app = id.applicationName AS app
FIELDALIAS-command = event.name AS command
FIELDALIAS-dest = id.customerId AS dest
FIELDALIAS-dest_name = id.customerId AS dest_name
FIELDALIAS-email = actor.email AS email
FIELDALIAS-signature = event.name AS signature
FIELDALIAS-signature_id = event.name AS signature_id
FIELDALIAS-user = actor.email AS user
FIELDALIAS-user_role = actor.callerType AS user_role
FIELDALIAS-tenant_id = id.customerId AS tenant_id

EVAL-action = case('event.name' IN ("attachment_download"), "downloaded", 'event.name' IN ("attachment_upload"), "uploaded", 'event.name' IN ("add_room_member"), "granted", 'event.name' IN ("block_user", "remove_room_member"), "revoke", 'event.name' IN ("direct_message_started", "invite_send"), "shared", 'event.name' IN ("emoji_created", "message_posted", "room_created"), "created", 'event.name' IN ("emoji_deleted"), "deleted", 'event.name' IN ("message_edited"), "modified", 'event.name' IN ("block_room"), "revoked")
EVAL-dest_url = case('event.name' IN ("attachment_download"), attachment_url)
EVAL-object = case('event.name' IN ("attachment_download", "attachment_upload"), attachment_name, 'event.name' IN ("add_room_member", "block_user", "invite_send", "block_room", "remove_room_member"), room_id, 'event.name' IN ("direct_message_started", "message_edited", "message_posted"), message_id, 'event.name' IN ("emoji_created", "emoji_deleted"), filename, 'event.name' IN ("room_created"), room_name)
EVAL-object_category = case('event.name' IN ("attachment_download", "attachment_upload"), "attachment", 'event.name' IN ("add_room_member", "block_user", "invite_send", "room_created", "block_room", "remove_room_member"), "room", 'event.name' IN ("direct_message_started"), "direct_message", 'event.name' IN ("emoji_created", "emoji_deleted"), "emoji", 'event.name' IN ("message_edited", "message_posted"), "message")
EVAL-object_id = case('event.name' IN ("attachment_download", "attachment_upload"), attachment_name, 'event.name' IN ("add_room_member", "block_user", "invite_send", "remove_room_member", "room_created", "block_room"), room_id, 'event.name' IN ("direct_message_started", "message_edited", "message_posted"), message_id, 'event.name' IN ("emoji_created", "emoji_deleted"), emoji_shortcode)
EVAL-object_path = case('event.name' IN ("attachment_upload"), message_id)
EVAL-owner = case('event.name' IN ("attachment_upload"), 'actor.email')
EVAL-owner_email = case('event.name' IN ("attachment_upload"), 'actor.email')
EVAL-parent_object = case('event.name' IN ("attachment_upload"), message_id)
EVAL-parent_object_id = case('event.name' IN ("attachment_upload"), message_id)
EVAL-parent_object_category = case('event.name' IN ("attachment_upload"), "message")

EVAL-dvc = "Google Chat"
EVAL-vendor_product = "Google Chat"

[gws:reports:data_studio]
KV_MODE = json
SHOULD_LINEMERGE = false
DATETIME_CONFIG = NONE
TRUNCATE = 9999999

EXTRACT-distribution_content_name = "DISTRIBUTION_CONTENT_NAME", "value": "(?<distribution_content_name>.+?)"
EXTRACT-distribution_content_type = "DISTRIBUTION_CONTENT_TYPE", "value": "(?<distribution_content_type>.+?)"
EXTRACT-distribution_content_id = "DISTRIBUTION_CONTENT_ID", "value": "(?<distribution_content_id>.+?)"
EXTRACT-asset_name = "ASSET_NAME", "value": "(?<asset_name>.+?)"
EXTRACT-asset_type = "ASSET_TYPE", "value": "(?<asset_type>.+?)"
EXTRACT-asset_id = "ASSET_ID", "value": "(?<asset_id>.+?)"
EXTRACT-distribution_content_owner_email = "DISTRIBUTION_CONTENT_OWNER_EMAIL", "value": "(?<distribution_content_owner_email>.+?)"
EXTRACT-target_domain = "TARGET_DOMAIN", "value": "(?<target_domain>.+?)"
EXTRACT-owner_mail = "OWNER_EMAIL", "value": "(?<owner_mail>.+?)"
EXTRACT-visibility = "VISIBILITY", "value": "(?<visibility>.+?)"
EXTRACT-parent_workspace_id = "PARENT_WORKSPACE_ID", "value": "(?<parent_workspace_id>.+?)"
EXTRACT-data_export_type = "DATA_EXPORT_TYPE", "value": "(?<data_export_type>.+?)"
EXTRACT-target_user_email = "TARGET_USER_EMAIL", "value": "(?<target_user_email>.+?)"

FIELDALIAS-app = id.applicationName AS app
FIELDALIAS-dest = id.customerId AS dest
FIELDALIAS-dest_name = id.customerId AS dest_name
FIELDALIAS-email = actor.email AS email
FIELDALIAS-src = ipAddress AS src
FIELDALIAS-vendor_account = id.customerId as vendor_account
FIELDALIAS-user_email = actor.email AS user_email
FIELDALIAS-user_id = actor.email AS user_id

EVAL-action = case('event.name' IN("DELETE_DISTRIBUTION_CONTENT", "TRASH"), "deleted", 'event.name' IN("CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE"), "granted", 'event.name' IN("RESTORE", "CREATE", "CREATE_DISTRIBUTION_CONTENT"), "created", 'event.name' IN("CHANGE_ASSET_LINK_SHARING_VISIBILITY"), "shared", 'events{}.name' IN("EDIT", "DATA_EXPORT"), "modified", 'event.name' IN("EDIT_DISTRIBUTION_CONTENT", "CHANGE_USER_ACCESS"), "modified", 'event.name' IN("DOWNLOAD_REPORT"), "downloaded")
EVAL-change_type = case('event.name' IN ("CHANGE_USER_ACCESS"), "AAA")
EVAL-object = case('event.name' IN("DELETE_DISTRIBUTION_CONTENT", "EDIT_DISTRIBUTION_CONTENT", "CREATE_DISTRIBUTION_CONTENT"), distribution_content_name, 'event.name' IN("CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "RESTORE", "CHANGE_ASSET_LINK_SHARING_VISIBILITY", "CREATE", "TRASH", "DOWNLOAD_REPORT"), asset_name, 'events{}.name' IN("EDIT", "DATA_EXPORT"), asset_name, 'event.name' IN("CHANGE_USER_ACCESS"), target_user_email)
EVAL-object_attrs = case('event.name' IN("DELETE_DISTRIBUTION_CONTENT", "EDIT_DISTRIBUTION_CONTENT", "CREATE_DISTRIBUTION_CONTENT", "CHANGE_USER_ACCESS"), "ASSET_NAME:" + asset_name, 'event.name' IN("CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "CHANGE_ASSET_LINK_SHARING_VISIBILITY"), "TARGET_DOMAIN:" + target_domain, 'event.name' IN("RESTORE", "CREATE", "TRASH", "DOWNLOAD_REPORT"), "VISIBILITY:" + visibility, 'events{}.name' IN("EDIT"), "VISIBILITY:" + visibility, 'events{}.name' IN("DATA_EXPORT"), "DATA_EXPORT_TYPE:" + data_export_type)
EVAL-object_category = case('event.name' IN("DELETE_DISTRIBUTION_CONTENT", "EDIT_DISTRIBUTION_CONTENT", "CREATE_DISTRIBUTION_CONTENT"), distribution_content_type, 'event.name' IN("CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "RESTORE", "CHANGE_ASSET_LINK_SHARING_VISIBILITY", "CREATE", "TRASH", "DOWNLOAD_REPORT"), asset_type, 'events{}.name' IN("EDIT", "DATA_EXPORT"), asset_type, 'event.name' IN("CHANGE_USER_ACCESS"), "user")
EVAL-object_id = case('event.name' IN("DELETE_DISTRIBUTION_CONTENT", "EDIT_DISTRIBUTION_CONTENT", "CREATE_DISTRIBUTION_CONTENT"), distribution_content_id, 'event.name' IN("CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "RESTORE", "CHANGE_ASSET_LINK_SHARING_VISIBILITY", "CREATE", "TRASH", "DOWNLOAD_REPORT"), asset_id, 'events{}.name' IN("EDIT", "DATA_EXPORT"), asset_id, 'event.name' IN("CHANGE_USER_ACCESS"), target_user_email)
EVAL-parent_object = case('event.name' IN("DELETE_DISTRIBUTION_CONTENT", "EDIT_DISTRIBUTION_CONTENT", "CREATE_DISTRIBUTION_CONTENT"), asset_name)
EVAL-parent_object_category = case('event.name' IN("DELETE_DISTRIBUTION_CONTENT", "EDIT_DISTRIBUTION_CONTENT", "CREATE_DISTRIBUTION_CONTENT"), asset_type, 'event.name' IN("RESTORE"), "workspace")
EVAL-parent_object_id = case('event.name' IN("DELETE_DISTRIBUTION_CONTENT", "EDIT_DISTRIBUTION_CONTENT", "CREATE_DISTRIBUTION_CONTENT"), asset_id, 'event.name' IN("RESTORE", "CHANGE_ASSET_LINK_SHARING_VISIBILITY", "CREATE", "TRASH"), parent_workspace_id, 'events{}.name' IN("EDIT"), parent_workspace_id)
EVAL-owner = case('event.name' IN("DELETE_DISTRIBUTION_CONTENT", "EDIT_DISTRIBUTION_CONTENT", "CREATE_DISTRIBUTION_CONTENT"), distribution_content_owner_email, 'event.name' IN("CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "RESTORE", "CHANGE_ASSET_LINK_SHARING_VISIBILITY", "CREATE", "TRASH", "DOWNLOAD_REPORT"), owner_mail, 'events{}.name' IN("EDIT", "DATA_EXPORT"), owner_mail)
EVAL-owner_email = case('event.name' IN("DELETE_DISTRIBUTION_CONTENT", "EDIT_DISTRIBUTION_CONTENT", "CREATE_DISTRIBUTION_CONTENT"), distribution_content_owner_email, 'event.name' IN("CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "RESTORE", "CHANGE_ASSET_LINK_SHARING_VISIBILITY", "CREATE", "TRASH", "DOWNLOAD_REPORT"), owner_mail, 'events{}.name' IN("EDIT", "DATA_EXPORT"), owner_mail)
EVAL-owner_id = case('event.name' IN("DELETE_DISTRIBUTION_CONTENT", "EDIT_DISTRIBUTION_CONTENT", "CREATE_DISTRIBUTION_CONTENT"), distribution_content_owner_email, 'event.name' IN("CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "RESTORE", "CHANGE_ASSET_LINK_SHARING_VISIBILITY", "CREATE", "TRASH", "DOWNLOAD_REPORT"), owner_mail, 'events{}.name' IN("EDIT", "DATA_EXPORT"), owner_mail)
EVAL-result = case('event.name' IN("CHANGE_USER_ACCESS"), 'event.name')
EVAL-result_id = case('event.name' IN("CHANGE_USER_ACCESS"), 'event.name')
EVAL-src_user = case('event.name' IN("CHANGE_USER_ACCESS"), 'actor.email')
EVAL-src_user_name = case('event.name' IN("CHANGE_USER_ACCESS"), 'actor.email')
EVAL-src_user_type = case('event.name' IN("CHANGE_USER_ACCESS"), 'actor.callerType')
EVAL-user = case('event.name' IN("CHANGE_USER_ACCESS"), target_user_email, 'event.name' IN("CHANGE_ASSET_LINK_SHARING_VISIBILITY", "DOWNLOAD_REPORT", "EDIT_DISTRIBUTION_CONTENT", "CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "CREATE", "TRASH", "RESTORE", "CREATE_DISTRIBUTION_CONTENT", "DELETE_DISTRIBUTION_CONTENT"), 'actor.email', 'events{}.name' IN("EDIT", "DATA_EXPORT"), 'actor.email')
EVAL-user_name = case('event.name' IN("CHANGE_USER_ACCESS"), target_user_email, 'event.name' IN("CHANGE_ASSET_LINK_SHARING_VISIBILITY", "DOWNLOAD_REPORT", "EDIT_DISTRIBUTION_CONTENT", "CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "CREATE", "TRASH", "RESTORE", "CREATE_DISTRIBUTION_CONTENT", "DELETE_DISTRIBUTION_CONTENT"), 'actor.email', 'events{}.name' IN("EDIT", "DATA_EXPORT"), 'actor.email')
EVAL-user_type = case('event.name' IN("CHANGE_USER_ACCESS"), "USER", 'event.name' IN("CHANGE_ASSET_LINK_SHARING_VISIBILITY", "DOWNLOAD_REPORT", "EDIT_DISTRIBUTION_CONTENT", "CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "CREATE", "TRASH", "RESTORE", "CREATE_DISTRIBUTION_CONTENT", "DELETE_DISTRIBUTION_CONTENT"), 'actor.callerType', 'events{}.name' IN("EDIT", "DATA_EXPORT"), 'actor.callerType')
EVAL-status = case('event.name' IN("CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "CHANGE_ASSET_LINK_SHARING_VISIBILITY", "EDIT_DISTRIBUTION_CONTENT", "CHANGE_USER_ACCESS"), "success")
EVAL-dvc = "Google Data Studio"
EVAL-vendor_product = "Google Data Studio"
EVAL-command = case('events{}.name' IN ("DATA_EXPORT", "EDIT"), 'events{}.name', 'event.name' IN("CHANGE_USER_ACCESS"), 'event.name')
EVAL-signature = case('events{}.name' IN ("DATA_EXPORT", "EDIT"), 'events{}.name', 'event.name' IN("CHANGE_ASSET_LINK_SHARING_VISIBILITY", "DOWNLOAD_REPORT", "EDIT_DISTRIBUTION_CONTENT", "CHANGE_ASSET_LINK_SHARING_ACCESS_TYPE", "CREATE", "TRASH", "RESTORE", "CREATE_DISTRIBUTION_CONTENT", "DELETE_DISTRIBUTION_CONTENT"), 'event.name')

[gws:reports:saml]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N

EXTRACT-login_success_app = application_name(?:[\",\s]+)value(?:[\":\s]+)(?P<login_success_app>.*?)\"
EXTRACT-login_success_reason = saml_status_code(?:[\",\s]+)value(?:[\":\s]+)(?P<login_success_reason>.*?)\"
EXTRACT-login_failure_reason = failure_type(?:[\",\s]+)value(?:[\":\s]+)(?P<login_failure_reason>.*?)\"

EVAL-action = case('event.name'="login_success", "success", 'event.name'="login_failure", "failure")
EVAL-app = case('event.name'="login_success", login_success_app, 'event.name'="login_failure", "Google Workspace")
EVAL-authentication_method = case('event.name' IN("login_success", "login_failure"), "SAML")
EVAL-authentication_service = case('event.name' IN("login_success", "login_failure"), "Google Workspace")
EVAL-dest = case('event.name'="login_success", login_success_app, 'event.name'="login_failure", "Google Workspace")
EVAL-dest_name = case('event.name'="login_success", login_success_app, 'event.name'="login_failure", "Google Workspace")
EVAL-reason = case('event.name'="login_success", login_success_reason, 'event.name'="login_failure", login_failure_reason)
EVAL-signature = case('event.name' IN("login_success", "login_failure"), 'event.name')
EVAL-src = case('event.name' IN("login_success", "login_failure"), ipAddress)
EVAL-src_ip = case('event.name' IN("login_success", "login_failure"), ipAddress)
EVAL-user = case('event.name' IN("login_success", "login_failure"), 'actor.email')
EVAL-user_id = case('event.name' IN("login_success", "login_failure"), 'actor.profileId')
EVAL-vendor_account = case('event.name' IN("login_success", "login_failure"), 'id.customerId')

[gws:reports:groups_enterprise]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N

EXTRACT-group_id = "group_id", "value": "(?P<group_id>.+?)"
EXTRACT-member_id = "member_id", "value": "(?P<member_id>.+?)"
EXTRACT-member_type = "member_type", "value": "(?P<member_type>.+?)"
EXTRACT-security_setting = "security_setting", "value": "(?P<security_setting>.+?)"

EVAL-action = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "add_member", "add_security_setting", "change_security_setting", "invite_member"), "modified", 'event.name'="create_group", "created", 'event.name'="delete_group", "deleted")
EVAL-change_type = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group", "invite_member"), "AAA")
EVAL-command = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group", "invite_member"), 'event.name')
EVAL-dest = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group"), "groups_enterprise", 'event.name' IN("invite_member"), 'id.customerId')
EVAL-dvc = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group"), "Google Enterprise Groups", 'event.name' IN("invite_member"), "Google groups enterprise")
EVAL-object = case('event.name' IN("add_member_role", "add_service_account_permission", "unban_member", "invite_member"), member_id, 'event.name' IN("join"), 'actor.email', 'event.name' IN("add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group"), group_id)
EVAL-object_id = case('event.name' IN("add_member_role", "add_service_account_permission", "unban_member", "invite_member"), member_id, 'event.name' IN("join"), 'actor.profileId', 'event.name' IN("add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group"), group_id)
EVAL-object_attrs = case('event.name' IN("add_member_role", "add_service_account_permission"), "member_role", 'event.name' IN("join", "unban_member", "invite_member"), group_id, 'event.name' IN("add_member"), member_id + ", " + 'event.parameters{}.multiValue{}', 'event.name' IN("add_security_setting", "change_security_setting"), security_setting, 'event.name' IN("create_group", "delete_group"), "group")
EVAL-object_category = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "invite_member"), "user", 'event.name' IN("add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group"), "group")
EVAL-object_path = case('event.name' IN("add_member_role", "add_member"), group_id)
EVAL-src_user = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "invite_member"), 'actor.email')
EVAL-src_user_name = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "invite_member"), 'actor.email')
EVAL-src_user_type = case('event.name' IN("invite_member"), 'actor.callerType')
EVAL-status = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group", "invite_member"), "success")
EVAL-result = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group", "invite_member"), 'event.name')
EVAL-result_id = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group", "invite_member"), 'event.name')
EVAL-user = case('event.name' IN("add_member_role", "add_service_account_permission", "unban_member", "invite_member"), member_id, 'event.name' IN("join", "add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group"), 'actor.email')
EVAL-user_name = case('event.name' IN("add_member_role", "add_service_account_permission", "unban_member", "invite_member"), member_id, 'event.name' IN("join", "add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group"), 'actor.email')
EVAL-user_type = case('event.name'="add_service_account_permission", "service_account", 'event.name'="invite_member", member_type)
EVAL-vendor_account = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group", "invite_member"), 'id.customerId')
EVAL-vendor_product = case('event.name' IN("add_member_role", "add_service_account_permission", "join", "unban_member", "add_member", "add_security_setting", "change_security_setting", "create_group", "delete_group", "invite_member"), "Google Enterprise Groups")

[gws:reports:gcp]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N

EXTRACT-user_email_extracted = "USER_EMAIL", "value": "(?P<user_email_extracted>.+?)"

EVAL-action = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "UPDATE_SSH_PUBLIC_KEY"), "modified", 'event.name' IN("GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE"), "read")
EVAL-change_type = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), "AAA")
EVAL-command = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), 'event.name')
EVAL-dest = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), "gcp")
EVAL-dvc = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), "Google Cloud Platform")
EVAL-object = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), 'actor.email')
EVAL-object_attrs = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "UPDATE_SSH_PUBLIC_KEY"), "SSH_PUBLIC_KEY", 'event.name' IN("GET_LOGIN_PROFILE"), "LOGIN_PROFILE")
EVAL-object_category = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), "user")
EVAL-object_id = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), 'actor.profileId')
EVAL-result = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), 'event.name')
EVAL-result_id = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), 'event.name')
EVAL-src = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), 'ipAddress')
EVAL-src_user = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), 'actor.email')
EVAL-src_user_name = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), 'actor.email')
EVAL-status = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), "success")
EVAL-user = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), user_email_extracted)
EVAL-user_name = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), user_email_extracted)
EVAL-vendor_account = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), 'id.customerId')
EVAL-vendor_product = case('event.name' IN("IMPORT_SSH_PUBLIC_KEY", "GET_SSH_PUBLIC_KEY", "GET_LOGIN_PROFILE", "UPDATE_SSH_PUBLIC_KEY"), "Google Cloud Platform")

[gws:reports:calendar]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N

EXTRACT-access_level = "access_level", "value": "(?P<access_level>.+?)"
EXTRACT-calendar_id = "calendar_id", "value": "(?P<calendar_id>.+?)"
EXTRACT-event_id = "event_id", "value": "(?P<event_id>.+?)"
EXTRACT-event_guest = "event_guest", "value": "(?P<event_guest>.+?)"
EXTRACT-event_title = "event_title", "value": "(?P<event_title>.+?)"
EXTRACT-target_calendar_id = "target_calendar_id", "value": "(?P<target_calendar_id>.+?)"
EXTRACT-user_agent_extracted = "user_agent", "value": "(?P<user_agent_extracted>.+?)"

EVAL-action = case('event.name' IN("change_calendar_acls"), "acl_modified", 'event.name' IN("create_calendar", "create_event"), "created", 'event.name' IN("delete_calendar", "delete_event"), "deleted", 'event.name' IN("add_event_guest", "change_event", "restore_event"), "modified")
EVAL-change_type = case('event.name' IN("change_calendar_acls"), "AAA", 'event.name' IN("create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), "collaboration")
EVAL-command = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), 'event.name')
EVAL-dest = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), 'id.customerId')
EVAL-dvc = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), "google calendar")
EVAL-object = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar"), calendar_id, 'event.name' IN("create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), event_title)
EVAL-object_attrs = case('event.name' IN("change_calendar_acls"), access_level, 'event.name' IN("create_calendar", "delete_calendar"), "calendar", 'event.name' IN("create_event", "delete_event", "change_event", "restore_event"), "calendar_id="+calendar_id, 'event.name' IN("add_event_guest"), "event_guest="+event_guest)
EVAL-object_category = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar"), "calendar", 'event.name' IN("create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), "calendar event")
EVAL-object_id = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar"), target_calendar_id, 'event.name' IN("create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), event_id)
EVAL-result = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), 'event.name')
EVAL-result_id = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), 'event.name')
EVAL-src = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), 'ipAddress')
EVAL-status = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), "success")
EVAL-user = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), 'actor.email')
EVAL-user_agent = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), user_agent_extracted)
EVAL-user_name = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), 'actor.email')
EVAL-vendor_account = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), 'id.customerId')
EVAL-vendor_product = case('event.name' IN("change_calendar_acls", "create_calendar", "delete_calendar", "create_event", "delete_event", "add_event_guest", "change_event", "restore_event"), "Google Calendar")

[gws:reports:context_aware_access]
KV_MODE = json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N

EXTRACT-caa_application = "CAA_APPLICATION", "value": "(?P<caa_application>.+?)"

EVAL-action = case('event.name' IN("ACCESS_DENY_EVENT"), "read")
EVAL-app = case('event.name' IN("ACCESS_DENY_EVENT"), caa_application)
EVAL-dest = case('event.name' IN("ACCESS_DENY_EVENT"), 'id.customerId')
EVAL-dest_name = case('event.name' IN("ACCESS_DENY_EVENT"), 'id.customerId')
EVAL-dvc = case('event.name' IN("ACCESS_DENY_EVENT"), "Google Workspace")
EVAL-email = case('event.name' IN("ACCESS_DENY_EVENT"), 'actor.email')
EVAL-object = case('event.name' IN("ACCESS_DENY_EVENT"), caa_application)
EVAL-object_attrs = case('event.name' IN("ACCESS_DENY_EVENT"), lower(caa_application))
EVAL-object_category = case('event.name' IN("ACCESS_DENY_EVENT"), lower(caa_application))
EVAL-object_id = case('event.name' IN("ACCESS_DENY_EVENT"), caa_application)
EVAL-src = case('event.name' IN("ACCESS_DENY_EVENT"), 'ipAddress')
EVAL-status = case('event.name' IN("ACCESS_DENY_EVENT"), "failure")
EVAL-tenant_id = case('event.name' IN("ACCESS_DENY_EVENT"), 'id.customerId')
EVAL-user = case('event.name' IN("ACCESS_DENY_EVENT"), 'actor.email')
EVAL-user_email = case('event.name' IN("ACCESS_DENY_EVENT"), 'actor.email')
EVAL-user_id = case('event.name' IN("ACCESS_DENY_EVENT"), 'actor.profileId')
EVAL-user_role = case('event.name' IN("ACCESS_DENY_EVENT"), 'actor.callerType')
EVAL-user_type = case('event.name' IN("ACCESS_DENY_EVENT"), 'actor.callerType')
EVAL-vendor_account = case('event.name' IN("ACCESS_DENY_EVENT"), 'id.customerId')
EVAL-vendor_product = case('event.name' IN("ACCESS_DENY_EVENT"), "Google Workspace")

[gws:reports:rules]
KV_MODE=json
SHOULD_LINEMERGE = false
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N

[gws:gmail]
KV_MODE = json
SHOULD_LINEMERGE = false
DATETIME_CONFIG = NONE
TRUNCATE = 9999999

EVAL-action = case('message_info.action_type' IN(3, 10), "delivered", 'message_info.action_type'=19, "deleted", 'message_info.action_type'=54, "blocked", 'message_info.action_type' IN(69, 70), "quarantined")
EVAL-duration = tonumber('event_info.elapsed_time_usec')/1000000
EVAL-message_info = "\"matched_string\": " + "\"" + 'message_info.triggered_rule_info{}.string_match{}.matched_string' + "\""
EVAL-protocol = if(like('message_info.source.service', "smtp%") OR like('message_info.destination{}.service', "smtp%"), "smtp", null())
EVAL-recipient_domain = mvindex(split('message_info.destination{}.address', "@"), 1)
EVAL-recipient_count = mvcount(split('message_info.flattened_destinations', ","))
EVAL-src_user = coalesce('message_info.source.from_header_address', 'message_info.source.address')
EVAL-src_user_domain = mvindex(split(coalesce('message_info.source.from_header_address', 'message_info.source.address'), "@"), 1)
EVAL-vendor_product = "Gmail"

FIELDALIAS-action_id = message_info.action_type AS action_id
FIELDALIAS-file_hash = message_info.attachment{}.sha256 AS file_hash
FIELDALIAS-message_id = message_info.rfc2822_message_id AS message_id
FIELDALIAS-process = message_info.source.service AS process
FIELDALIAS-recipient = message_info.destination{}.address AS recipient
FIELDALIAS-size = message_info.payload_size AS size
FIELDALIAS-src = message_info.connection_info.client_ip AS src
FIELDALIAS-src_ip = message_info.connection_info.client_ip AS src_ip
FIELDALIAS-status_code = message_info.connection_info.smtp_reply_code AS status_code
FIELDALIAS-subject = message_info.subject AS subject
FIELDALIAS-user = message_info.source.from_header_displayname AS user

[gws:alerts]
KV_MODE = json
SHOULD_LINEMERGE = false
DATETIME_CONFIG = NONE
TRUNCATE = 9999999

FIELDALIAS-vendor_account = customerId AS vendor_account
FIELDALIAS-signature_id = type AS signature_id
FIELDALIAS-signature = type AS signature
FIELDALIAS-id = alertId AS id

FIELDALIAS-event_type = type AS event_type

EVAL-app = "Google Alert Center"
EVAL-severity = lower('metadata.severity')
EVAL-description = case('type' = "Customer takeout initiated", "A takeout operation for the entire domain was initiated by an admin.",\
                        'type' = "Malware reclassification", "Unopened messages that are detected as malware post-delivery are automatically reclassified and removed from the user's inbox.",\
                        'type' = "Misconfigured whitelist", "Alert for setting the domain or IP that malicious email comes from as whitelisted domain or IP in Gmail advanced settings.", \
                        'type' = "Phishing reclassification", "Unopened messages that are detected as phishing post-delivery are automatically reclassified and removed from the user's inbox", \
                        'type' = "Suspicious message reported", "An external sender has sent messages to your organization that users have classified as spam", \
                        'type' = "User reported phishing", "Phishing alert: User reported phishing", \
                        'type' = "User reported spam spike", "An unusually high volume of messages have been marked as spam by users in your organization", \
                        'type' = "Leaked password", "Alert for user account warning events: Password leaked.", \
                        'type' = "Suspicious login", "Suspicious login blocked", \
                        'type' = "Suspicious login (less secure app)", "Suspicious login attempt using apps and devices that dont use modern security standards", \
                        'type' = "Suspicious programmatic login", "Suspicious login attempt using programmatic logins", \
                        'type' = "User suspended", "Suspicious activity that suggests an account has been compromised and was proactively suspended", \
                        'type' = "User suspended (spam)", "Account has been compromised sending spam and was proactively suspended", \
                        'type' = "User suspended (spam through relay)", "Account has been compromised sending spam through the SMTP relay service and was proactively suspended", \
                        'type' = "User suspended (suspicious activity)", "Account suspended due to suspicious activity", \
                        'type' = "Google Operations", "An incident reported by Google Operations for a Google Workspace application. Security update for Drive", \
                        'type' = "Government attack warning", "A state-sponsored attack alert. Derived from audit logs.", \
                        'type' = "Activity Rule", "Alert from Google Alert Center Security Center rules service configured by an admin.", \
                        'type' = "Data Loss Prevention", "Alert that get triggered on violations of Data Loss Prevention (DLP) rules.", \
                        'type' = "Primary admin changed", "Sensitive Admin Action occured in customer account: Primary admin changed", \
                        'type' = "SSO profile added", "Sensitive Admin Action occured in customer account: SSO Profile Added", \
                        'type' = "SSO profile updated", "Sensitive Admin Action occured in customer account: SSO Profile Updated", \
                        'type' = "SSO profile deleted", "Sensitive Admin Action occured in customer account: SSO Profile Deleted", \
                        'type' = "Super admin password reset", "Sensitive Admin Action occured in customer account: Super admin password reset" \
                        )
EVAL-dest = case('type' IN ("Customer takeout initiated", "Misconfigured whitelist", "Google Operations", "Government attack warning", "Activity Rule",  "SSO profile added", "SSO profile updated","SSO profile deleted", "Primary admin changed", "Sensitive Admin Action"), 'customerId', \
                 'type' IN ("Malware reclassification", "Misconfigured whitelist", "Phishing reclassification", "Suspicious message reported", "User reported phishing", "User reported spam spike"), 'data.messages{}.recipient', \
                 'type' IN ("Leaked password", "Suspicious login", "Suspicious login (less secure app)", "Suspicious programmatic login", "User suspended", "User suspended (spam)", "User suspended (spam through relay)", "User suspended (suspicious activity)"), 'data.email', \
                 'type' IN ("Google Operations"), 'data.affectedUserEmails', \
                 'type' IN ("Data Loss Prevention"), 'data.ruleViolationInfo.resourceInfo.resourceTitle', \
                 'type' IN ("Super admin password reset"), 'data.superAdminPasswordResetEvent.userEmail' \
                )
EVAL-dest_type = case('type' IN ("Customer takeout initiated", "User suspended (suspicious activity)"), "domain", \
                      'type' IN ("Malware reclassification", "Phishing reclassification", "Suspicious message reported", "User reported phishing", "User reported spam spike", "Leaked password",  "Suspicious login", "Suspicious login (less secure app)", "Suspicious programmatic login", "User suspended", "User suspended (spam)", "User suspended (spam through relay)", "Primary admin changed", "Super admin password reset", "Sensitive Admin Action" ), "account", \
                      'type' IN ("Misconfigured whitelist"), "whitelist", \
                      'type' IN ("Google Operations", "Government attack warning", "Activity Rule", "SSO profile added", "SSO profile updated", "SSO profile deleted" ), "Google Workspace account", \
                      'type' IN ("Data Loss Prevention"), "resource" \
                     )

EVAL-src = case('type' IN ("Customer takeout initiated", "Leaked password", "Suspicious login", "Suspicious login (less secure app)", "Suspicious programmatic login", "User suspended", "User suspended (spam)", "User suspended (spam through relay)", "User suspended (suspicious activity)", "Government attack warning" ), 'data.email', \
                'type' IN ("Malware reclassification", "Misconfigured whitelist", "Phishing reclassification", "Suspicious message reported", "User reported phishing", "User reported spam spike"), 'data.maliciousEntity.entity.emailAddress',\
                'type' IN ("Google Operations"), 'data.affectedUserEmails{}',\
                'type' IN ("Data Loss Prevention"), 'data.ruleViolationInfo.triggeringUserEmail',\
                'type' IN ("Primary admin changed", "SSO profile added", "SSO profile updated", "SSO profile deleted", "Super admin password reset"), 'data.actorEmail',\
                'type' IN ("Activity Rule"), None \
                )
EVAL-src_ip = case('type' IN ("Misconfigured whitelist" ), 'data.sourceIp', \
                   'type' IN ("Suspicious login", "Suspicious login (less secure app)", "Suspicious programmatic login", "User suspended", "User suspended (spam)", "User suspended (spam through relay)", "User suspended (suspicious activity)", "Leaked password"), 'data.loginDetails.ipAddress' \
                  )
EVAL-src_user = case('type' IN ("Misconfigured whitelist" ), 'data.maliciousEntity.entity.emailAddress', \
                     'type' IN ("Suspicious login", "Suspicious login (less secure app)", "Suspicious programmatic login" , "User suspended", "User suspended (spam)", "User suspended (spam through relay)", "User suspended (suspicious activity)", "Leaked password"), 'data.email' \
                     )
EVAL-src_type = case('type' = "Activity Rule" , None,  1=1, "user")
EVAL-type = case('metadata.severity'="HIGH", "alarm", 'metadata.severity'="MEDIUM", "alert", 'metadata.severity'="LOW", "warning" )
EVAL-user = case('type' IN ("Customer takeout initiated", "Leaked password", "Suspicious login", "Suspicious login (less secure app)", "Suspicious programmatic login", "User suspended", "User suspended (spam)", "User suspended (spam through relay)", "User suspended (suspicious activity)", "Government attack warning" ), 'data.email', \
                'type' IN ("Malware reclassification", "Misconfigured whitelist", "Phishing reclassification", "Suspicious message reported", "User reported phishing", "User reported spam spike"), 'data.messages{}.recipient',\
                'type' IN ("Google Operations"), 'data.affectedUserEmails{}',\
                'type' IN ("Data Loss Prevention"), 'data.ruleViolationInfo.recipients{}',\
                'type' IN ("SSO profile added", "SSO profile updated", "SSO profile deleted"), 'data.actorEmail',\
                'type' IN ("Super admin password reset"), 'data.superAdminPasswordResetEvent.userEmail',\
                'type' IN ("Primary admin changed"), 'data.primaryAdminChangedEvent.updatedAdminEmail',\
                'type' IN ("Activity Rule"), None \
                )
EVAL-user_name = case('type' IN ("SSO profile added", "SSO profile updated", "SSO profile deleted"), 'data.actorEmail')


[gws:users:identity]
KV_MODE = json
SHOULD_LINEMERGE = false
DATETIME_CONFIG = NONE
TRUNCATE = 9999999

EXTRACT-gws_user_bunit = \"organizations":.*?{.*?"department":\s*"(?<bunit>([^"]+)).*?\}
EXTRACT-gws_user_email = \"emails":.*?{.*?"address":\s*"(?<email>([^"]+)).*?\}

FIELDALIAS-gws_user_email_identity = email as identity
FIELDALIAS-gws_user_first = name.givenName as first
FIELDALIAS-gws_user_last = name.familyName as last
FIELDALIAS-gws_user_phones = phones{}.value as phone
FIELDALIAS-gws_user_relations = relations{}.value as managedBy

[gws:usage_reports:customer]
KV_MODE = json
SHOULD_LINEMERGE = false
DATETIME_CONFIG = NONE
TRUNCATE = 9999999

[gws:usage_reports:user]
KV_MODE = json
SHOULD_LINEMERGE = false
DATETIME_CONFIG = NONE
TRUNCATE = 9999999

[gws:usage_reports:entity]
KV_MODE = json
SHOULD_LINEMERGE = false
DATETIME_CONFIG = NONE
TRUNCATE = 9999999

[gws:reports:access_transparency]
KV_MODE = json
SHOULD_LINEMERGE = false
DATETIME_CONFIG = NONE
TRUNCATE = 9999999
