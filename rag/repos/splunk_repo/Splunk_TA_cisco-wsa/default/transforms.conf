##
## SPDX-FileCopyrightText: 2024 Splunk, Inc.
## SPDX-License-Identifier: LicenseRef-Splunk-8-2021
##
##

####### Lookup definitions #######

[cisco_wsa_traffic_action_lookup]
filename = cisco_wsa_traffic_action_lookup_500.csv

[cisco_wsa_proxy_action_lookup]
filename = cisco_wsa_proxy_action_lookup_500.csv

###### L4TM logs ######

[kv_for_cisco_wsa_Firewall_l4tm]
REGEX = [A-Za-z]* [A-Za-z]* [0-9]* [0-9:]* [0-9]* [A-Za-z]*: Firewall ([A-Za-z]*) ([A-Z]+).* data from \[{0,1}([0-9\.]+|[0-9a-z.:]*)\]{0,1}[:]{0,1}([0-9a-z]*) to \[{0,1}([0-9\.]+|[0-9a-z.:]*)\]{0,1}\({0,1}([A-Za-z0-9 \-\_\.]*)\){0,1}:{0,1}([0-9]*)\.
FORMAT = vendor_action::$1 transport::$2 src::$3 src_port::$4 dest::$5 dest_domain::$6 dest_port::$7

[kv_for_cisco_wsa_Address_l4tm]
REGEX = [A-Za-z]* [A-Za-z]* [0-9]* [0-9:]* [0-9]* [A-Za-z]*: Address ([0-9a-zA-Z.:]*) [A-Za-z]* [A-Za-z]* ([A-Za-z0-9.\_\-]*) \([A-Za-z0-9 .\_\-]*\){0,1} [A-Za-z]* [A-Za-z]* firewall ([A-Za-z ]*)
FORMAT = dest::$1 dest_domain::$2 vendor_action::$3

[kv_for_cisco_wsa_removed_l4tm]
REGEX = [A-Za-z]* [A-Za-z]* [0-9]* [0-9:]* [0-9]* [A-Za-z]*: Address ([0-9a-zA-Z.:]*) [A-Za-z]* ([A-Za-z0-9.\-\_]*) \([A-Za-z0-9 .\-\_]*\){0,1} ([A-Za-z]*) [A-Za-z ]*
FORMAT = dest::$1 dest_domain::$2 vendor_action::$3

[kv_for_cisco_wsa_Firewall_l4tm_timezone]
REGEX = [0-9]* [A-Za-z]* [0-9]* [0-9:]* \([0-9A-Z\-\s\+\:]*\) [A-Za-z]*: Firewall ([A-Za-z]*) ([A-Z]+).* data from \[{0,1}([0-9\.]+|[0-9a-z.:]*)\]{0,1}[:]{0,1}([0-9a-z]*) to \[{0,1}([0-9\.]+|[0-9a-z.:]*)\]{0,1}\({0,1}([A-Za-z0-9 \-\_\.]*)\){0,1}:{0,1}([0-9]*)\.
FORMAT = vendor_action::$1 transport::$2 src::$3 src_port::$4 dest::$5 dest_domain::$6 dest_port::$7

[kv_for_cisco_wsa_Address_l4tm_timezone]
REGEX = [0-9]* [A-Za-z]* [0-9]* [0-9:]* \([A-Z0-9\-\s\+\:]*\) [A-Za-z]*: Address ([0-9a-zA-Z.:]*) [A-Za-z]* [A-Za-z]* ([A-Za-z0-9.\_\-]*) \([A-Za-z0-9 .\_\-]*\){0,1} [A-Za-z]* [A-Za-z]* firewall ([A-Za-z ]*)
FORMAT = dest::$1 dest_domain::$2 vendor_action::$3

[kv_for_cisco_wsa_removed_l4tm_timezone]
REGEX = [0-9]* [A-Za-z]* [0-9]* [0-9:]* \([A-Z0-9\-\s\+\:]*\) [A-Za-z]*: Address ([0-9a-zA-Z.:]*) [A-Za-z]* ([A-Za-z0-9.\-\_]*) \([A-Za-z0-9 .\-\_]*\){0,1} ([A-Za-z]*) [A-Za-z ]*
FORMAT = dest::$1 dest_domain::$2 vendor_action::$3


######## W3C Logs ########

# Drops log file header lines
[drop_log_file_header_lines]
REGEX = ^#
DEST_KEY = queue
FORMAT = nullQueue


#######################################################################################
# Common transforms
#######################################################################################

[common_delim_s_hierarchy_hostname]
SOURCE_KEY=s_hierarchy_hostname
DELIMS = "/"
FIELDS = s_hierarchy, s_hostname

[common_delim_x_resultcode_httpstatus]
SOURCE_KEY=x_resultcode_httpstatus
DELIMS = "/"
FIELDS = sc_result_code,sc_http_status

[common_regex_referer_domain]
SOURCE_KEY=cs_Referer
REGEX=^(?:\w+:\/\/(?:(?:(?:\d+\.\d+\.\d+\.\d+)(?:[\/\:]|$))|(?:(?<cs_Referer_domain>[^\/:]+)(?:[\/\:]|$))))

[common_regex_url_domain]
SOURCE_KEY=cs_url
REGEX=^(?:\w+:\/\/(?:(?:(?:\d+\.\d+\.\d+\.\d+)(?:[\/\:]|$))|(?:(?<cs_url_domain>[^\/:]+)(?:[\/\:]|$))))

[common_regex_acltag_decision]
SOURCE_KEY=x_acltag
REGEX=^(?<x_acltag_decision>[a-zA-Z]+(?:_[a-zA-Z]+)*)(?:_\d+)?(?:-.+)+$

[common_regex_trim_scan_verdict_info]
SOURCE_KEY=scan_verdict_info
REGEX=<(?<scan_verdict_info_trimmed>[^>]+)>

[common_regex_dest_port]
SOURCE_KEY=cs_url
REGEX=(?:\w+:\/\/)?((?:\[\S+\])|(?:[^\/:\s]+)):?(?<dest_port>[0-9]{1,5})?

#############################################################################################################
# WSA version specific delimenter based extractions (cisco:wsa:squid, cisco:wsa:squid:new, cisco:wsa:w3c)
# To configure field extractions for W3C log formats follow the instructions provided in Installation and
# Configuration section in http://docs.splunk.com/Documentation/AddOns/latest/CiscoWSA
#############################################################################################################

## Cisco WSA 14.5

[cisco_wsa_14_5_delim_squid]
DELIMS = " "
FIELDS = timestamp,x_elapsed_time,c_ip,x_resultcode_httpstatus,sc_bytes,cs_method,cs_url,cs_username,s_hierarchy_hostname,cs_mime_type,x_acltag,scan_verdict_info,x_suspect_user_agent_block,x_suspect_user_agent_monitor,cs_Referer,cs_uri,cs_X_Forwarded_For,c_port,s_computerName,s_port,cs_version,x_resp_dvs_threat_name,x_resp_dvs_scanverdict,x_resp_dvs_verdictname,x_req_dvs_scanverdict,cs_User_Agent,cs_bytes

[cisco_wsa_14_5_delim_w3c]
DELIMS = " "
FIELDS = timestamp,x_elapsed_time,cs_Referer,c_ip,x_resultcode_httpstatus,sc_bytes,cs_method,cs_url,s_hostname,cs_uri,cs_username,cs_mime_type,x_acltag,cs_X_Forwarded_For,c_port,s_computerName,s_port,cs_version,x_webcat_code_abbr,x_wbrs_score,x_webroot_scanverdict,x_webroot_threat_name,x_webroot_trr,x_webroot_spyid,x_webroot_trace_id,x_mcafee_scanverdict,x_mcafee_filename,x_mcafee_av_scanerror,x_mcafee_av_detecttype,x_mcafee_av_virustype,x_mcafee_virus_name,x_sophos_scanverdict,x_sophos_scanerror,x_sophos_file_name,x_sophos_virus_name,x_ids_verdict,x_icap_verdict,x_webcat_req_code_abbr,x_webcat_resp_code_abbr,x_wbrs_threat_type,x_avc_app,x_avc_type,x_avc_behavior,x_request_rewrite,x_avg_bw,x_bw_throttled,user_type,x_resp_dvs_threat_name,x_resp_dvs_scanverdict,x_resp_dvs_verdictname,x_req_dvs_threat_name,x_req_dvs_scanverdict,x_req_dvs_verdictname,x_amp_verdict,x_amp_malware_name,x_amp_score,x_amp_upload_indicator,x_amp_filename,x_amp_sha,cs_User_Agent,cs_bytes

[cisco_wsa_14_5_delim_scan_verdict_info]
SOURCE_KEY=scan_verdict_info_trimmed
DELIMS = ","
FIELDS = x_webcat_code_abbr,x_wbrs_score,x_webroot_scanverdict,x_webroot_threat_name,x_webroot_trr,x_webroot_spyid,x_webroot_trace_id,x_mcafee_scanverdict,x_mcafee_filename,x_mcafee_av_scanerror,x_mcafee_av_detecttype,x_mcafee_av_virustype,x_mcafee_virus_name,x_sophos_scanverdict,x_sophos_scanerror,x_sophos_file_name,x_sophos_virus_name,x_ids_verdict,x_icap_verdict,x_webcat_req_code_abbr,x_webcat_resp_code_abbr,x_resp_dvs_verdictname,x_wbrs_threat_type,google_translate_enc_url,x_avc_app,x_avc_type,x_avc_behavior,x_request_rewrite,x_avg_bw,x_bw_throttled,user_type,x_req_dvs_verdictname,x_req_dvs_threat_name,x_amp_verdict,x_amp_malware_name,x_amp_score,x_amp_upload_indicator,x_amp_filename,x_amp_sha,ext_archivescan_blockedfiletype,ext_archivescan_verdict,ext_archivescan_threatdetail,ext_wtt_behavior,ext_youtube_url_category

## Cisco WSA latest (14.5)

[cisco_wsa_latest_delim_squid]
DELIMS = " "
FIELDS = timestamp,x_elapsed_time,c_ip,x_resultcode_httpstatus,sc_bytes,cs_method,cs_url,cs_username,s_hierarchy_hostname,cs_mime_type,x_acltag,scan_verdict_info,x_suspect_user_agent_block,x_suspect_user_agent_monitor,cs_Referer,cs_uri,cs_X_Forwarded_For,c_port,s_computerName,s_port,cs_version,x_resp_dvs_threat_name,x_resp_dvs_scanverdict,x_resp_dvs_verdictname,x_req_dvs_scanverdict,cs_User_Agent,cs_bytes

[cisco_wsa_latest_delim_w3c]
DELIMS = " "
FIELDS = timestamp,x_elapsed_time,cs_Referer,c_ip,x_resultcode_httpstatus,sc_bytes,cs_method,cs_url,s_hostname,cs_uri,cs_username,cs_mime_type,x_acltag,cs_X_Forwarded_For,c_port,s_computerName,s_port,cs_version,x_webcat_code_abbr,x_wbrs_score,x_webroot_scanverdict,x_webroot_threat_name,x_webroot_trr,x_webroot_spyid,x_webroot_trace_id,x_mcafee_scanverdict,x_mcafee_filename,x_mcafee_av_scanerror,x_mcafee_av_detecttype,x_mcafee_av_virustype,x_mcafee_virus_name,x_sophos_scanverdict,x_sophos_scanerror,x_sophos_file_name,x_sophos_virus_name,x_ids_verdict,x_icap_verdict,x_webcat_req_code_abbr,x_webcat_resp_code_abbr,x_wbrs_threat_type,x_avc_app,x_avc_type,x_avc_behavior,x_request_rewrite,x_avg_bw,x_bw_throttled,user_type,x_resp_dvs_threat_name,x_resp_dvs_scanverdict,x_resp_dvs_verdictname,x_req_dvs_threat_name,x_req_dvs_scanverdict,x_req_dvs_verdictname,x_amp_verdict,x_amp_malware_name,x_amp_score,x_amp_upload_indicator,x_amp_filename,x_amp_sha,cs_User_Agent,cs_bytes

[cisco_wsa_latest_delim_scan_verdict_info]
SOURCE_KEY=scan_verdict_info_trimmed
DELIMS = ","
FIELDS = x_webcat_code_abbr,x_wbrs_score,x_webroot_scanverdict,x_webroot_threat_name,x_webroot_trr,x_webroot_spyid,x_webroot_trace_id,x_mcafee_scanverdict,x_mcafee_filename,x_mcafee_av_scanerror,x_mcafee_av_detecttype,x_mcafee_av_virustype,x_mcafee_virus_name,x_sophos_scanverdict,x_sophos_scanerror,x_sophos_file_name,x_sophos_virus_name,x_ids_verdict,x_icap_verdict,x_webcat_req_code_abbr,x_webcat_resp_code_abbr,x_resp_dvs_verdictname,x_wbrs_threat_type,google_translate_enc_url,x_avc_app,x_avc_type,x_avc_behavior,x_request_rewrite,x_avg_bw,x_bw_throttled,user_type,x_req_dvs_verdictname,x_req_dvs_threat_name,x_amp_verdict,x_amp_malware_name,x_amp_score,x_amp_upload_indicator,x_amp_filename,x_amp_sha,ext_archivescan_blockedfiletype,ext_archivescan_verdict,ext_archivescan_threatdetail,ext_wtt_behavior,ext_youtube_url_category

#############################################################################################################
# Key-Value regex extractions for cisco:wsa:w3c:recommended
#############################################################################################################

[kv_regex_timestamp]
REGEX = (?:timestamp:\s+(?<timestamp>(?!-)\S+))

[kv_regex_x_elapsed_time]
REGEX = (?:x-elapsed-time:\s+(?<x_elapsed_time>(?!-)\S+))

[kv_regex_cs_Referer]
REGEX = (?:cs\(Referer\):\s+"(?<cs_Referer>(?!-)[^"]+)")

[kv_regex_c_ip]
REGEX = (?:c-ip:\s+(?<c_ip>(?!-)\S+))

[kv_regex_sc_result_code]
REGEX = (?:sc-result-code:\s+(?<sc_result_code>(?!-)\S+))

[kv_regex_sc_http_status]
REGEX = (?:sc-http-status:\s+(?<sc_http_status>(?!-)\S+))

[kv_regex_sc_bytes]
REGEX = (?:sc-bytes:\s+(?<sc_bytes>(?!-)\S+))

[kv_regex_cs_method]
REGEX = (?:cs-method:\s+(?<cs_method>(?!-)\S+))

[kv_regex_cs_url]
REGEX = (?:cs-url:\s+(?<cs_url>(?!-)\S+))

[kv_regex_s_hostname]
REGEX = (?:s-hostname:\s+(?<s_hostname>(?!-)\S+))

[kv_regex_cs_uri]
REGEX = (?:cs-uri:\s+(?<cs_uri>(?!-)\S+))

[kv_regex_cs_username]
REGEX = (?:cs-username:\s+(?<cs_username>(?!-)\S+))

[kv_regex_cs_mime_type]
REGEX = (?:cs-mime-type:\s+(?<cs_mime_type>(?!-)\S+))

[kv_regex_x_acltag]
REGEX = (?:x-acltag:\s+(?<x_acltag>(?!-)\S+))

[kv_regex_cs_X_Forwarded_For]
REGEX = (?:cs\(X-Forwarded-For\):\s+(?<cs_X_Forwarded_For>(?!-)\S+))

[kv_regex_c_port]
REGEX = (?:c-port:\s+(?<c_port>(?!-)\S+))

[kv_regex_s_computerName]
REGEX = (?:s-computerName:\s+(?<s_computerName>(?!-)\S+))

[kv_regex_s_port]
REGEX = (?:s-port:\s+(?<s_port>(?!-)\S+))

[kv_regex_cs_version]
REGEX = (?:cs-version:\s+(?<cs_version>(?!-)\S+))

[kv_regex_x_webcat_code_abbr]
REGEX = (?:x-webcat-code-abbr:\s+(?<x_webcat_code_abbr>(?!-)\S+))

[kv_regex_x_wbrs_score]
REGEX = (?:x-wbrs-score:\s+(?<x_wbrs_score>ns|nc|-?\d+(?:\.\d+)?))

[kv_regex_x_webroot_scanverdict]
REGEX = (?:x-webroot-scanverdict:\s+(?<x_webroot_scanverdict>(?!-)\S+))

[kv_regex_x_webroot_threat_name]
REGEX = (?:x-webroot-threat-name:\s+(?!-)(?!"-")(?<x_webroot_threat_name>[^"]\S+|"(?:(?:\\")*[^"]+(?:\\")*)+[^\\]"))\s+

[kv_regex_x_webroot_trr]
REGEX = (?:x-webroot-trr:\s+"(?<x_webroot_trr>(?!-)[^"]+)")

[kv_regex_x_webroot_spyid]
REGEX = (?:x-webroot-spyid:\s+(?<x_webroot_spyid>(?!-)\S+))

[kv_regex_x_webroot_trace_id]
REGEX = (?:x-webroot-trace-id:\s+(?<x_webroot_trace_id>(?!-)\S+))

[kv_regex_x_mcafee_scanverdict]
REGEX = (?:x-mcafee-scanverdict:\s+(?<x_mcafee_scanverdict>(?!-)\S+))

[kv_regex_x_mcafee_filename]
REGEX = (?:x-mcafee-filename:\s+(?<x_mcafee_filename>(?!-)\S+))

[kv_regex_x_mcafee_av_scanerror]
REGEX = (?:x-mcafee-av-scanerror:\s+(?<x_mcafee_av_scanerror>(?!-)\S+))

[kv_regex_x_mcafee_av_detecttype]
REGEX = (?:x-mcafee-av-detecttype:\s+(?<x_mcafee_av_detecttype>(?!-)\S+))

[kv_regex_x_mcafee_av_virustype]
REGEX = (?:x-mcafee-av-virustype:\s+(?<x_mcafee_av_virustype>(?!-)\S+))

[kv_regex_x_mcafee_virus_name]
REGEX = (?:x-mcafee-virus-name:\s+(?<x_mcafee_virus_name>(?!-)\S+))

[kv_regex_x_sophos_scanverdict]
REGEX = (?:x-sophos-scanverdict:\s+(?<x_sophos_scanverdict>(?!-)\S+))

[kv_regex_x_sophos_scanerror]
REGEX = (?:x-sophos-scanerror:\s+(?<x_sophos_scanerror>(?!-)\S+))

[kv_regex_x_sophos_file_name]
REGEX = (?:x-sophos-file-name:\s+"(?<x_sophos_file_name>(?!-)[^"]+)")

[kv_regex_x_sophos_virus_name]
REGEX = (?:x-sophos-virus-name:\s+"(?<x_sophos_virus_name>(?!-)[^"]+)")

[kv_regex_x_ids_verdict]
REGEX = (?:x-ids-verdict:\s+(?<x_ids_verdict>(?!-)\S+))

[kv_regex_x_icap_verdict]
REGEX = (?:x-icap-verdict:\s+(?<x_icap_verdict>(?!-)\S+))

[kv_regex_x_webcat_req_code_abbr]
REGEX = (?:x-webcat-req-code-abbr:\s+(?<x_webcat_req_code_abbr>(?!-)\S+))

[kv_regex_x_webcat_resp_code_abbr]
REGEX = (?:x-webcat-resp-code-abbr:\s+(?<x_webcat_resp_code_abbr>(?!-)\S+))

[kv_regex_x_wbrs_threat_type]
REGEX = (?:x-wbrs-threat-type:\s+"(?<x_wbrs_threat_type>(?!-)[^"]+)")

[kv_regex_x_avc_app]
REGEX = (?:x-avc-app:\s+"(?<x_avc_app>(?!-)[^"]+)")

[kv_regex_x_avc_type]
REGEX = (?:x-avc-type:\s+"(?<x_avc_type>(?!-)[^"]+)")

[kv_regex_x_avc_behavior]
REGEX = (?:x-avc-behavior:\s+"(?<x_avc_behavior>(?!-)[^"]+)")

[kv_regex_x_request_rewrite]
REGEX = (?:x-request-rewrite:\s+(?<x_request_rewrite>(?!-)\S+))

[kv_regex_x_avg_bw]
REGEX = (?:x-avg-bw:\s+(?<x_avg_bw>(?!-)\S+))

[kv_regex_x_bw_throttled]
REGEX = (?:x-bw-throttled:\s+(?<x_bw_throttled>(?!-)\S+))

[kv_regex_user_type]
REGEX = (?:user-type:\s+(?<user_type>(?!-)\S+))

[kv_regex_x_resp_dvs_threat_name]
REGEX = (?:x-resp-dvs-threat-name:\s+"(?<x_resp_dvs_threat_name>(?!-)[^"]+)")

[kv_regex_x_resp_dvs_scanverdict]
REGEX = (?:x-resp-dvs-scanverdict:\s+(?<x_resp_dvs_scanverdict>(?!-)\S+))

[kv_regex_x_resp_dvs_verdictname]
REGEX = (?:x-resp-dvs-verdictname:\s+"(?<x_resp_dvs_verdictname>(?!-)[^"]+)")

[kv_regex_x_req_dvs_threat_name]
REGEX = (?:x-req-dvs-threat-name:\s+"(?<x_req_dvs_threat_name>(?!-)[^"]+)")

[kv_regex_x_req_dvs_scanverdict]
REGEX = (?:x-req-dvs-scanverdict:\s+(?<x_req_dvs_scanverdict>(?!-)\S+))

[kv_regex_x_req_dvs_verdictname]
REGEX = (?:x-req-dvs-verdictname:\s+"(?<x_req_dvs_verdictname>(?!-)[^"]+)")

[kv_regex_x_amp_verdict]
REGEX = (?:x-amp-verdict:\s+(?<x_amp_verdict>(?!-)\S+))

[kv_regex_x_amp_malware_name]
REGEX = (?:x-amp-malware-name:\s+(?<x_amp_malware_name>(?!-)\S+))

[kv_regex_x_amp_score]
REGEX = (?:x-amp-score:\s+(?<x_amp_score>(?!-)\S+))

[kv_regex_x_amp_upload_indicator]
REGEX = (?:x-amp-upload-indicator:\s+(?<x_amp_upload_indicator>(?!-)\S+))

[kv_regex_x_amp_filename]
REGEX = (?:x-amp-filename:\s+(?<x_amp_filename>(?!-)\S+))

[kv_regex_x_amp_sha]
REGEX = (?:x-amp-sha:\s+(?<x_amp_sha>(?!-)\S+))

[kv_regex_cs_User_Agent]
REGEX = (?:cs\(User-Agent\):\s+"(?<cs_User_Agent>(?!-)[^"]+)")

[kv_regex_cs_bytes]
REGEX = (?:cs-bytes:\s+(?<cs_bytes>(?!-)\S+))

[fields_for_cisco_wsa_syslog1]
# <38>Oct 30 11:33:02 wsa_host cli_logs: Info: PID 59591: User adminuser logged out from session because of inactivity timeout.
REGEX = (User\s+(\S+)\s+(?:\S+)\s+out\s+from\s+session\s+(?:.*))
FORMAT = result::$1 user::$2

[fields_for_cisco_wsa_syslog2]
# <38>Oct 30 03:37:34 wsa_host audit_logs: Info: Appliance: 1.1.1.1, Interaction Mode: GUI, User: adminuser, Source IP: 1.2.3.4, Destination IP: 1.1.1.1, Location: /commit, Event: Changes successfully committed
REGEX = Appliance:\s+(?:\S+|\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*(?:\.\d+\.\d+\.\d+)?)\,\s+Interaction\s+Mode\:\s+(?:\S+)\,\s+User\:\s+(\S+)\,\s+Source\s+IP\:\s+(\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*(?:\.\d+\.\d+\.\d+)?)\,\s+Destination\s+IP\:\s+(\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*(?:\.\d+\.\d+\.\d+)?)\,\s+Location\:\s+(\S+)\,\s+Event\:\s+((?:.*))
FORMAT = user::$1 src::$2 dest::$3 object_path::$4 description::$5

[fields_for_cisco_wsa_syslog3]
# <38>Oct 30 05:27:05 wsa_host audit_logs: Info: Appliance: wsa_host, Event: Configuration Changes, New Configuration File: S100V-4212352168F97ABA0623-CE687C7F73DE-20241030T052658-15.2.1-011.xml.audit_bkp, Old Configuration File: S100V-4212352168F97ABA0623-CE687C7F73DE-20241030T043609-15.2.1-011.xml.audit_bkp, Total Lines: 139
REGEX = Appliance\:\s+(?:\S+|\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*(?:\.\d+\.\d+\.\d+)?)\,\s+Event\:\s+(.*)\,\s+New\s+Configuration\s+File\:\s+(.*)\,\sOld\s+Configuration\s+File\:\s+(?:.*)\,\s+(Total\s+Lines\:\s+(?:\d+))
FORMAT = result::$1 object::$2 object_attrs::$3

[fields_for_cisco_wsa_syslog4]
# <38>Oct 30 05:26:57 wsa_host audit_logs: Info: The process trailblazer is starting at Wed Oct 30 05:26:57 2024
# <38>Oct 30 05:26:57 wsa_host audit_logs: Info: The process trailblazer exited successfully at Wed Oct 30 05:26:57 2024
REGEX = (The\s+process\s+(\S+)\s+(?:.*))\s+at\s+(?:.*)
FORMAT = result::$1 object::$2 change_type::"system"

[fields_for_cisco_wsa_syslog5]
# <38>Oct 30 05:26:55 wsa_host gui_logs: Info: req:1.2.3.4 user:adminuser 200 GET /mytasks_javascript_js?action=GetMapName&urldata=https%3A%2F%2F1.1.1.1%3A8080%2Fcommit&parms=&screen=commit&task_name=&task_description=&CSRFKey=6194157b-102d-25a0-cbf4-c9993a34c62b HTTP/1.1 Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36
REGEX = req\:(\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*(?:\.\d+\.\d+\.\d+)?)\s+user\:(\S+)\s+(\d+)\s+(\S+)\s+((.*)\?(\S*))\s+\S+\s+(.*)
FORMAT = src::$1 user::$2 status::$3 http_method::$4 gui_logs_url::$5 uri_path::$6 uri_query::$7 http_user_agent::$8 action::"request"

[ip_port_from_urldata]
SOURCE_KEY = gui_logs_url
REGEX = (?:https?%3A%2F%2F(?:%5B)?(?<urldata_dest>.+?)(?:%5D)?(?:%3A(?<dest_port>\d+))?%2F)
