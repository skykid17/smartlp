##
## SPDX-FileCopyrightText: 2020 Splunk, Inc. <sales@splunk.com>
## SPDX-License-Identifier: LicenseRef-Splunk-8-2021
##
##

[bluecoat_proxy_action_lookup]
filename = bluecoat_proxy_actions.csv
case_sensitive_match = false

## Automatic kv
[auto_kv_for_bluecoat_v5_3_3]
REGEX = (?:"([^"]+)"|(\S+))\s+(?:"(\d{1,2}:\d{1,2}:\d{1,2})"|(\d{1,2}:\d{1,2}:\d{1,2}))\s+(?:"(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"|(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))\s+(?:"(\d+)"|(\d+))\s+(?:"(\d+)"|(\d+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s*$
FORMAT = date::$1 date::$2 time::$3 time::$4 c_ip::$5 c_ip::$6 sc_bytes::$7 sc_bytes::$8 time_taken::$9 time_taken::$10 s_action::$11 s_action::$12 sc_status::$13 sc_status::$14 rs_status::$15 rs_status::$16 rs_bytes::$17 rs_bytes::$18 cs_bytes::$19 cs_bytes::$20 cs_auth_type::$21 cs_auth_type::$22 cs_username::$23 cs_username::$24 sc_filter_result::$25 sc_filter_result::$26 cs_method::$27 cs_method::$28 cs_host::$29 cs_host::$30 cs_version::$31 cs_version::$32 sr_bytes::$33 sr_bytes::$34 cs_uri::$35 cs_uri::$36 cs_Referer::$37 cs_Referer::$38 rs_Content_Type::$39 rs_Content_Type::$40 cs_User_Agent::$41 cs_User_Agent::$42 cs_Cookie::$43 cs_Cookie::$44

# Supports Bluecoat 6.5.x field format
[auto_kv_for_bluecoat_v6_5_x]
REGEX = (?:"([^"]+)"|(\S+))\s+(?:"(\d{1,2}:\d{1,2}:\d{1,2})"|(\d{1,2}:\d{1,2}:\d{1,2}))\s+(?:"(\d+)"|(\d+))\s+(?:"(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"|(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s*$
FORMAT = date::$1 date::$2 time::$3 time::$4 time_taken::$5 time_taken::$6 c_ip::$7 c_ip::$8 cs_username::$9 cs_username::$10 cs_auth_group::$11 cs_auth_group::$12 x_exception_id::$13 x_exception_id::$14 sc_filter_result::$15 sc_filter_result::$16 cs_categories::$17 cs_categories::$18 cs_Referer::$19 cs_Referer::$20 sc_status::$21 sc_status::$22 s_action::$23 s_action::$24 cs_method::$25 cs_method::$26 rs_Content_Type::$27 rs_Content_Type::$28 cs_uri_scheme::$29 cs_uri_scheme::$30 cs_host::$31 cs_host::$32 cs_uri_port::$33 cs_uri_port::$34 cs_uri_path::$35 cs_uri_path::$36 cs_uri_query::$37 cs_uri_query::$38 cs_uri_extension::$39 cs_uri_extension::$40 cs_User_Agent::$41 cs_User_Agent::$42 s_ip::$43 s_ip::$44 sc_bytes::$45 sc_bytes::$46 cs_bytes::$47 cs_bytes::$48 x_virus_id::$49 x_virus_id::$50 x_bluecoat_application_name::$51 x_bluecoat_application_name::$52 x_bluecoat_application_operation::$53 x_bluecoat_application_operation::$54

# Supports Bluecoat 6.6.3.2 and 6.6.4.2 field format
[auto_kv_for_bluecoat_v6_6_x]
REGEX = ^(?:"([^"]+)"|(\S+))\s+(?:"(\d{1,2}:\d{1,2}:\d{1,2})"|(\d{1,2}:\d{1,2}:\d{1,2}))\s+(?:"(\d+)"|(\d+))\s+(?:"(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"|(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s+(?:"([^"]+)"|(\S+))\s*(?:"([^"]+)"|(\S+))?\s*(?:"([^"]+)"|(\S+))?\s*(?:"([^"]+)"|(\S+))?\s*$
FORMAT = date::$1 date::$2 time::$3 time::$4 time_taken::$5 time_taken::$6 c_ip::$7 c_ip::$8 cs_username::$9 cs_username::$10 cs_auth_group::$11 cs_auth_group::$12 s_supplier_name::$13 s_supplier_name::$14 s_supplier_ip::$15 s_supplier_ip::$16 s_supplier_country::$17 s_supplier_country::$18 s_supplier_failures::$19 s_supplier_failures::$20 x_exception_id::$21 x_exception_id::$22 sc_filter_result::$23 sc_filter_result::$24 cs_categories::$25 cs_categories::$26 cs_Referer::$27 cs_Referer::$28 sc_status::$29 sc_status::$30 s_action::$31 s_action::$32 cs_method::$33 cs_method::$34 rs_Content_Type::$35 rs_Content_Type::$36 cs_uri_scheme::$37 cs_uri_scheme::$38 cs_host::$39 cs_host::$40 cs_uri_port::$41 cs_uri_port::$42 cs_uri_path::$43 cs_uri_path::$44 cs_uri_query::$45 cs_uri_query::$46 cs_uri_extension::$47 cs_uri_extension::$48 cs_User_Agent::$49 cs_User_Agent::$50 s_ip::$51 s_ip::$52 sc_bytes::$53 sc_bytes::$54 cs_bytes::$55 cs_bytes::$56 x_virus_id::$57 x_virus_id::$58 x_bluecoat_application_name::$59 x_bluecoat_application_name::$60 x_bluecoat_application_operation::$61 x_bluecoat_application_operation::$62 cs_threat_risk::$63 cs_threat_risk::$64 x_bluecoat_transaction_uuid::$65 x_bluecoat_transaction_uuid::$66 x_icap_reqmod_header::$67 x_icap_reqmod_header::$68 x_icap_respmod_header::$69 x_icap_respmod_header::$70

[auto_kv_for_bluecoat_v6_7_x]
REGEX = ^(?|"(?<date>[^"]+)"|(?<date>\S+))\s+(?|"(?<time>\d{1,2}:\d{1,2}:\d{1,2})"|(?<time>\d{1,2}:\d{1,2}:\d{1,2}))\s+(?|"(?<time_taken>\d+)"|(?<time_taken>\d+))\s+(?|"(?<c_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"|(?<c_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))\s+(?|"(?<cs_username>[^"]+)"|(?<cs_username>\S+))\s+(?|"(?<cs_auth_group>[^"]+)"|(?<cs_auth_group>\S+))\s+(?|"(?<s_supplier_name>[^"]+)"|(?<s_supplier_name>\S+))\s+(?|"(?<s_supplier_ip>[^"]+)"|(?<s_supplier_ip>\S+))\s+(?|"(?<s_supplier_country>[^"]+)"|(?<s_supplier_country>\S+))\s+(?:"([^"]+)"|(?<s_supplier_failures>\S+))\s+(?:"([^"]+)"|(?<x_exception_id>\S+))\s+(?:"([^"]+)"|(?<sc_filter_result>\S+))\s+(?|"(?<cs_categories>[^"]+)"|(?<cs_categories>\S+))\s+(?|"(?<cs_Referer>[^"]+)"|(?<cs_Referer>\S+))\s+(?|"(?<sc_status>[^"]+)"|(?<sc_status>\S+))\s+(?|"(?<s_action>[^"]+)"|(?<s_action>\S+))\s+(?|"(?<cs_method>[^"]+)"|(?<cs_method>\S+))\s+(?|"(?<rs_Content_Type>[^"]+)"|(?<rs_Content_Type>\S+))\s+(?|"(?<cs_uri_scheme>[^"]+)"|(?<cs_uri_scheme>\S+))\s+(?|"(?<cs_host>[^"]+)"|(?<cs_host>\S+))\s+(?|"(?<cs_uri_port>[^"]+)"|(?<cs_uri_port>\S+))\s+(?|"(?<cs_uri_path>[^"]+)"|(?<cs_uri_path>\S+))\s+(?|"(?<cs_uri_query>[^"]+)"|(?<cs_uri_query>\S+))\s+(?|"(?<cs_uri_extension>[^"]+)"|(?<cs_uri_extension>\S+))\s+(?|"(?<cs_User_Agent>[^"]+)"|(?<cs_User_Agent>\S+))\s+(?|"(?<s_ip>[^"]+)"|(?<s_ip>\S+))\s+(?|"(?<sc_bytes>[^"]+)"|(?<sc_bytes>\S+))\s+(?|"(?<cs_bytes>[^"]+)"|(?<cs_bytes>\S+))\s+(?|"(?<x_virus_id>[^"]+)"|(?<x_virus_id>\S+))\s+(?|"(?<x_bluecoat_application_name>[^"]+)"|(?<x_bluecoat_application_name>\S+))\s+(?|"(?<x_bluecoat_application_operation>[^"]+)"|(?<x_bluecoat_application_operation>\S+))\s+(?|"(?<x_bluecoat_application_groups>[^"]+)"|(?<x_bluecoat_application_groups>\S+))\s+(?|"(?<cs_threat_risk>[^"]+)"|(?<cs_threat_risk>\S+))\s+(?|"(?<x_bluecoat_transaction_uuid>[^"]+)"|(?<x_bluecoat_transaction_uuid>\S+))\s+(?|"(?<x_icap_reqmod_header>[^"]+)"|(?<x_icap_reqmod_header>\S+))\s+(?|"(?<x_icap_respmod_header>[^"]+)"|(?<x_icap_respmod_header>\S+))\s*$

# Supports Bluecoat version 7.3.x field format
[auto_kv_for_bluecoat_v7_3_x]
REGEX = ^(?|"(?<date>[^"]+)"|(?<date>\S+))\s+(?|"(?<time>\d{1,2}:\d{1,2}:\d{1,2})"|(?<time>\d{1,2}:\d{1,2}:\d{1,2}))\s+(?|"(?<time_taken>\d+)"|(?<time_taken>\d+))\s+(?|"(?<c_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"|(?<c_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))\s+(?|"(?<cs_username>[^"]+)"|(?<cs_username>\S+))\s+(?|"(?<cs_auth_group>[^"]+)"|(?<cs_auth_group>\S+))\s+(?|"(?<s_supplier_name>[^"]+)"|(?<s_supplier_name>\S+))\s+(?|"(?<s_supplier_ip>[^"]+)"|(?<s_supplier_ip>\S+))\s+(?|"(?<s_supplier_country>[^"]+)"|(?<s_supplier_country>\S+))\s+(?:"([^"]+)"|(?<s_supplier_failures>\S+))\s+(?:"([^"]+)"|(?<x_exception_id>\S+))\s+(?:"([^"]+)"|(?<sc_filter_result>\S+))\s+(?|"(?<cs_categories>[^"]+)"|(?<cs_categories>\S+))\s+(?|"(?<cs_Referer>[^"]+)"|(?<cs_Referer>\S+))\s+(?|"(?<sc_status>[^"]+)"|(?<sc_status>\S+))\s+(?|"(?<s_action>[^"]+)"|(?<s_action>\S+))\s+(?|"(?<cs_method>[^"]+)"|(?<cs_method>\S+))\s+(?|"(?<rs_Content_Type>[^"]+)"|(?<rs_Content_Type>\S+))\s+(?|"(?<cs_uri_scheme>[^"]+)"|(?<cs_uri_scheme>\S+))\s+(?|"(?<cs_host>[^"]+)"|(?<cs_host>\S+))\s+(?|"(?<cs_uri_port>[^"]+)"|(?<cs_uri_port>\S+))\s+(?|"(?<cs_uri_path>[^"]+)"|(?<cs_uri_path>\S+))\s+(?|"(?<cs_uri_query>[^"]+)"|(?<cs_uri_query>\S+))\s+(?|"(?<cs_uri_extension>[^"]+)"|(?<cs_uri_extension>\S+))\s+(?|"(?<cs_User_Agent>[^"]+)"|(?<cs_User_Agent>\S+))\s+(?|"(?<s_ip>[^"]+)"|(?<s_ip>\S+))\s+(?|"(?<sc_bytes>[^"]+)"|(?<sc_bytes>\S+))\s+(?|"(?<cs_bytes>[^"]+)"|(?<cs_bytes>\S+))\s+(?|"(?<x_virus_id>[^"]+)"|(?<x_virus_id>\S+))\s+(?|"(?<x_bluecoat_application_name>[^"]+)"|(?<x_bluecoat_application_name>\S+))\s+(?|"(?<x_bluecoat_application_operation>[^"]+)"|(?<x_bluecoat_application_operation>\S+))\s+(?|"(?<x_bluecoat_application_groups>[^"]+)"|(?<x_bluecoat_application_groups>\S+))\s+(?|"(?<cs_threat_risk>[^"]+)"|(?<cs_threat_risk>\S+))\s+(?|"(?<x_access_security_policy_action>[^"]+)"|(?<x_access_security_policy_action>\S+))\s+(?|"(?<x_access_security_policy_reason>[^"]+)"|(?<x_access_security_policy_reason>\S+))\s+(?|"(?<x_bluecoat_transaction_uuid>[^"]+)"|(?<x_bluecoat_transaction_uuid>\S+))\s+(?|"(?<x_icap_reqmod_header>[^"]+)"|(?<x_icap_reqmod_header>\S+))\s+(?|"(?<x_icap_respmod_header>[^"]+)"|(?<x_icap_respmod_header>\S+))\s*$

[bluecoat_vendor_categories]
SOURCE_KEY = cs_categories
REGEX = (?<vendor_categories>[^;]+)
MV_ADD = true

[bluecoat_header]
REGEX = ^(#)
FORMAT = bluecoat_header::$1

[TrashHeaders]
REGEX = ^#
DEST_KEY = queue
FORMAT = nullQueue

#If the new format is incorrectly typed correct
[set_sourcetype_bluecoat]
REGEX = ^SPLV\d+(?:\.\d+)?
FORMAT = sourcetype::bluecoat:proxysg:access:kv
DEST_KEY = MetaData:Sourcetype

[http_referrer_domain]
SOURCE_KEY = cs_Referer
REGEX=^(?:[^:]+:\/\/)?(?!(?:\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S+:\/\/))([^:\/]+)
FORMAT = http_referrer_domain::$1
