##
## SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>
## SPDX-License-Identifier: LicenseRef-Splunk-8-2021
##
##

[oracle:audit:xml]
search = sourcetype=oracle:audit:xml src != "" dest != "" (NOT SQLTEXT="CONNECT") (NOT ACTION IN (108, 51, 53, 67, 100, 101, 43, 65, 66))
#tags = database

[oracle:connect]
search = sourcetype=oracle:listener:* CLIENTIP != ""

[oracle:auth]
search = (sourcetype=oracle:audit:unified ACTION_NAME="LOGON") OR (sourcetype=oracle:audit:text ACTION_NUMBER=100) OR (sourcetype=oracle:audit:xml (SQLTEXT="CONNECT" OR ACTION=100))
#tags = authentication

[oracle:accountManagement]
search = (sourcetype=oracle:audit:text (object=* OR ACTION_NUMBER IN (17, 51, 53, 67))) OR (sourcetype=oracle:audit:unified ACTION_NAME!="LOGON") OR (sourcetype=oracle:audit:xml ACTION IN (108, 51, 53, 67, 101, 43, 65, 66))
#tags = account, change

[oracle:database]
search = sourcetype=oracle:database OR (sourcetype=oracle:audit:text NOT(object=*) NOT(ACTION_NUMBER=*))
#tags = database

[oracle:traceError]
search = sourcetype=oracle:trace (error OR err OR ORA-)

[oracle:listenerError]
search = sourcetype=oracle:listener:* (TNS- OR error OR ORA-)

[oracle:alertError]
search = sourcetype=oracle:alert:* (error OR "err code" OR ORA-)

[oracle:oraError]
search = (sourcetype=oracle:listener:* OR sourcetype=oracle:alert:* OR sourcetype=oracle:trace) ORACODE != ""

[oracle:blockCorrupted]
search = (sourcetype=oracle:trace OR sourcetype=oracle:alert:*) ORACODE="ORA-01578"

[oracle:deadLock]
search = (sourcetype=oracle:trace OR sourcetype=oracle:alert:*) ORACODE="ORA-00060"

[oracle:maxSessionExceeded]
search = (sourcetype=oracle:trace OR sourcetype=oracle:alert:*) ORACODE="ORA-00018"

[oracle:maxProcessExceeded]
search = (sourcetype=oracle:trace OR sourcetype=oracle:alert:*) ORACODE="ORA-00020"

[oracle:internalError]
search = (sourcetype=oracle:trace OR sourcetype=oracle:alert:*) ORACODE="ORA-00600"

[oracle:instance]
search = sourcetype=oracle:instance
#tags = database, instance

[oracle:sga]
search = sourcetype=oracle:sga
#tags = database

[oracle:tablespaceMetrics]
search = sourcetype=oracle:tablespaceMetrics
#tags = database, query, tablespace

[oracle:session]
search = sourcetype=oracle:session
#tags = database, instance, session

[oracle:instanceReadWrite]
search = sourcetype=oracle:sysPerf (METRIC_NAME="Physical Read Total IO Requests Per Sec" OR METRIC_NAME="Physical Write Total IO Requests Per Sec")
#tags = database, instance, stats

[oracle:avgExecutions]
search = sourcetype=oracle:sysPerf METRIC_NAME="Executions Per Sec"
#tags = database, instance, stats

[oracle:cpuLoadPerf]
search = sourcetype=oracle:sysPerf (METRIC_NAME="Host CPU Utilization (%)" OR METRIC_NAME="Database CPU Time Ratio")
#tags = database, instance, stats

[oracle:cpuTimePerf]
search = sourcetype=oracle:sysPerf (METRIC_NAME="Host CPU Usage Per Sec" OR METRIC_NAME="CPU Usage Per Sec" OR METRIC_NAME="CPU Usage Per Txn")
#tags = database, instance, stats

[oracle:memPerf]
search = sourcetype=oracle:sysPerf (METRIC_NAME="Total PGA Allocated" OR METRIC_NAME="Total PGA Used by SQL Workareas")
#tags = database, instance, stats

[oracle:networkPerf]
search = sourcetype=oracle:sysPerf METRIC_NAME="Network Traffic Volume Per Sec"
#tags = database, instance

[oracle:dbIoPerf]
search = sourcetype=oracle:sysPerf (METRIC_NAME="Physical Read*" OR METRIC_NAME="Physical Write*")
#tags = database, instance

[oracle:readwrite]
search = sourcetype=oracle:sysPerf (METRIC_NAME="Physical Read*" OR METRIC_NAME="Physical Write*")
#tags = database, instance

[oracle:dbFileIoPerf]
search = sourcetype=oracle:dbFileIoPerf

[oracle:libraryCachePerf]
search = sourcetype=oracle:libraryCachePerf

[oracle:connections]
search  = sourcetype=oracle:connections
#tags = database, instance

[oracle:pool:connections]
search  = sourcetype=oracle:pool:connections
#tags = database, instance

[oracle:sysPerf]
search = sourcetype=oracle:sysPerf
#tags = database, instance

[oracle:table]
search = sourcetype=oracle:table
#tags = database, instance

[oracle:user]
search = sourcetype=oracle:user
#tags = database, instance

[oracle:query]
search = sourcetype=oracle:query
#tags = database, query

[oracle:database:size]
search = sourcetype=oracle:database:size
#tags = database, instance

[oracle:sqlMonitor]
search = sourcetype=oracle:sqlMonitor
#tags = database, query, stats

[oracle:connections:poolStats]
search = sourcetype=oracle:connections:poolStats
#tags = database, instance, stats
