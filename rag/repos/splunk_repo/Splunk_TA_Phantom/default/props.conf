# Copyright (C) 2020 Splunk Inc. All Rights Reserved.
# DO NOT EDIT THIS FILE!
# Please make all changes to files in $SPLUNK_HOME/etc/apps/Splunk_TA_Phantom/local.
# To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/Splunk_TA_Phantom/default
# into ../local and edit there.
#

[phantom:daemon]
SHOULD_LINEMERGE = false
TIME_PREFIX = ^
TIME_FORMAT = %b %d %H:%M:%S
LINE_BREAKER = ([\r\n]+)\w+\s+\d+\s+\d{2}\:\d{2}\:\d{2}
TRUNCATE = 9999
MAX_TIMESTAMP_LOOKAHEAD = 25

EXTRACT-fields = ^(.*\s)(?P<daemon>\w+)\[(?P<process_id>\d+)[^\]\n]*\]:\s+\w+:(?P<thread_id>[^ ]+)[^:\n]*:\s+(?P<loglevel>\w+)[^:\n]*:\s+(?P<component>[^ ]+)\s+:\s+(?P<source_file>[^ ]+)\s+:\s+(?P<linenumber>[^ ]+)\s+:\s+(?P<message>.+)

# 2019-07-01 21:10:18,085
[phantom:supervisord]
SHOULD_LINEMERGE = false
TIME_PREFIX = ^
TIME_FORMAT = %Y-%m-%d %H:%M:%S,%3N
LINE_BREAKER = ([\r\n]+)\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2},\d{3}
TRUNCATE = 9999
MAX_TIMESTAMP_LOOKAHEAD = 30

#[pid: 6349|app: 0|req: 69/806] 192.168.134.1 () {50 vars in 949 bytes} [Tue Jul  2 18:56:31 2019]
#[phantom:wsgi]
#SHOULD_LINEMERGE = false
#TIME_PREFIX = \}\s\[
#TIME_FORMAT = %a %b %d %H:%M:%S %Y
#LINE_BREAKER = ([\r\n]+)\[pid
#TRUNCATE = 9999
#MAX_TIMESTAMP_LOOKAHEAD = 30

#< 2019-07-02 11:10:11.212 PDT >
[postgres]
SHOULD_LINEMERGE = false
TIME_PREFIX = \<
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%3N %Z
LINE_BREAKER = ([\r\n]+)<\s\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}\.\d{3}
TRUNCATE = 99999
MAX_TIMESTAMP_LOOKAHEAD = 30

EXTRACT-fields = ^[^>\n]*>(?P<type>\w+):\s+(?P<message>.+)

[phantom:daemon:ingestd]
EXTRACT-ipcwrite-fields = ^(.*\s)(?P<daemon>\w+)\[(?P<process_id>\d+)[^\]\n]*\]:\s+\w+:(?P<thread_id>[^ ]+)[^:\n]*:\s+(?P<loglevel>\w+)[^:\n]*:\s+(?P<component>[^ ]+)\s+:\s+(?P<source_file>[^ ]+)\s+:\s+(?P<linenumber>[^ ]+)\s+:\s+(?P<message>.+)
EXTRACT-ipcread-fields = ^(?:[^ \n]* ){4}(?P<daemon>[^\[]+)\[(?P<process_id>\d+)\]:\s+\w+:(?P<thread_id>[^ ]+)(?:[^ \n]* ){2}(?P<message_type>[^:]+):\s+(?P<message_subtype>\w+\s+\w+):\s+(?P<message_json>.+)

[phantom:logs]
EXTRACT-phantom-consul = ^[^\[\n]*\[(?P<loglevel>\w+)\]\s+(?P<type>\w+):\s+(?P<message>.+)
EXTRACT-phantom-consul-error = ^[^ \n]* (?P<type>\w+)\s+(?P<source>[^:]+):\s+(?P<message>.+)
EXTRACT-phantom-proxyd = ^(?:[^:\n]*:){3}(?P<thread_id>[^ ]+)[^:\n]*:\s+(?P<daemon>\w+):\s+(?P<component>\w+)\s+:\s+(?P<filename>[^ ]+)\s+:\s+(?P<linenumber>[^ ]+)[^:\n]*:\s+(?P<message>.+)
EXTRACT-phantom-websocket = ^[^\]\n]*\]\s+(?P<type>\w+)\s+(?P<message>[^:]+):\s+(?P<message_json>.+)
EXTRACT-phantom-search-traceback = ^[^\]\n]*\]\s+(?P<loglevel>\w+):\s+(?P<traceback>[^\(]+)[^:\n]*:\s+(?P<error_source>\w+\s+".+",\s+.+)

[source::...decided.log]
EXTRACT-phantom-decided-json = ^(?:[^ \n]* ){4}(?P<daemon>[^\[]+)[^\[\n]*\[\d+\]:\s+\w+:(?P<process_id>\d+)[^:\n]*:(?P<thread_id>\d+)\s+:\s+(?P<loglevel>\w+):\s+(\w+\s+)+:\s+(?P<filename>[^ ]+)\s+:\s+(?P<linenumber>\d+)[^:\n]*:\s+(?P<message>.+)
EXTRACT-phantom-decided-json2 = ^(.*\s)(?P<daemon>\w+)[^ \n]* \w+:(?P<process_id>\d+) TID:(?P<thread_id>\d+)\s+:\s+(?P<loglevel>\w+):\s+(?P<component>[^ ]+)[^:\n]*:\s+(?P<filename>[^ ]+)(?:[^ \n]* ){2}(?P<linenumber>\d+)[^:\n]*:\s+(?P<message>.+)

[nginx:plus:error]
EXTRACT-phantom-nginx-error = ^[^#\n]*#(?P<id1>\d+):\s+\*(?P<id2>\d+)\s+(?P<message>.+)

[phantom:supervisord]
EXTRACT-phantom-supervisoryd = ^[^,\n]*,\d+\s+(?P<loglevel>\w+)\s+(?P<status>\w+)[^ \n]* (?P<message>.+)

[source::...spawn.log]
EXTRACT-phantom-spawn = ^(?:[^ \n]* ){5}(?P<daemon>[^\[]+)\[(?P<thread_id>\d+)\]:\s+\w+:(\d+\s+)+:\s+(?P<loglevel>\w+)[^ \n]* (?P<component>\w+)[^:\n]*:\s+(?P<filename>[^ ]+)[^:\n]*:\s+(?P<linenumber>[^ ]+)\s+:\s+(?P<message>.+)
EXTRACT-phantom-spawn-2 = ^\w+\s+\d+\s+\d+:\d+:\d+\s+\w+\s+(?P<daemon>\w+)\[(?P<process_id>\d+)(?:[^:\n]*:){2}(?P<thread_id>[^ ]+)\s+:\s+(?P<loglevel>\w+)[^ \n]* (?P<component>\w+)\s+:\s+(?P<source_file>[^ ]+)\s+:\s+(?P<linenumber>\d+)\s+:\s+(?P<message>[^:].+)
EXTRACT-phantom-spawn-3 = ^(.*\s)(?P<daemon>\w+)(?:[^:\n]*:){2}(?P<process_id>[^ ]+)[^ \n]* \w+:(?P<thread_id>\d+)[^:\n]*:\s+(?P<loglevel>\w+):\s+(?P<component>\w+)[^:\n]*:\s+(?P<filename>[^ ]+)\s+:\s+(?P<linenumber>\d+)\s+:\s+(?P<message>.+)
EXTRACT-phantom-spawn-4 = ^(?:[^ \n]* ){4}(?P<daemon>\w+)(?:[^:\n]*:)*(?P<thread_id>\d+)\s+:\s+(?P<loglevel>\w+)[^ \n]* (?P<component>[^ ]+)(?:[^ \n]* )*(?P<filename>\w+\.\w+)\s+:\s+(?P<linenumber>[^ ]+)\s+:\s+(?P<message>.+)
EXTRACT-phantom-spawn-json = ^(?:[^ \n]* ){4}(?P<daemon>\w+)\[(?P<process_id>\d+)\]:\s+\w+:(?P<thread_id>[^ ]+)\s+:\s+(?P<loglevel>\w+):\s+(?P<component>\w+)[^:\n]*:\s+(?P<source_file>[a-z]+\.[a-z]+)\s+:\s+(?P<linenumber>\d+)(?:[^ \n]* ){3}(?P<sid>[^ ]+)\s+(?P<message>[^:]+):\s+(?P<message_json>\{.+})

[source::...wsgi.log]
EXTRACT-phantom-wsgi-traceback = ^\[pid:\s+(?P<process_id>\d+)(?:[^ \n]* )* (?P<filename>[^:]+)[^:\n]*:(?P<linenumber>[^ ]+)\s+(?P<loglevel>[^:]+)[^ \n]* (?P<message>.+)
EXTRACT-phantom-wsgi = ^(?:[^\)\n]*\)){3}\s+\[\d+/\w+/\d+\s+\d+:\d+:\d+\]\s+(?P<loglevel>\w+):\s+(?P<error_type>[^:]+):\s+(?P<traceback>[^:]+):\s+(?P<message>\w+\s+".+",\s+.+)

[source::...clusterd.log]
EXTRACT-phantom-clusterd = ^(.*\s)(?P<daemon>\w+)[^ \n]* \w+:(?P<process_id>\d+) TID:(?P<thread_id>\d+)\s+:\s+(?P<loglevel>\w+):\s+(?P<component>[^ ]+)[^:\n]*:\s+(?P<filename>[^ ]+)(?:[^ \n]* ){2}(?P<linenumber>\d+)[^:\n]*:\s+(?P<message>.+)

[source::...actiond.log]
EXTRACT-phantom-actiond = ^(.*\s)(?P<daemon>\w+)[^ \n]* \w+:(?P<process_id>\d+) TID:(?P<thread_id>\d+)\s+:\s+(?P<loglevel>\w+):\s+(?P<component>[^ ]+)[^:\n]*:\s+(?P<filename>[^ ]+)(?:[^ \n]* ){2}(?P<linenumber>\d+)[^:\n]*:\s+(?P<message>.+)

[source::...watchdogd.log]
EXTRACT-phantom-watchdogd = ^(.*\s)(?P<daemon>\w+)[^ \n]* \w+:(?P<process_id>\d+) TID:(?P<thread_id>\d+)\s+:\s+(?P<loglevel>\w+):\s+(?P<component>[^ ]+)[^:\n]*:\s+(?P<filename>[^ ]+)(?:[^ \n]* ){2}(?P<linenumber>\d+)[^:\n]*:\s+(?P<message>.+)
