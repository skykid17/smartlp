##
## SPDX-FileCopyrightText: 2020 Splunk, Inc. <sales@splunk.com>
## SPDX-License-Identifier: LicenseRef-Splunk-1-2020
##
##
[ossec_severities_lookup]
filename = ossec_severities_lookup.csv

[ossec_action_lookup]
filename = ossec_action_lookup.csv

[ossec_object_category_lookup]
filename = ossec_object_category_lookup.csv

###### OSSEC ######
[kv_for_default_ossec]
REGEX = Alert Level:\s*([^;]+);\s*Rule:\s*([^\s\-]+)\s*\-\s*([^;]+);\s*Location:\s*([^;]+);(?:\s*classification:\s*([^;]+);\s*)?(?:\s*srcip:\s*(?:-|([^;]+));)?(?:\s*user:\s*(?:-|([^$;]+)[$;]))?(.*)$
FORMAT = crit::$1 id::$2 description::$3 component::$4 classification::$5 src_ip::$6 acct::$7 message::$8

[kv_for_splunk_ossec]
REGEX = \s+component\s*=\s*"([^"]+)",(?:.*\s+file\s*=\s*"([^"]+)",)?
FORMAT = component::$1 file::$2

[component_kv_for_splunk_ossec]
SOURCE_KEY = component
REGEX = ^(?:\(([^\)]+)\))?\s*(?:.+@)?(.+)->([^;]+)$
FORMAT = dest_dns::$1 dest::$2 orig_source::$3

[signature_id_for_default_ossec]
REGEX = Rule:\s*([^\s\-]+)
FORMAT = ossec_signature_id::$1

[signature_id_for_splunk_ossec]
REGEX = \s+id=(\d+)
FORMAT = ossec_signature_id::$1

[dest_kv_for_ossec]
SOURCE_KEY = dest
REGEX = (\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})
FORMAT = dest_ip::$1

[file_kv_for_splunk_ossec]
SOURCE_KEY = file
REGEX = (.*(?:\\|/)([^'\\/]+))
FORMAT = file_path::$1 file_name::$2

[object_kv_for_default_ossec_550_552]
REGEX = ossec:.+Rule:\s*(?:55[012]).+Previous\sMD5:\s*'([^']+)';\s*Current\sMD5:\s*'([^']+)';\s*Previous\sSHA1:\s*'([^']+)';\s*Current\sSHA1:\s*'([^']+)';.+for:\s*'([^']*(?:\\|/)([^'\\/]+))'$
FORMAT = md5_old::$1 md5_new::$2 sha_old::$3 sha_new::$4 file_path::$5 file_name::$6

[object_kv_for_default_ossec_553]
REGEX = ossec:.+Rule:\s*553.+File\s+'([^']*(?:\\|/)([^'\\/]+))'
FORMAT = file_path::$1 file_name::$2

[object_kv_for_default_ossec_554]
REGEX = ossec:.+Rule:\s*554.+file\s+'([^']*(?:\\|/)([^'\\/]+))'
FORMAT = file_path::$1 file_name::$2

[object_kv_for_default_ossec_580_581]
REGEX = ossec:.+Rule:\s*(?:58[01]).+Host:\s*[\d\.]+\s+\(([^\)]+)\)
FORMAT = host_name::$1 object::"Open Ports" object_attrs::"Open Ports"

[object_kv_for_default_ossec_591_592]
REGEX = ossec:.+Rule:\s*(?:59[12]).+\):\s*'([^']*(?:\\|/)([^'\\/]+))'\.$
FORMAT = file_path::$1 file_name::$2

[object_kv_for_default_ossec_594_596]
REGEX = ossec:.+Rule:\s*(?:59[456]).+Previous\sMD5:\s*'([^']+)';\s*Current\sMD5:\s*'([^']+)';\s*Previous\sSHA1:\s*'([^']+)';\s*Current\sSHA1:\s*'([^']+)';.+for:\s*'([^']*\\([^'\\]+))'$
FORMAT = md5_old::$1 md5_new::$2 sha_old::$3 sha_new::$4 file_path::$5 file_name::$6

[object_kv_for_default_ossec_598]
REGEX = ossec:.+Rule:\s*598.+file\s+'([^']*\\([^'\\]+))'
FORMAT = file_path::$1 file_name::$2

[object_kv_for_default_ossec_5303_5304]
REGEX = ossec:.+Rule:\s*(?:530[34]).+\s+([^:]+)\s*:\s*([^:]+)$
FORMAT = target_user::$1 src_user::$2 object_attrs::UID command::su

[object_kv_for_default_ossec_2932_2933_2934]
REGEX = ossec:.+Rule:\s*293[234].+\s+[^:]+\s*:\s*([^:]+)$
FORMAT = package::$1

[object_kv_for_ossec_18103]
REGEX = ossec:.+(?:id=|Rule:\s*)18103.+ERROR\(\d+\):\s*([^:]+):[^:]+:[^:]+:[^:]+:\s*.*\s([^\s]+)\sservice
FORMAT = service::$1 service_name::$2

[object_kv_for_ossec_18130_18106]
REGEX = ossec:.+(?:id=|Rule:\s*)(?:18130|18106).+Account\sFor\sWhich\sLogon\sFailed:\s*Security\sID:\s*[^\s]+\s+Account\sName:\s*([^\s]+)
FORMAT = target_user::$1

[object_kv_for_default_ossec_501_504]
REGEX = ossec:.+Rule:\s*(?:50[14]).+\'([^-]+)->?([\d.]+)\'\.$
FORMAT = ossec_agent::$1 src_ip::$2

[source_port_kv_for_ossec]
REGEX = Source\sPort\s*:\s*(\d+)
FORMAT = src_port::$1

[user_kv_for_default_ossec]
REGEX = ossec:.+Rule:\s*(?:5502|5501|5557).+for\suser\s\(?([^\s\)]+)\)?(?:\sby\s([^\s\(]+))?
FORMAT = target_user::$1 src_user::$2

[object_kv_for_default_ossec_5901]
REGEX = ossec:.+Rule:\s*5901.+(useradd|groupadd)
FORMAT = command::$1

[object_kv_for_default_ossec_5902]
REGEX = ossec:.+Rule:\s*5902.+(?:name=([^,\s]+))
FORMAT = target_user::$1 command::useradd

[object_kv_for_default_ossec_5555]
REGEX = ossec:.+Rule:\s*5555.+(?:password\schanged\sfor\s([^\s;]+))
FORMAT = target_user::$1 object::"User Password" object_attrs::"User Password" command::passwd

[file_size_kv_for_ossec]
REGEX = Size\schanged:\sfrom\s'(\d+)'\sto\s'(\d+)
FORMAT = previous_file_size::$1 file_size::$2

[port_kv_for_ossec]
REGEX = ossec:.+Rule:\s*(?:571[056]|10100).+port\s+(\d+)
FORMAT = src_port::$1

[dest_port_kv_for_ossec]
REGEX = Destination\sPort\s*:\s*(\d+)
FORMAT = dest_port::$1

[object_kv_for_default_ossec_5710]
REGEX = ossec:.+Rule:\s*5710.+Failed\spassword\sfor\sinvalid\suser\s([^\s]+)
FORMAT = target_user::$1

[source_ip_kv_for_ossec_18105_18153]
REGEX = ossec:.+(?:id=|Rule:\s*)(?:18105|18153).+Source\sAddress\s*:\s*([\d\.]+)
FORMAT = src_ip::$1

[object_kv_for_default_ossec_18147]
REGEX = ossec:.+Rule:\s*18147.+Application\s*:\s*[^:]+:([^:]+):[^:]+:[^:]+:[^:]+:\sProduct\s*:\s*([^--]+)\s--
FORMAT = service::$1 service_name::$2

[command_kv_for_ossec]
REGEX = COMMAND=(.*)
FORMAT = command::$1
