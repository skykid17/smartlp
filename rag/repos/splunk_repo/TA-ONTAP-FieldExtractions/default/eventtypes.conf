# Copyright (C) 2005-2021 Splunk Inc. All Rights Reserved.

###############################################
#
#Perf EventTypes
#
###############################################
[ontap_aggr_perf]
search = sourcetype=ontap:perf source=AggrPerfHandler
#tags = performance storage

[ontap_disk_perf]
search = sourcetype=ontap:perf source=DiskPerfHandler
#tags = performance storage inventory

[ontap_lun_perf]
search = sourcetype=ontap:perf source=LunPerfHandler
#tags = performance storage

[ontap_qtree_perf]
search = sourcetype=ontap:perf source=QTreePerfHandler
#tags = performance storage

[ontap_quota_perf]
search = sourcetype=ontap:perf source=QuotaPerfHandler
#tags = performance storage

[ontap_system_perf]
search = sourcetype=ontap:perf source=SystemPerfHandler
#tags = performance storage inventory cpu os

[ontap_vfiler_perf]
search = sourcetype=ontap:perf source=VFilerPerfHandler
#tags = performance storage

[ontap_volume_perf]
search = sourcetype=ontap:perf source=VolumePerfHandler
#tags = performance storage inventory

###############################################
#
# Storage
#
###############################################

[ontap_system_os]
search = sourcetype=ontap:system source=system-get-info os=*
#tags = os

[ontap_system_storage]
search = sourcetype=ontap:system source=system-get-info (storage=* OR storage_free=* OR storage_used=* OR storage_used_percent=*)
#tags = storage performance

[ontap_system_cpu]
search = sourcetype=ontap:system source=system-get-info (cpu_mhz=* OR cpu_count=*)
#tags = cpu

[ontap_system_memory]
search = sourcetype=ontap:system source=system-get-info mem=*
#tags = memory

[ontap_system_inventory]
search = sourcetype=ontap:system source=system-get-info dest=*
#tags = inventory

[ontap_system_cluster]
search = sourcetype=ontap:system (source=system-node-get-iter OR source=system-get-node-info-iter OR source=system-get-version) array_id=*

[ontap_volume]
search = sourcetype=ontap:volume source=volume-list-info-iter-start OR source=volume-get-iter
#tags = storage

[ontap_disk]
search = sourcetype=ontap:disk source=disk-list-info OR source=storage-disk-get-iter
#tags = storage

[ontap_aggr]
search = sourcetype=ontap:aggr source=aggr-list-info OR source=aggr-get-iter
#tags = storage

[ontap_lun]
search = sourcetype=ontap:lun source=lun-list-info OR source=lun-get-iter
#tags = storage

[ontap_vserver]
search = sourcetype=ontap:vserver source=vserver-get-iter
#tags = storage

[ontap_qtree]
search = sourcetype=ontap:qtree source=qtree-list-iter OR source=qtree-list-iter-start
#tags = storage

[ontap_quota]
search = sourcetype=ontap:quota source=quota-status-iter
#tags = storage

[ontap_system_storage_error]
search = sourcetype=ontap:system (env-failed-fan-count>0 OR env-failed-power-supply-count>0 OR env-failed-fan-message=* OR env-failed-power-supply-message=*) array_id=*

[ontap_aggr_error]
search = sourcetype=ontap:perf source=AggrPerfHandler (blkr_async_no_mem>0 OR blkr_async_no_msg>0 OR blkr_async_offline>0 OR blkr_redirect_susps>0 OR blkr_rejected_blocks_scanned>0 OR blkr_rejected_by_aa_threshold>0 OR blkr_rejected_by_chain_cost>0 OR blkr_rejected_full_stripes>0 OR blkr_rejected_partial_stripes>0 OR blkr_rejected_segments_before_scan>0 OR blkr_rejected_segments_in_current_aa>0 OR blkr_rejected_segments_scanned>0 OR blkr_rejected_ssd_rgs>0) pool_id=*

[ontap_volume_error]
search = sourcetype=ontap:perf source=VolumePerfHandler (bad_user_blk_read_error_propagated>0 OR bad_user_blk_read_error_not_propagated>0 OR bad_fixable_blk_read_error_propagated>0 OR bad_fixable_blk_read_error_not_propagated>0 OR bad_non_fixable_blk_read_error_propagated>0 OR bad_non_fixable_blk_read_error_not_propagated>0 OR bad_fixable_metafile_blk_read_error_propagated>0 OR bad_fixable_metafile_blk_read_error_not_propagated>0 OR bad_zombie_ind_blk_read_err_propagated>0 OR bad_zombie_ind_blk_read_err_not_propagated>0 OR bad_container_user_blk_read_error_propagated>0 OR bad_container_user_blk_read_error_not_propagated>0 OR bad_container_fixable_afs_blk_read_error_propagated>0 OR bad_container_fixable_afs_blk_read_error_not_propagated>0 OR bad_container_fixable_snap_blk_read_error_propagated>0 OR bad_container_fixable_snap_blk_read_error_not_propagated>0 OR bad_container_non_fixable_blk_read_error_propagated>0 OR bad_container_non_fixable_blk_read_error_not_propagated>0 OR clone_prune_tmpclonedir_err>0) volume_id=*

[ontap_lun_error]
search = sourcetype=ontap:perf source=LunPerfHandler (enospc>0 OR enospc_retry>0 OR wafl_read_errors>0 OR wafl_write_errors>0 OR unmap_too_many_error_count>0 OR unmap_too_many_error_count>0) lun_id=*

[ontap_disk_error]
search =  sourcetype=ontap:disk (disk-paths.disk-path-info{}.path-link-errors>0 OR disk-stats-info.path-error-count>0) disk_id=*