##
## SPDX-FileCopyrightText: 2024 Splunk, Inc.
## SPDX-License-Identifier: LicenseRef-Splunk-8-2021
##
##
[cisco-ise-extract-raw-message]
REGEX = (?:(?:\d+\s(\d+)\s(NOTICE|WARN|INFO|DEBUG|ERROR|FATAL))|(?:CISE_Alarm\s*\[?([^:\]]+)\]?\:\s([^:]+)\s*:)|(?:\d{10}\s\d\s\d)(?:.+?(?=\d+\s(?:NOTICE|WARN|INFO|DEBUG|ERROR|FATAL))(\d+)\s(\w+))?)\s+(.+)
FORMAT = MESSAGE_CODE::$1 x_status::$2 alarm_type::$3 alarm_description::$4 MESSAGE_CODE::$5 x_status::$6 raw_msg::$7

[cisco-ise-raw-message]
SOURCE_KEY = raw_msg
REGEX = (?:(?:(?:Response|OperationMessageText)\s*=\s*.+?})|(?:([^=:,;]+)\s*[=:]\s*"?([^{]*?(?=[;,]\s*[\w\-\\._\&\/\(\)\s]+[=:]|$|,$|"))[,;]?))
FORMAT = $1::$2
MV_ADD=true

[cisco-ise-operation-message-text]
SOURCE_KEY = raw_msg
REGEX = (OperationMessageText|Response)\s*=\s*(.+?})
FORMAT = $1::$2
MV_ADD=true

[cisco-ise-operation-counters]
REGEX = OperationCounters=Counter=([^:]+):([^,]+)
FORMAT = $1::$2

[cisco-ise-open-ssl-err-msg]
REGEX = \s*OpenSSLErrorMessage\s*=\s*(?<OpenSSLErrorMessage>[^,]+)

[cisco-ise-called-station-id]
REGEX = Called-Station-ID=\s*(?:(?<dest_mac>(?:[0-9A-Fa-f]{2}[:-]){5}(?:[0-9A-Fa-f]{2}))|(?<dest_ip>\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))[,:;]

[cisco-ise-calling-station-id]
REGEX = Calling-Station-ID=\s*(?:(?<src_mac>(?:[0-9A-Fa-f]{2}[:-]){5}(?:[0-9A-Fa-f]{2}))|(?<src_ip>\d+\.\d+\.\d+\.\d+|[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*))[,:;]

[cisco-ise-type]
REGEX = (?<server_type>CSCOacs|CISE)_(?<log_type>[^\s\[]+)

[cisco-ise-servername]
REGEX = \s(?<ise_servername>\S+?)\s*CISE_(?!Alarm)

[cisco-ise-action-failure-for-auth]
REGEX = ([Aa]uthentication\s+(?:\w+\s){1,6}failed|[Aa]uthentication[\s-][Ff]ailed|[Aa]uthorization[\s-][Dd]enied|[Aa]uthentication[\s-][Rr]ejected|[Cc]an't[\s-][Ff]ind[\s-][Aa]uthentication|[Cc]redentials[\s-][Rr]ejected|[Aa]uthentication:[Dd]ropping|[Ll]ogin[\s-][Ww]arning|[Ll]ogin[\s-][Ff]ailed|[Ff]ailed [Aa]uthentication)
FORMAT = action::failure vendor_action::$1

[cisco-ise-action-success-for-auth]
REGEX = ([Aa]uthorization[\s-][Ss]ucceeded|[Aa]uthentication[\s-][Ss]ucceeded|[Aa]uthorization[\s-][Pp]ermitted|[Aa]uthentication[\s-][Ss]uccessful|[Ll]ogin[\s-][Pp]ermitted|[Aa]uthentication[\s-][Pp]assed|[Pp]assed[\s-][Aa]uthentication)
FORMAT = action::success vendor_action::$1

[cisco-ise-vendor-action-for-auth]
REGEX = [Aa]uthentication[\s-]([Ss]ucceeded)|[Aa]uthorization[\s-]([Pp]ermitted)|[Aa]uthentication[\s-]([Ss]uccessful)|[Ll]ogin[\s-]([Pp]ermitted)|authentication[\s-]([Pp]assed)|([Pp]assed)[\s-][Aa]uthentication|[Aa]uthentication[\s-]([Ff]ailed)|[Aa]uthorization[\s-]([Dd]enied)|[Aa]uthentication[\s-]([Rr]ejected)|[Cc]an't[\s-]([Ff]ind)[\s-][Aa]uthentication|[Cc]redentials[\s-]([Rr]ejected)|[Aa]uthentication:([Dd]ropping)|[Ll]ogin[\s-]([Ww]arning)|[Ll]ogin[\s-]([Ff]ailed)|([Ff]ailed) [Aa]uthentication
FORMAT = cisco_ise_vendor_action::$1 cisco_ise_vendor_action::$2 cisco_ise_vendor_action::$3 cisco_ise_vendor_action::$4 cisco_ise_vendor_action::$5 cisco_ise_vendor_action::$6 cisco_ise_vendor_action::$7 cisco_ise_vendor_action::$8 cisco_ise_vendor_action::$9 cisco_ise_vendor_action::$10 cisco_ise_vendor_action::$11 cisco_ise_vendor_action::$12 cisco_ise_vendor_action::$13 cisco_ise_vendor_action::$14 cisco_ise_vendor_action::$15

[cisco-ise-action-blocked]
REGEX=([Cc]onnection[\s-]denied|[Dd]eny[\s-][Ii]nbound|[Dd]eny|Unable[\s-]to[\s-]Pre-allocate|[Dd]enied\s[tcp|udp|icmp]+|[Dd]iscarded|[Aa]ccess[\s-][Dd]enied|[Dd]ropped|[Dd]ropping)
FORMAT = vendor_action::$1

[cisco-ise-action-allowed]
REGEX = ([Bb]uilt|[Pp]ermitted|[Ww]hitelist|[Pp]re-allocated|[Rr]ebuilt)
FORMAT = vendor_action::$1

[cisco-ise-action-unknown]
REGEX = ([Rr]edirected|[Ll]imit[\s-][Ee]xceeded)
FORMAT = vendor_action::$1

[cisco-ise-tunnel-private-group-id]
REGEX = \sTunnel-Private-Group-ID=(\((?<Tunnel_Private_Group_ID_tagged>\S+)\)\s)?(?<Tunnel_Private_Group_ID>\S+)(,|;)
MV_ADD = true

[cisco-ise-message-catalog-lookup]
filename = cisco_ise_message_catalog_500.csv

[cisco-ise-change-lookup]
filename = cisco_ise_change_message_code_420.csv

[cisco-ise-service-lookup]
filename = cisco_ise_service.csv

[cisco-ise-sourcetype]
DEST_KEY = MetaData:Sourcetype
REGEX = (?:CSCOacs|CISE)_
FORMAT = sourcetype::cisco:ise:syslog

[cisco-ise-service-58001]
REGEX = (?<service_id>58001)(?:.*)OperationMessageText\s*=(.*?)(?=[Ss]tarted)
FORMAT = service_id::$1 service::$2

[cisco_ise_field_action]
REGEX  = \baction\s*=\s*"([^"]*)"|\baction\s*=\s*([^\;\,]*)\s*
FORMAT = cisco_ise_action::$1 cisco_ise_action::$2

[cisco-ise-traffic-ports-hosts]
REGEX = (?:61025.*?)OperationMessageText=\s*\d+\s*Connection\s*requested\s*(?:(?<src_ip>(?:[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*|[\d+.]+))|(?<src_host>[^\(]+))\((?<src_port>\d+)\)\s*-\s*(?:(?<dest_ip>(?:[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*|[\d+.]+))|(?<dest_host>[^\(]+))\((?<dest_port>\d+)\)

[cisco-ise-traffic-fields-61025-created-connection]
REGEX = (?:61025.*?)OperationMessageText=Connection\s*created\s*from\s*\[?(?:(?<src_ip>(?:[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*|[\d+.]+))\]?|(?<src_host>\S+))\s*\:\s*(?<src_port>\d{1,5})\s*to\s*\[?(?:(?<dest_ip>(?:[a-fA-F0-9]*:[a-fA-F0-9]*:[a-fA-F0-9:]*|[\d+.]+))\]?|(?<dest_host>\S+))\s*\:\s*(?<dest_port>\d{1,5})
