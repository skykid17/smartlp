{"response_tasks":[{"author":"Bhavin Patel, Splunk","date":"2019-02-14","description":"This Playbook is part of the Splunk Analytic Story called DNS Hijacking. It is made to be run when the Detection Search within that story called \"DNS Record Changed\" is used to identify DNS record changes for cloud and corporate domains used in your environment. The detection search is dependent on a support searched called \"Discover DNS Records\" which finds the common DNS responses for the last 30 days of monitored corporate domains and cloud providers (located in lookups: cim_corporate_email_domains.csv, cim_corporate_web_domains.csv, and cloud_domains.csv from Splunk CIM App). These responses are stored under the lookup called discovered_dns_records.csv. The playbook starts with the changed DNS records and uses MaxMind, whois, Censys, Malware Domain List, and PassiveTotal to gather attributes of the DNS records for comparison against expected values. The resulting enrichment is displayed in Mission Control and posted back to the Notable Event in Splunk ES.","how_to_implement":"If Splunk>Phantom is also configured in your environment, a Playbook called \"DNS Hijack Enrichment\" can be configured to run when any results are found by this detection search. The playbook takes in the DNS record changed and uses Geoip, whois, Censys and PassiveTotal to detect if DNS issuers changed. To use this integration, install the Phantom App for Splunk `https://splunkbase.splunk.com/app/3411/`, add the correct hostname to the \"Phantom Instance\" field in the Adaptive Response Actions when configuring this detection search, and set the corresponding Playbook to active. \\\n(Playbook Link:`https://my.phantom.us/4.2/playbook/dns-hijack-enrichment/`).\\\n","id":"c096f721-8842-42ce-bfc7-74bd9a72c712","name":"DNS Hijack Enrichment","playbook":{"name":"dns_hijack_enrichment","url_json":"https://github.com/phantomcyber/playbooks/blob/4.6/dns_hijack_enrichment.json","url_python":"https://github.com/phantomcyber/playbooks/blob/4.6/dns_hijack_enrichment.py"},"tags":{"analytic_story":["DNS Hijacking"],"product":["Splunk Phantom"]},"type":"response","version":1},{"author":"Philip Royer, Splunk","date":"2019-04-29","description":"Investigate domain names and URLs of a potentially malicious website. These domain names and URLs could come from anywhere, but this Playbook was designed to work with the Splunk Analytic Story focused on evilginx2 phishing techniques that harvest credentials from fake login sites. The full investigation is only completed if at least one of the TLS certificates of the domains matches the issuer distinguished name of Let's Encrypt, which is a free service that provides automatically issued TLS certificates. This Playbook gathers certificate information for the domains, queries whois for the domains, takes a screenshot of each of the URLs, and does a urlscan.io scan of each of the URLs. Finally, all the results are formatted together and posted to the event comments.","how_to_implement":"To successfully implement this phantom playbook, you must integrate Enterprise Security with Phantom. Configure this playbook in the correlation search `Detect DNS requests to Phishing Sites leveraging EvilGinx2` ,as an adaptive response action.","id":"c096f721-8842-42ce-2fc7-742d8272b712","name":"Domain Certificate Investigation","playbook":{"name":"lets_encrypt_domain_investigate","url_json":"https://github.com/phantomcyber/playbooks/blob/4.6/lets_encrypt_domain_investigate.json","url_python":"https://github.com/phantomcyber/playbooks/blob/4.6/lets_encrypt_domain_investigate.py"},"tags":{"analytic_story":["Common Phishing Frameworks"],"product":["Splunk Phantom"]},"type":"response","version":1},{"author":"Bhavin Patel, Splunk","date":"2019-02-14","description":"This Playbook is part of the Splunk Analytic Story called Account Monitoring and Controls. It is made to be run when the Detection Search within that story called \"Detect Excessive Account Lockouts From Endpoint\" is used to identify a potential attack in which multiple Active Directory user accounts are locked out from logging in because an adversary attempted incorrect credentials repeatedly against many user accounts. This Playbook runs the Context-gathering and Investigative searches linked in the Splunk Analytic Story to enrich the event with a broad array of information about the users and computers involved. Then the Playbook uses Windows Remote Management to login to the source of the lockouts, gather more information, and allow Phantom to shutdown the server after prompting an analyst or responder.","how_to_implement":"Import playbook into phantom","id":"ab62b5c1-95d4-4e71-8fd7-53a55db33da4","name":"Excessive Account Lockouts Enrichment And Response","playbook":{"name":"excessive_account_lockouts_enrichment_and_response","url_json":"https://github.com/phantomcyber/playbooks/blob/4.6/excessive_account_lockouts_enrichment_and_response.json","url_python":"https://github.com/phantomcyber/playbooks/blob/4.6/excessive_account_lockouts_enrichment_and_response.py"},"tags":{"analytic_story":["Account Monitoring and Controls"],"product":["Splunk Phantom"]},"type":"response","version":2},{"author":"ButterCup","automation":{"actions":["set status"],"is_note_required":false,"playbooks":[{"playook":"Accept event and assign owner","scm":"local"}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Accepts the event and starts the response plan process by assigning the event to the person executing the playbook and assigns them to this task and closes this step as completed.\n","id":"667b8d15-2564-4994-929d-bda2532341bf","name":"Accept and assign event","references":["3.2.2 Signs of an Incident - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"This task is a default accept task and allows the analyst to start the response process and start the timer for mean time to detect (MTTD).  This allows measurement of analyst review and acceptance of the task at hand.  This can be superceded by assign other tasks to individuals (if the owner is coordinating processor).  The event owner can accept the event, and then retask other sub-phase and/or task to other individuals or teams.  This is considered a procedural or policy task.\n"},{"author":"ButterCup, Splunk","automation":{"actions":["run query","whois domain","domain reputation","hunt domain"],"is_note_required":false,"playbooks":[{"playbook":"","scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-04-21","description":"Validate indicator existence, reputation, detonation and determine if Known APT, Commodity, Suspicious or Not Malicious?\n","id":"7744864c-5446-47ab-8118-4cbaa1649747","name":"Analyze domain indicator and reputation","references":["3.2.3 Sources of Precursors and Indicators - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"These are domains that are not related to urls and should be separately reviewed.\n1. If Splunk present, run Splunk Query on each indictor and prevelence in the environment. Summarize # of times indicator seen in the last 24 hrs, 7 days, 1 month, six months increments. Return the hosts that have used this indictor. (make an artifact for each host?)\n  a. search -> ```| stats ...```\n1. Gather reputational, intelligence and general information regarding indicator into a note (a note for each indicator)\n1. Perform any additional research regarding indicators and understanding what normal behaviour is or should be by using using search engines, knowledge bases etc.\n1. Make a determination of indicator, Known APT, Commodity, Suspicous or Not Malicious and whether to tag to block indicator\n  a. This should align to a severity change (Known APT = High, Commodity = Med, Suspicous = Low, Not Malicious = Info)\n  a. hange container and artifact severity and tag artifact & indicator(s) with blocked and determination tag\n"},{"author":"ButterCup","automation":{"actions":["run query"],"is_note_required":false,"playbooks":[{"playook":null,"scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-04-21","description":"Validate email indicators existence, reputation, detonation and determine if Phish, Spam, Suspicious or Clean ?\nAnalyst should be reviewing SPF, DKIM, DMARC along with To: and Reply to: fields for non-matching data. Does the subject contain suspicious content. Is there a file or url? Does the x-origin-ip come from the same location and the sending domains? Does the email body seem too good to be true or create a sense of urgency?\n","id":"9e2d3e51-2e8f-4d49-8206-fb3e5fbf6620","name":"Analyze email indicators and reputation","references":["3.2.3 Sources of Precursors and Indicators - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. If Splunk present, run Splunk Query on each indictor and prevalence in the environment. Summarize # of times indicator seen in the last 24 hrs, 7 days, 1 month, six months increments. Return the hosts that have used this indictor. (make an artifact for each host?)\n  a. search -> ```| stats ...```\n1. Gather reputation, intelligence and general information regarding indicator into a note (a note for each indicator)\n1. Perform any additional research regarding indicators and understanding what normal behaviour is or should be by using using search engines, knowledge bases etc.\n1. Make a determination of indicator, Known APT, Commodity, Suspicious or Not Malicious and whether to tag to block indicator\n  a. This should align to a severity change (Known APT = High, Commodity = Med, Suspicious = Low, Not Malicious = Info)\n  a. Change container and artifact severity and tag artifact & indicator(s) with blocked and determination tag\n"},{"author":"ButterCup","automation":{"actions":null,"is_note_required":false,"playbooks":[{"playook":"","scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Validate indicator existence, reputation, detonation and determine if Known APT, Commodity, Suspicious or Not Malicious?\n","id":"be7cce5c-29b9-405c-923a-d4565705da2e","name":"Analyze host indicator and reputation","references":["3.2.3 Sources of Precursors and Indicators - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. If Splunk present, run Splunk Query on each indictor and prevalence in the environment. Summarize # of times indicator seen in the last 24 hrs, 7 days, 1 month, six months increments. Return the hosts that have used this indictor. (make an artifact for each host?)\n  a. search -> ```| stats ...```\n1. Gather repetitional, intelligence and general information regarding indicator into a note (a note for each indicator)\n1. Perform any additional research regarding indicators and understanding what normal behaviour is or should be by using using search engines, knowledge bases etc.\n1. Make a determination of indicator, Known APT, Commodity, Suspicious or Not Malicious and whether to tag to block indicator\n  a. This should align to a severity change (Known APT = High, Commodity = Med, Suspicious = Low, Not Malicious = Info)\n  a. Change container and artifact severity and tag artifact & indicator(s) with blocked and determination tag\n"},{"author":"ButterCup, Splunk","automation":{"actions":["run query","whois ip","geolocate ip","ip reputation","ip intelligence","hunt ip","lookup ip"],"is_note_required":false,"playbooks":[{"playook":"","scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Validate indicator existence, reputation, detonation and determine if Known APT, Commodity, Suspicious or Not Malicious?\n","id":"a194130b-f5a8-4bfe-b09f-35f58f4397d5","name":"Analyze IP address indicator and reputation","references":["3.2.3 Sources of Precursors and Indicators - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. If Splunk present, run Splunk Query on each indictor and prevalence in the environment. Summarize # of times indicator seen in the last 24 hrs, 7 days, 1 month, six months increments. Return the hosts that have used this indictor. (make an artifact for each host?)\n  a. search -> ```| stats ...```\n1. Gather repetitional, intelligence and general information regarding indicator into a note (a note for each indicator)\n1. Perform any additional research regarding indicators and understanding what normal behaviour is or should be by using using search engines, knowledge bases etc.\n1. Make a determination of indicator, Known APT, Commodity, Suspicious or Not Malicious and whether to tag to block indicator\n  a. This should align to a severity change (Known APT = High, Commodity = Med, Suspicious = Low, Not Malicious = Info)\n  a. Change container and artifact severity and tag artifact & indicator(s) with blocked and determination tag\n"},{"author":"ButterCup, Splunk","automation":{"actions":["run query","whois ip","whois domain","geolocate ip","ip reputation","domain reputation","url reputation","ip intelligence","domain intelligence","url intelligence","hunt ip","hunt domain","hunt url","detonate url"],"is_note_required":false,"playbooks":[{"playook":"","scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Validate indicator existance, reputation, detonation and determine if Known APT, Commodity, Suspicous or Not Malicious?\n","id":"710b1249-88b4-4dfd-95cc-541cc688e1a3","name":"Analyze network indicators and reputation","references":["3.2.3 Sources of Precursors and Indicators - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. If Splunk present, run Splunk Query on each indictor and prevelence in the environment. Summarize # of times indicator seen in the last 24 hrs, 7 days, 1 month, six months increments. Return the hosts that have used this indictor. (make an artifact for each host?)\n  a. search -> ```| stats ...```\n1. Gather reputational, intelligence and general information regarding indicator into a note (a note for each indicator)\n1. Perform any additional research regarding indicators and understanding what normal behaviour is or should be by using using search engines, knowledge bases etc.\n1. Make a determination of indicator, Known APT, Commodity, Suspicous or Not Malicious and whether to tag to block indicator\n  a. This should align to a severity change (Known APT = High, Commodity = Med, Suspicous = Low, Not Malicious = Info)\n  a. hange container and artifact severity and tag artifact & indicator(s) with blocked and determination tag\n"},{"author":"ButterCup, Splunk","automation":{"actions":null,"is_note_required":false,"playbooks":[{"playook":null,"scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-04-21","description":"Review precursor and indicator data and try to prove the data observed is normal activity. This analysis is provided by reviewing additional logs and sources to include ids's, siem, network logs, host and host application event logs and vulnerabiltiy information. This is not an exhaustive list, but a summary of the data available.  Data available should be aligned the type of event and resources available to the customer.\n","id":"ef9e7a25-73f0-4b63-b43b-2f4171518931","name":"Analyze precursors to the event","references":["3.2.3 Sources of Precursors and Indicators - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"requirements":null,"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. Depending the attack vector, use your siem or logging collector to find logs regarding the host, application and network connections surrounding the event detected.\n2. Identify evidence information that proves the incident occurred as detected or corraborates the event(s).\n3. Perform research regarding indicators and understanding what normal behaviour is or should be by using using search engines, knowledge bases etc.\n"},{"author":"ButterCup, Splunk","automation":{"actions":["whois domain","domain reputation","url reputation","domain intelligence","url intelligence","hunt domain","hunt url","detonate url"],"is_note_required":false,"playbooks":[{"playook":"","scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Validate indicator existance, reputation, detonation and determine if Known APT, Commodity, Suspicous or Not Malicious?\n","id":"65a23d95-7b5a-405c-b5bf-893983478d35","name":"Analyze url indicator and reputation","references":["3.2.3 Sources of Precursors and Indicators - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"This should be TLD domain and url combinations analysis.\n1. If Splunk present, run Splunk Query on each indictor and prevelence in the environment. Summarize # of times indicator seen in the last 24 hrs, 7 days, 1 month, six months increments. Return the hosts that have used this indictor. (make an artifact for each host?)\n  a. search -> ```| stats ...```\n1. Gather reputational, intelligence and general information regarding indicator into a note (a note for each indicator)\n1. Perform any additional research regarding indicators and understanding what normal behaviour is or should be by using using search engines, knowledge bases etc.\n1. Make a determination of indicator, Known APT, Commodity, Suspicous or Not Malicious and whether to tag to block indicator\n  a. This should align to a severity change (Known APT = High, Commodity = Med, Suspicous = Low, Not Malicious = Info)\n  a. Change container and artifact severity and tag artifact & indicator(s) with blocked and determination tag\n"},{"author":"ButterCup","automation":{"action":null,"is_note_required":false,"playbook":"","role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-17","description":"Take training courses to gain relevant knowledge - Sharpen the saw.","id":"df493538-e598-463b-8835-a109022c2968","name":"Conduct training","references":[""],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"We do not rise to the level of our expectations. We fall to the level of our training.  - @atc_project\n> \u201cThe more that you read, the more things you will know. The more that you learn, the more places you\u2019ll go.\u201d \u2015 Dr. Seuss\nWe assume that you already have a strong technical background in fundamental disciplines \u2014 Networking, Operating Systems, and Programming.\nHere are some relevant training courses that will help you in the Incident Response activities:\n1. [Investigation Theory](https://chrissanders.org/training/investigationtheory/) by Chris Sanders. We recommend you to have it as a mandatory training for every member of your Incident Response team\n1. [SANS Digital Forensics & Incident Response](https://digital-forensics.sans.org/training/courses) trainings\n  * SEC450: Blue Team Fundamentals: Security Operations and Analysis - https://www.sans.org/course/blue-team-fundamentals-security-operations-analysis. We recommend you to have it as a mandatory training for every member of your Incident Response team\n  * SEC504: Hacker Tools, Techniques, Exploits, and Incident Handling - https://www.sans.org/course/hacker-techniques-exploits-incident-handling We recommend you to have it as a mandatory training for every member of your Incident Response team\n  * FOR500: Windows Forensic Analysis - https://www.sans.org/course/windows-forensic-analysis\n  * FOR508: Advanced Incident Response, Threat Hunting, and Digital Forensics - https://www.sans.org/course/advanced-incident-response-threat-hunting-training\n  * SEC503: Intrusion Detection In-Depth - https://www.sans.org/course/intrusion-detection-in-depth\n  * FOR572: Advanced Network Forensics: Threat Hunting, Analysis, and Incident Response - https://www.sans.org/course/advanced-network-forensics-threat-hunting-incident-response\n  * SEC560: Network Penetration Testing and Ethical Hacking - https://www.sans.org/course/network-penetration-testing-ethical-hacking OR Offensive Security trainings mentioned below\n  * SEC599: Defeating Advanced Adversaries - Purple Team Tactics & Kill Chain Defenses - https://www.sans.org/course/defeating-advanced-adversaries-kill-chain-defenses\n1. [Offensive Security](https://www.offensive-security.com/courses-and-certifications/) trainings. We recommend [PWK](https://www.offensive-security.com/pwk-oscp/) by Offensive Security trainings are in the list because to fight a threat, you need to understand their motivation, tactics, and techniques.\nThe training above is a recommendation and certainly the size of the organization will depend on the amount of training possible.\n"},{"author":"ButterCup","automation":{"actions":["update event"],"is_note_required":false,"playbooks":[{"playook":"Update TLP, attack vector, disposition and category of event","scm":"local"}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Upon analysis, determination of incident status is either confirmation, suspicious, false positive or authorized exception. Update the event metadata and process event as determined.\n","id":"994298f0-75fc-4c14-b044-9b81944d3a03","name":"Confirm incident","references":["3.2.4 Incident Analysis - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf","3.2.5 Incident Documentation - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"requirements":null,"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. Determine if confirmed, suspicious, a false positive, or authorized exception event\n2. Update TLP, attack vector, disposition and category of event\n3. Proceed on the next task of prioritizing incident or lessons learned or escalate for additional investigation\n"},{"author":"ButterCup, Splunk","automation":{"actions":["block ip","block domain","block url","block process","terminate process","quarantine host","quarantine device"],"is_note_required":false,"playbooks":[{"playook":"quarantine device and block external network access","scm":"community"}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Use atomic indicators to block and contain malicious activity. Use host and network protection tools to block, pause, drop, or quarantine affected machines.\n","id":"735335a5-7ac0-4bdf-b1d3-6f4a6767d02f","name":"Contain Incident","references":["3.3.1 Choosing a Containment Strategy - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"requirements":null,"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. Determine the appropriate containment technique either with soft block (localized blocking of a specific indictors) or hard block (regionalized blocking, quarantine whole hosts, net blocks, etc) techniques\n"},{"author":"ButterCup, Splunk","automation":{"actions":["update ticket"],"is_note_required":false,"playbooks":[{"playook":null,"scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Build an after actions report that discusses about what happened and a timeline. Provide what went well and what improvements can be made, information timeliness, steps or actions that might have delayed recovery, what information was shared or could have been shared, any corrective actions that would have prevent the incident, identify precursors and indicators should be watched for in the future or tools that could be used to mitigate future incidents. Conduct an Incident Review Meeting.\n","id":"69d25415-408f-462a-899f-9bc8eef8c299","name":"Create follow-up report","references":["3.4.1 Lessons Learned - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. Create a follow up report\n  a. Exactly what happened, and at what times?\n  b. How well did staff and management perform in dealing with the incident?\n  c. Were the documented procedures followed? Were they adequate?\n  d. What information was needed sooner?\n  e. Were any steps or actions taken that might have inhibited the recovery?\n  f. What would the staff and management do differently the next time a similar incident occurs?\n  g. How could information sharing with other organizations have been improved?\n  h. What corrective actions can prevent similar incidents in the future?\n  i. What precursors or indicators should be watched for in the future to detect similar incidents?\n  j. What additional tools or resources are needed to detect, analyze, and mitigate future incidents?\n2. Schedule and conduct a Incident Review Meeting with necessary leadership and incident response team\n"},{"author":"ButterCup, Splunk","automation":{"actions":["set status"],"is_note_required":false,"playbooks":[{"playook":"Accept event and assign owner","scm":"local"}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Review precursor and indicator data and try to prove the data observed is normal activity. Knowledge of false positives detractors will support this assessment. The object of this step is to remove confirmation bias and validate the detection as a true positive and anomalous behavior.\n","id":"92ba5c50-717d-44e7-bb88-72bf6907ec83","name":"Determine if an incident has occurred","references":["3.2.2 Signs of an Incident - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"Incident handlers are responsible for analyzing ambiguous, contradictory, and incomplete symptoms to determine what has happened.\nThe process here is to remove bias and support investigation based on indicators that validate compromise or violdation for continued investigation\n"},{"author":"ButterCup, Splunk","automation":{"actions":["update container"],"is_note_required":false,"playbooks":[{"playook":"Determine impact and effort","scm":"local"}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Determine Functional Impact of the Incident. Incidents targeting IT systems typically impact the business functionality that those systems provide, resulting in some type of negative impact to the users of those systems.\nDetermine Information Impact of the Incident. Incidents may affect the confidentiality, integrity, and availability of the organizations information.\nDetermine Recoverability from the Incident. The size of the incident and the type of resources it affects will determine the amount of time and resources that must be spent on recovering from that incident.\n","id":"91f1c863-c080-4b3c-921c-e1ca1c0e7ae1","name":"Determine Incident Prioritization","references":["3.2.6 Incident Prioritization - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. Determine Functional Impact of the Incident. By determining,\n    a. None   | No effect to the organization\u2019s ability to provide all services to all users\n    b. Low    | Minimal effect; the organization can still provide all critical services to all users but has lost efficiency\n    c. Medium | Organization has lost the ability to provide a critical service to a subset of system users\n    d. High   | Organization is no longer able to provide some critical services to any users\n2. Determine Information Impact of the Incident. Incidents may affect the confidentiality, integrity, and availability of the organization\u2019s information.\n    a. None               | No information was exfiltrated, changed, deleted, or otherwise compromised\n    b. Privacy Breach     | Sensitive personally identifiable information (PII) of taxpayers, employees, beneficiaries, etc. was accessed or exfiltrated\n    c. Proprietary Breach | Unclassified proprietary information, such as protected critical infrastructure information (PCII), was accessed or exfiltrated\n    d. Integrity Loss     | Sensitive or proprietary information was changed or deleted\n3. Determine Recoverability from the Incident. The size of the incident and the type of resources it affects will determine the amount of time and resources that must be spent on recovering from that incident.\n    a. Regular          | Time to recovery is predictable with existing resources\n    b. Supplemented     | Time to recovery is predictable with additional resources\n    c. Extended         | Time to recovery is unpredictable; additional resources and outside help are needed\n    d. Not Recoverable  | Recovery from the incident is not possible (e.g., sensitive data exfiltrated and posted publicly); launch investigation\n"},{"author":"ButterCup, Splunk","automation":{"actions":["create ticket","create incident","create case","send email"],"is_note_required":false,"playbooks":[{"playook":"Create case or merge with known case","scm":"local"}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-04-21","description":"At this point, incident responder should acquire, preserve, secure, and document all evidence to the incident. This process will be continual through the IR process. The incident responder should perform notification pursuant to the organizational incident response policy and outlined procedures.\n","id":"3890e0b3-bb46-4b9b-8134-184dbe644a8a","name":"Document and notify of incident","references":["3.2.5 Document Incident - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf","3.2.7 Incident Notification - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"The reasond for reordering of the documentation of the incident was to align documentation and incident notification into the same process flow.\n1. The current status of the incident (new, in progress, forwarded for investigation, resolved, etc.)\n2. A summary of the incident\n3. Indicators related to the incident\n4. Other incidents related to this incident\n5. Actions taken by all incident handlers on this incident\n6. Chain of custody, if applicable\n7. Impact assessments related to the incident\n8. Contact information for other involved parties (e.g., system owners, system administrators)\n9. list of evidence gathered during the incident investigation\n10. Comments from incident handlers\n11. Next steps to be taken (e.g., rebuild the host, upgrade an application).\n"},{"author":"ButterCup, Splunk","automation":{"actions":["run query","merge event"],"is_note_required":false,"playbooks":[{"playook":"Merge event with case","scm":"community"}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Use indictors developed from the detection and analysis to find additional hosts or potentially infected hosts.  If found perform additional analysis to determine root cause analysis and any additional indictors. If this is mass infection event, immediate containment must be delayed until full understanding of the infection is achieved.\n","id":"3d481dd1-4f30-4262-a846-78af6bdce11c","name":"Identify additional affected hosts","references":["3.3.1 Choosing a Containment Strategy - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf","3.3.2 Evidence Gathering and Handling - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf","NIST SP 800-86, Guide to Integrating Forensic Techniques into Incident Response, for additional information on preserving evidence"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. For Host infections, use persistence mechanism, dropped filenames, paths, hashs, accessed or collected files, links, network communications, network ports and protocols, netwrok flow data points, etc\n2. For phishing infections, use email addresses, domains, urls, file hashes, x-origin-ip address, subject, etc\n3. For Command and Control, use host communication, ports and protocols, application, url patterns, dns queries, ping data, etc\n4. Escalate to incident management team, if a massive incident to support incident response.\n5. Ensure all known event information and root cause of the event is known before proceeding with containment\n"},{"author":"ButterCup, Splunk","automation":{"actions":["scan host","scan hosts"],"is_note_required":false,"playbooks":[{"playook":null,"scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Scan host(s) for vulnerabilities. Reverse engineer malware thru static and dynamic means to determine any zero day vulnerabilities.\n","id":"f28177ae-78de-43c9-8692-e972e8a0aa62","name":"Identify vunlerabilities","references":["3.3.3 Identifying the Attacking Hosts - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf - NIST SP 800-86, Guide to Integrating Forensic Techniques into Incident Response, for additional information on preserving evidence"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. Scan host(s) with infection and determine any vulnerabilities that can remediate infection. (e.g. finding a SMB MS17-010 - Windows SMB Remote Code Execution Vulnerability)\n2. Identify any common vulnerabilities among the hosts infected\n3. Reverse engineer malware for any zero day vulnerabilities.\n"},{"author":"ButterCup, Splunk","automation":{"actions":["run query"],"is_note_required":false,"playbooks":[{"playook":"","scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-04-21","description":"Implement additional monitoring that reviews not only host/network containment success. Monitor network blocks for additional hosts that might not have been identified. Reassess containment as needed depending on any new information. If this is a mass infection, it's advised that a 24 no change process be implemented.\n","id":"edb7867c-2e81-4356-a422-92781f4fa34c","name":"Implement additional monitoring","references":["3.2.4 Incident Analysis - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"requirements":null,"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. Create additional monitoring for network and host detection for abnormal activity to ensure containment is effective.\n2. Re-investigate new hosts found but not on the containment list\n"},{"author":"ButterCup, Splunk","automation":{"actions":["run query","unblock ip","unblock domain","unblock url","unblock hash","unblock process","unquarantine device","unquarantine host","remove tag"],"is_note_required":false,"playbooks":[{"playook":null,"scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Newly recovered systems should have additional monitoring for any anomalies or newly created incidents.  Adding single host to a previously infected list for a specified period will allow the incident responder to quickly assess a re-infection or subsequent new infection. At this stage in recovery, you should be unquarantining devices and removing any host blocks.\n","id":"ecf89e9b-106a-46d1-b236-a2716f71d7ae","name":"Implement recovery monitoring","references":["3.3.4 Eradication and Recovery - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. Monitor restored systems for any new anomalies and ensure that operations have been returned to normal\n2. Begin to remove emergency blocks to permanent block and remediation alerts for infected systems returning the network (e.g. laptops that were unreachable during the incident)\n"},{"author":"ButterCup","automation":{"action":null,"is_note_required":false,"playbook":null,"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-04-21","description":"c\n","id":"f83abcae-3734-45ff-99ef-b17eb937c057","name":"Make personnel report suspicious activity","references":["Organizational Acceptable Use Policy"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"Develop a simplified, company wide-known way to contact IR team in case of suspicious activity on the user system.\nMake sure that the personnel is aware of it, can and will use it.\n"},{"author":"Patrick Bareiss, Splunk","automation":{"actions":["file reputation","hunt file","get file","block hash","disable user","logoff user","shutdown system","create ticket"],"is_note_required":false,"playbooks":[{"playook":"malware_hunt_and_contain","scm":"community"}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-08-05","description":"Uses any presented filehash artifact sent to phantom and conducts a reputation check, hunts for additional systems, blocks file hash with <=10 positive detections and creates a ticket for follow up.  Any hashes found with >10 positive hits, automatically blockes the hashes, disables user accounts, logs off the user, shuts down the system and finally creates a urgent ticket.","id":"1d7b437a-5114-4b94-a585-04c3362ba08f","name":"Malware Hunt and Contain","references":["https://github.com/phantomcyber/playbooks/blob/4.9/malware_hunt_and_contain.json","https://github.com/phantomcyber/playbooks/blob/4.9/malware_hunt_and_contain.py","https://github.com/phantomcyber/playbooks/blob/4.9/malware_hunt_and_contain.png"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":2,"workflow":"1. Gets file reputation for every hash presented and filters hashes with >10 OR <=10 and >5 for positive hits\n2. Get the files that match and hunt the file hashes and return the system(s)/user(s) that have these files present\n3. If >10 then block hash, disable users, logoff user, shutdown system and create a ticket\n4. IF <=10 but >5 block hash, and create a ticket\nTicket template:\n  Virus Detected on # devices\n  Hashes submitted with detections: (list hashes)\n  File was found on # of devices (list devices)\n  This impacts at least # users: (list users)\n  # of hashes were submitted for blocking: (list hashes)\n  # of users were forced to logoff: (list users)\n  # of user accounts were disabled: (list users)\n  # of systems were shutdown: (list systems)\n"},{"author":"ButterCup, Splunk","automation":{"actions":["patch host","deploy patch","run job","execute program","run script","execute action"],"is_note_required":false,"playbooks":[{"playook":null,"scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Apply mitigations or remediate any known affecting vulnerabilities that linked to the incidents.  (e.g. SMB MS17-010 - Windows SMB Remote Code Execution Vulnerability). Mitigations are controls that block and lower the risk, but don't remove the vulnerability. Remediation is patching and removing the risk known vulnerability from being exploited.\n","id":"70362de1-bfef-4a0f-893f-3e0d605ed9b7","name":"Mitigate or remediate any vulnerabilities","references":["3.3.4 Eradication and Recovery - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"requirements":null,"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. Apply remediations (e.g. patches) to infected and not infected hosts that pertain to the vulnerability found being used by the incident (remove the risk). Identify and fix any systems not accepting or validating the patch (e.g. needing reboots) as soon as possible.\n2. This may require scheduling due to business needs. In a mass incident, emergency change requests can be used to support patching.  In single instance events, the risk to outage vs the risk to mitigate may be acceptable. If acceptable, then move remediations to lessons learned processing before closing out the request.  Put in place, mitigations for at least detections and if possible protection rules to minimize impact while remediation is being scheduled.\n3. Apply mitigations such as IPS and host based firewall rules to mitigate (reduce the risk) of the vulnerability being exploited for at least detection to notify when occurring and if containment and eradication has failed.\n4. Monitor detections to ensure containment is working and determine when eradication is beginning to be effective.\n"},{"author":"ButterCup","automation":{"action":null,"is_note_required":false,"playbook":null,"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-17","description":"Practice in the real environment. Sharpen Response skills within your organization by simulating real world with training exercises within your organization.","id":"97d00b14-dd01-47e4-b7eb-0a82f4998c4e","name":"Practice Real World Events","references":["3.1 Preparation - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"Make sure that the response actions have been performed during an internal exercise by your Incident Response Team. You need to make sure that when an Incident happens, the team understands the how and this is not the first time they have seen the tasks. This is best done by being able to execute the actual steps in **your environment**, i.e. blocking an IP address or a domain name."},{"author":"ButterCup, Splunk","automation":{"action":null,"is_note_required":false,"playbook":"","role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-17","description":"The lists in the workflow below provide examples of tools and resources available that may be of value during incident handling. These lists are intended to be a starting point for discussions about which tools and resources an organizations incident handlers need.\n","id":"91d4566e-a292-4f0a-b894-dde23bde3f08","name":"Prepare for incident handling","references":["3.1.1 Preparing to Handle Incidents - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"## Incident Handler Communications and Facilities:\n* Contact information for team members and others within and outside the organization (primary and backup contacts), such as law enforcement and other incident response teams; information may include phone numbers, email addresses, public encryption keys (in accordance with the encryption software described below), and instructions for verifying the contacts identity\n* On-call information for other teams within the organization, including escalation information\n* Incident reporting mechanisms, such as phone numbers, email addresses, online forms, and secure instant messaging systems that users can use to report suspected incidents; at least one mechanism should permit people to report incidents anonymously\n* Issue tracking system for tracking incident information, status, etc.\n* Smartphones to be carried by team members for off-hour support and onsite communications\n* Encryption software to be used for communications among team members, within the organization and with external parties; for Federal agencies, software must use a FIPS-validated encryption algorithm20\n* War room for central communication and coordination; if a permanent war room is not necessary or practical, the team should create a procedure for procuring a temporary war room when needed\n* Secure storage facility for securing evidence and other sensitive materials\n## Incident Analysis Hardware and Software\n* Digital forensic workstations21 and/or backup devices to create disk images, preserve log files, and save other relevant incident data\n* Laptops for activities such as analyzing data, sniffing packets, and writing reports\n* Spare workstations, servers, and networking equipment, or the virtualized equivalents, which may be used for many purposes, such as restoring backups and trying out malware\n* Blank removable media\n* Portable printer to print copies of log files and other evidence from non-networked systems\n* Packet sniffers and protocol analyzers to capture and analyze network traffic\n* Digital forensic software to analyze disk images\n* Removable media with trusted versions of programs to be used to gather evidence from systems\n* Evidence gathering accessories, including hard-bound notebooks, digital cameras, audio recorders, chain of custody forms, evidence storage bags and tags, and evidence tape, to preserve evidence for possible legal actions\n## Incident Analysis Resources:\n* Port lists, including commonly used ports and Trojan horse ports\n* Documentation for OSs, applications, protocols, and intrusion detection and antivirus products Network diagrams and lists of critical assets, such as database servers\n* Current baselines of expected network, system, and application activity\n* Cryptographic hashes of critical files22 to speed incident analysis, verification, and eradication\n## Incident Mitigation Software:\n* Access to images of clean OS and application installations for restoration and recovery purposes\n"},{"author":"ButterCup, Splunk","automation":{"action":null,"is_note_required":false,"playbook":"","role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-17","description":"Keeping the number of incidents reasonably low is very important to protect the business processes of the organization. It is outside the scope of this document to provide specific advice on securing networks, systems, and applications. Although incident response teams are generally not responsible for securing resources, they are advocates of sound security practices. An incident response team should identify problems that the organization is otherwise not aware of and play a key role in risk assessment and training by identifying gaps.","id":"5b7c5d18-6598-412b-a4f1-e66e92890503","name":"Preventing Incidents","references":["3.1.2 Prevent Incidents - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"The following:\n* Risk Assessments. Periodic risk assessments of systems and applications should determine what allowing staff to emphasize monitoring and response activities for those resources.\n* Host Security. All hosts should be hardened appropriately using standard configurations. In addition to keeping each host properly patched, hosts should be configured to follow the principle of least privilege\u2014granting users only the privileges necessary for performing their authorized tasks. Hosts should have auditing enabled and should log significant security-related events. The security of hosts risks are posed by combinations of threats and vulnerabilities.\n* Applicable threats, including organization-specific threats. Each risk should be prioritized, and the risks can be mitigated, transferred, or accepted until a reasonable overall level of risk is reached. Another benefit of conducting risk assessments regularly is that critical resources are identified, Content Automation Protocol (SCAP) expressed operating system and application configuration and their configurations should be continuously monitored. checklists to assist in securing hosts consistently and effectively.\n* Network Security. The network perimeter should be configured to deny all activity that is not expressly permitted. This includes securing all connection points, such as virtual private networks (VPNs) and dedicated connections to other organizations.\n* Malware Prevention. Software to detect and stop malware should be deployed throughout the organization. Malware protection should be deployed at the host level (e.g., server and workstation operating systems), the application server level (e.g., email server, web proxies), and the application\n* User Awareness and Training. Users should be made aware of policies and procedures regarding appropriate use of networks, systems, and applications. Applicable lessons learned from previous incidents should also be shared with users so they can see how their actions could affect the organization. Improving user awareness regarding incidents should reduce the frequency of incidents. IT staff should be trained so that they can maintain their networks, systems, and applications in accordance with the organization\u2019s security standards.\n"},{"author":"ButterCup, Splunk","automation":{"actions":["create ticket"],"is_note_required":false,"playbooks":[{"playook":"Create false-positve reduction service request","scm":"local"}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Create any tasks or service requests based on the recommendations of the review of the incident or with the process flow from alert detection to provide feedback from false positives.\n","id":"43fc5e87-d819-460a-a740-de2066b18a29","name":"Provide lessons learned tasks or changes","references":["3.4.1 Lessons Learned - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"requirements":null,"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. Create service requests or documentation updates from the results of the review of the followup report and incident review meeting\n2. Create service request for updating alert detection from feedback from false positives\n"},{"author":"ButterCup, Splunk, @atc_react","automation":{"action":null,"is_note_required":false,"playbook":null,"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-17","description":"Raise personnel awareness regarding phishing, ransomware, social engineering, and other attacks that involve user interaction","id":"145a82b5-cafd-468e-b487-737fdf13d6a4","name":"Raise personnel awareness","references":["https://attack.mitre.org/mitigations/M1017/"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction."},{"author":"ButterCup, Splunk","automation":{"actions":["create ticket","deploy patch","run script","add tag","execute action","execute program"],"is_note_required":false,"playbooks":[{"playook":null,"scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Remove malicious content. There are multiple ways to accomplish this. Depending on the maturity and size of the incident, this can be as simple as re-imaging a single system to full remediation via a deployable package from your antivirus vendor or removal of offending file via your enterprise detection and response (EDR) tool. Network attacks external to your environment will need to be managed with the support of your ISP. Internal attacks should be segmented for containment and then removing offending systems or malicious content from those offending systems.\n","id":"26cd22c6-4b67-4dc5-b8d1-f5ef9b5d8226","name":"Remove malicious content","references":["3.3.4 Eradication and Recovery - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"requirements":null,"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. Determine the correct approach based on maturity and size of the incident\n2. Employ eradication and monitor the process to ensure the system does not get re-infected. Reinfection is an indication that your containment measures are inadequate to stop the incident.\n3. Apply any new gold image with up to date patches on re-imaged systems.\n"},{"author":"ButterCup, Splunk","automation":{"actions":["create ticket"],"is_note_required":false,"playbooks":[{"playook":"Create a service request for re-image","scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Depending on the sized of the incident, reimaging systems maybe a viable eradication and recovery process combined. Once restored to gold image (standardized corporate image) with immediate patching and updating of all known vulnerabilities. Create a service request for the Help Desk to re-image the host. Server or network equipment should be baselined and restored by the owning team.\n","id":"bb515cf6-40b5-4005-af04-6f63439df7b4","name":"Restore systems to operational status","references":["3.3.4 Eradication and Recovery - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"requirements":null,"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. Create a request for re-imaging system for eradication and recovery. Re-imaging will not be possible in a mass incident.\n2. For mass incidents, provide immediate patching and reporting of non-compliant patching or antivirus removal tools.  Thorough forensic and reverse malware engineering will provide the necessary details to minimize complete recovery processes.\n3. Do not restore localized customer files (/home/user, or /User/<username>), but only on a case by case basis and thorough review of the files being restored.\n4. If the eradication process isn't reducing the number of infected hosts, eradication is missing a persistence mechanism or containment has failed.\n"},{"author":"Philip Royer, Splunk","automation":{"actions":["set status"],"is_note_required":false,"playbooks":[{"playook":"suspicious_email_attachment_investigate_and_delete","scm":"community"}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2019-06-03","description":"Investigate an email with a suspicious file attachment detected by Splunk Enterprise Security. Detonate the file attachment in a sandbox, gather network behavior from the sandbox results, and pivot on those network indicators with both external reputation queries and internal Splunk Common Information Model searches. After confirming the results with an analyst prompt, delete the email from the user's inbox, hopefully before they have opened it.\n","id":"3096f721-8842-42ce-2fc7-742d8372b712","name":"Suspicious Email Attachment Investigate and Delete","references":[""],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"Synchronize the community playbook repository in Phantom, then open the playbook and follow the deployment notes to configure it for your environment.\n"},{"author":"ButterCup, Splunk","automation":{"actions":["run query"],"is_note_required":false,"playbooks":[{"playook":null,"scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Confirm and acknowledge eradication steps are working as expected and number of infected host(s) is dropping.  Validation here will allow the incident responder to move to recovery phase. If single instance, validate the reimage process was completed by validating new image creation date. (win - 'systeminfo | find Original'', linux - 'ls -ld /var/log/installer', macOS - /var/log/install.log.# (oldest))\n","id":"b678705c-12a6-428b-a631-ed579332bc99","name":"Validate hosts eradicated","references":["3.3.4 Eradication and Recovery - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"requirements":null,"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. If single instance, validate the reimage process was completed by validating new image creation date.\n  a. win - 'systeminfo | find Original''\n  b. linux - 'ls -ld /var/log/installer'\n  c. macOS - /var/log/install.log.# (oldest))\n2. If this host has been reinfected more than once, conduct a formal forensic review to ensure all malicious content has been removed.\n2. If mass incident follows steps 2-5, determine if the number of infected host is reducing\n3. Determine if the number of (re)infected host is increasing\n4. If the eradication process isn't reducing the number of infected hosts, eradication is missing an persistence mechanism or containment has failed\n5. If the eradication process shows new hosts are being infected, your containment process is failing and/or the incident has mutated. (e.g. polymorphic malware with a active vulnerability or actor changed tactics and is now using ping for command and control and uploaded new malware). If this occurs return to Detection and Analysis Phase and continue forensic analysis.\n"},{"author":"ButterCup, Splunk","automation":{"actions":["run query"],"is_note_required":false,"playbooks":[{"playook":null,"scm":null}],"role":null,"sla":null,"sla_type":"minutes"},"date":"2020-07-30","description":"Validate each reimaged system was completed by validating new image creation date. ** win: systeminfo | find Original ** linux: ls -ld /var/log/installer ** macOS: /var/log/install.log.# (oldest date of entry). If more surgical, antivirus package or enterprise detection and response removal process has successfully completed and system is showing no signs of indicators of the incident.\n","id":"8218bcf6-739b-4f76-8952-eb133480ad8d","name":"Validate restored hosts","references":["3.3.4 Eradication and Recovery - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf"],"tags":{"nist":"RS.RP","product":["Splunk Phantom"]},"type":"response","version":1,"workflow":"1. If single instance, validate the reimage process was completed by validating new image creation date\n  a. win - 'systeminfo | find Original''\n  b. linux - 'ls -ld /var/log/installer'\n  c. macOS - /var/log/install.log.# (oldest))\n2. Review existing monitoring to ensure host is working as expected and within normal parameters\n"}],"count":35}