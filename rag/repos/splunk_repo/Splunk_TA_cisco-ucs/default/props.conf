##
## SPDX-FileCopyrightText: 2024 Splunk, Inc.
## SPDX-License-Identifier: LicenseRef-Splunk-8-2021
##
[source::cisco:ucs:*]
EVAL-app = "cisco:ucs"
EVAL-vendor_product = "Cisco UCS"

[source::cisco:ucs:faultInst]
FIELDALIAS-body = descr AS body
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-src  = dn as src
FIELDALIAS-src_name  = dn as src_name
FIELDALIAS-signature = rule as signature
FIELDALIAS-vendor_type = type as vendor_type
FIELDALIAS-signature_id = rule as signature_id
FIELDALIAS-vendor_severity = highestSeverity as vendor_severity
FIELDALIAS-subcomponent = dn as subcomponent
EVAL-itsiInclude = "true"
EVAL-severity = case(severity == "info" OR severity == "cleared" OR severity == "condition", "informational", severity == "critical", "critical", severity == "major", "high", severity == "minor", "medium", severity == "warning", "low", true(), "unknown")
LOOKUP-alert_type = ucs_fault_alert_type_lookup severity OUTPUT type
LOOKUP-code = ucs_fault_code_lookup code OUTPUTNEW explanation
LOOKUP-type = ucs_fault_type_lookup type AS vendor_type OUTPUTNEW description
LOOKUP-highestSeverity = ucs_fault_highestSeverity_lookup highestSeverity OUTPUTNEW severity_id

[source::cisco:ucs:topSystem]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip

[source::cisco:ucs:firmwareRunning]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip

[source::cisco:ucs:storageLocalDisk]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-array = dn as array
EVAL-blocksize = blockSize / 1024
EVAL-storage = (numberOfBlocks * blockSize) / (1024 * 1024)

[source::cisco:ucs:fabricVsan]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-status = operState as status

[source::cisco:ucs:fabricVlan]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-status = operState as status

[source::cisco:ucs:fabricDceSwSrvEp]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-status = operState as status

[source::cisco:ucs:computeRackUnit]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-enabled = operPower as enabled
FIELDALIAS-status = operState as status
FIELDALIAS-cpu_cores = numOfCores as cpu_cores
FIELDALIAS-cpu_count = numOfCpus as cpu_count
FIELDALIAS-description = dn as description
FIELDALIAS-mem = totalMemory as mem
FIELDALIAS-mem_free = availableMemory as mem_free
EVAL-mem_used = totalMemory - availableMemory

[source::cisco:ucs:computeBlade]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-enabled = operPower as enabled
FIELDALIAS-status = operState as status
FIELDALIAS-cpu_cores = numOfCores as cpu_cores
FIELDALIAS-cpu_count = numOfCpus as cpu_count
FIELDALIAS-description = dn as description
FIELDALIAS-mem = totalMemory as mem
FIELDALIAS-mem_free = availableMemory as mem_free
EVAL-mem_used = totalMemory - availableMemory

[source::cisco:ucs:equipmentPsu]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-status = operState as status

[source::cisco:ucs:equipmentChassis]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-status = operState as status
FIELDALIAS-version= revision as version
FIELDALIAS-family = model as family

[source::cisco:ucs:equipmentSwitchCard]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-status = operState as status
FIELDALIAS-version= revision as version
FIELDALIAS-family = model as family

[source::cisco:ucs:vnicEtherIf]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-status = operState as status

[source::cisco:ucs:lsServer]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-status = operState as status

[source::cisco:ucs:fabricEthLanPcEp]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-status = operState as status

[source::cisco:ucs:fabricEthLanPc]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-status = operState as status

[source::cisco:ucs:etherPIo]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-status = operState as status
FIELDALIAS-dest_ip = address as dest_ip

[source::cisco:ucs:equipmentIOCard]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-status = operState as status
FIELDALIAS-family = model as family

[source::cisco:ucs:swSystemStats]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
EVAL-cpu_load_percent = loadAvg
FIELDALIAS-mem_free = memAvailableAvg as mem_free
FIELDALIAS-mem_used = memCachedAvg as mem_used
EVAL-mem = mem_free + mem_used
TIME_PREFIX = timeCollected="
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 23
TZ = UTC

[source::cisco:ucs:etherTxStats]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
TIME_PREFIX = timeCollected="
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 23
TZ = UTC

[source::cisco:ucs:etherPauseStats]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
TIME_PREFIX = timeCollected="
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 23
TZ = UTC

[source::cisco:ucs:etherRxStats]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
TIME_PREFIX = timeCollected="
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 23
TZ = UTC

[source::cisco:ucs:etherLossStats]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
TIME_PREFIX = timeCollected="
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 23
TZ = UTC

[source::cisco:ucs:etherErrStats]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
TIME_PREFIX = timeCollected="
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 23
TZ = UTC

[source::cisco:ucs:adaptorVnicStats]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-thruput = bytesTxDeltaAvg as thruput
FIELDALIAS-thruput_max = bytesTxDeltaMax as thruput_max
TIME_PREFIX = timeCollected="
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 23
TZ = UTC

[source::cisco:ucs:processorEnvStats]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-power = inputCurrentAvg as power
TIME_PREFIX = timeCollected="
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 23
TZ = UTC

[source::cisco:ucs:computeMbTempStats]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-temperature = fmTempSenIoAvg as temperature
TIME_PREFIX = timeCollected="
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 23
TZ = UTC

[source::cisco:ucs:computeMbPowerStats]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-power = inputVoltageAvg as power
TIME_PREFIX = timeCollected="
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 23
TZ = UTC

[source::cisco:ucs:equipmentChassisStats]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-power = inputPowerAvg as power
TIME_PREFIX = timeCollected="
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 23
TZ = UTC

[source::cisco:ucs:equipmentPsuStats]
FIELDALIAS-dest_host = host as dest_host
FIELDALIAS-dest = host as dest
FIELDALIAS-dest_name = system_name as dest_name
FIELDALIAS-dest_ip = address as dest_ip
FIELDALIAS-power = outputPowerAvg as power
FIELDALIAS-temparature = ambientTemp as temperature
TIME_PREFIX = timeCollected="
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 23
TZ = UTC


#

[source::...splunk_ta_cisco*ucs.log]
sourcetype = splunk_ta_cisco_ucs
MAX_TIMESTAMP_LOOKAHEAD = 23
TIME_FORMAT = %Y-%m-%d %H:%M:%S,%3N
TIME_PREFIX = ^
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)\d{4}-

[source::...ta_cisco*ucs_controller.log]
sourcetype = ta_cisco_ucs_controller.log
MAX_TIMESTAMP_LOOKAHEAD = 23
TIME_FORMAT = %Y-%m-%d %H:%M:%S,%3N
TIME_PREFIX = ^
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)\d{4}-

[source::...ta_app_conf.log]
sourcetype = ta_app_conf
MAX_TIMESTAMP_LOOKAHEAD = 23
TIME_FORMAT = %Y-%m-%d %H:%M:%S,%3N
TIME_PREFIX = ^
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)\d{4}-

[source::...splunk_ta_cisco*ucs_ta_util.log]
sourcetype = splunk_ta_cisco_ucs_ta_util
MAX_TIMESTAMP_LOOKAHEAD = 23
TIME_FORMAT = %Y-%m-%d %H:%M:%S,%3N
TIME_PREFIX = ^
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)\d{4}-

[source::...splunk_ta_cisco*ucs_migration.log]
sourcetype = splunk_ta_cisco_ucs_migration
MAX_TIMESTAMP_LOOKAHEAD = 23
TIME_FORMAT = %Y-%m-%d %H:%M:%S,%3N
TIME_PREFIX = ^
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)\d{4}-

[source::...splunk_ta_cisco*ucs_validation.log]
sourcetype = splunk_ta_cisco_ucs_validation
MAX_TIMESTAMP_LOOKAHEAD = 23
TIME_FORMAT = %Y-%m-%d %H:%M:%S,%3N
TIME_PREFIX = ^
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)\d{4}-

[source::...splunk_ta_cisco*ucs_utility.log]
sourcetype = splunk_ta_cisco_ucs_utility
MAX_TIMESTAMP_LOOKAHEAD = 23
TIME_FORMAT = %Y-%m-%d %H:%M:%S,%3N
TIME_PREFIX = ^
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)\d{4}-
